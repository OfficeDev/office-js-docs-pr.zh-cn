---
title: Office 加载项使用的浏览器
description: 指定操作系统和 Office 版本如何确定 Office 加载项使用的浏览器。
ms.date: 06/01/2020
localization_priority: Normal
ms.openlocfilehash: 0d94e66c9854a349758a2ed737524eb5d54fea29
ms.sourcegitcommit: 9229102c16a1864e3a8724aaf9b0dc68b1428094
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/03/2020
ms.locfileid: "44520372"
---
# <a name="browsers-used-by-office-add-ins"></a><span data-ttu-id="7f459-103">Office 加载项使用的浏览器</span><span class="sxs-lookup"><span data-stu-id="7f459-103">Browsers used by Office Add-ins</span></span>

<span data-ttu-id="7f459-104">Office 加载项是使用 iFrames（在 Office 网页版中运行时）和使用 Office 桌面版和移动版客户端中的嵌入式浏览器控件显示的 Web 应用程序。</span><span class="sxs-lookup"><span data-stu-id="7f459-104">Office add-ins are web applications that are displayed using iFrames when running in Office on the web and using embedded browser controls in Office for desktop and mobile clients.</span></span> <span data-ttu-id="7f459-105">加载项还需要使用 JavaScript 引擎来运行 JavaScript。</span><span class="sxs-lookup"><span data-stu-id="7f459-105">Add-ins also need a JavaScript engine to run the JavaScript.</span></span> <span data-ttu-id="7f459-106">嵌入的浏览器和引擎都是由安装在用户计算机上的浏览器提供的。</span><span class="sxs-lookup"><span data-stu-id="7f459-106">Both the embedded browser and the engine are supplied by a browser installed on the user's computer.</span></span>

<span data-ttu-id="7f459-107">要使用的浏览器取决于：</span><span class="sxs-lookup"><span data-stu-id="7f459-107">Which browser is used depends on:</span></span>

- <span data-ttu-id="7f459-108">计算机的操作系统。</span><span class="sxs-lookup"><span data-stu-id="7f459-108">The computer's operating system.</span></span>
- <span data-ttu-id="7f459-109">加载项是在 Office 网页版、Office 365 还是非订阅版 Office 2013 或更高版本中运行。</span><span class="sxs-lookup"><span data-stu-id="7f459-109">Whether the add-in is running in Office on the web, Office 365, or non-subscription Office 2013 or later.</span></span>

<span data-ttu-id="7f459-110">下表显示在不同平台和操作系统中使用的浏览器。</span><span class="sxs-lookup"><span data-stu-id="7f459-110">The following table shows which browser is used for the various platforms and operating systems.</span></span>

|<span data-ttu-id="7f459-111">**操作系统/平台**</span><span class="sxs-lookup"><span data-stu-id="7f459-111">**OS / Platform**</span></span>|<span data-ttu-id="7f459-112">**Browser**</span><span class="sxs-lookup"><span data-stu-id="7f459-112">**Browser**</span></span>|
|:-----|:-----|:-----|:-----|:-----|:-----|:-----|
|<span data-ttu-id="7f459-113">Office 网页版</span><span class="sxs-lookup"><span data-stu-id="7f459-113">Office on the web</span></span>|<span data-ttu-id="7f459-114">在其中打开 Office 的浏览器。</span><span class="sxs-lookup"><span data-stu-id="7f459-114">The browser in which Office is opened.</span></span>|
|<span data-ttu-id="7f459-115">Mac</span><span class="sxs-lookup"><span data-stu-id="7f459-115">Mac</span></span>|<span data-ttu-id="7f459-116">Safari</span><span class="sxs-lookup"><span data-stu-id="7f459-116">Safari</span></span>|
|<span data-ttu-id="7f459-117">iOS</span><span class="sxs-lookup"><span data-stu-id="7f459-117">iOS</span></span>|<span data-ttu-id="7f459-118">Safari</span><span class="sxs-lookup"><span data-stu-id="7f459-118">Safari</span></span>|
|<span data-ttu-id="7f459-119">Android</span><span class="sxs-lookup"><span data-stu-id="7f459-119">Android</span></span>|<span data-ttu-id="7f459-120">Chrome</span><span class="sxs-lookup"><span data-stu-id="7f459-120">Chrome</span></span>|
|<span data-ttu-id="7f459-121">Windows/非订阅版 Office 2013 或更高版本</span><span class="sxs-lookup"><span data-stu-id="7f459-121">Windows / non-subscription Office 2013 or later</span></span>|<span data-ttu-id="7f459-122">Internet Explorer 11</span><span class="sxs-lookup"><span data-stu-id="7f459-122">Internet Explorer 11</span></span>|
|<span data-ttu-id="7f459-123">Windows 10 版本</span><span class="sxs-lookup"><span data-stu-id="7f459-123">Windows 10 ver.</span></span> <span data-ttu-id="7f459-124">< 1903 / Office 365</span><span class="sxs-lookup"><span data-stu-id="7f459-124">< 1903 / Office 365</span></span>|<span data-ttu-id="7f459-125">Internet Explorer 11</span><span class="sxs-lookup"><span data-stu-id="7f459-125">Internet Explorer 11</span></span>|
|<span data-ttu-id="7f459-126">Windows 10 版本</span><span class="sxs-lookup"><span data-stu-id="7f459-126">Windows 10 ver.</span></span> <span data-ttu-id="7f459-127">>= 1903/Office 365 ver < 16.0.11629<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="7f459-127">>= 1903 / Office 365 ver < 16.0.11629<sup>1</sup></span></span>|<span data-ttu-id="7f459-128">Internet Explorer 11</span><span class="sxs-lookup"><span data-stu-id="7f459-128">Internet Explorer 11</span></span>|
|<span data-ttu-id="7f459-129">Windows 10 版本</span><span class="sxs-lookup"><span data-stu-id="7f459-129">Windows 10 ver.</span></span> <span data-ttu-id="7f459-130">>= 1903/Office 365 ver >= 16.0.11629<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="7f459-130">>= 1903 / Office 365 ver >= 16.0.11629<sup>1</sup></span></span>|<span data-ttu-id="7f459-131">Microsoft Edge<sup>2、3</sup></span><span class="sxs-lookup"><span data-stu-id="7f459-131">Microsoft Edge<sup>2, 3</sup></span></span>|

<span data-ttu-id="7f459-132"><sup>1</sup>有关更多详细信息，请参阅 "[更新历史记录" 页面](/officeupdates/update-history-office365-proplus-by-date)以及如何[查找 Office 客户端版本和更新频道](https://support.office.com/article/What-version-of-Office-am-I-using-932788b8-a3ce-44bf-bb09-e334518b8b19)。</span><span class="sxs-lookup"><span data-stu-id="7f459-132"><sup>1</sup> See the [update history page](/officeupdates/update-history-office365-proplus-by-date) and how to [find your Office client version and update channel](https://support.office.com/article/What-version-of-Office-am-I-using-932788b8-a3ce-44bf-bb09-e334518b8b19) for more details.</span></span>

<span data-ttu-id="7f459-133"><sup>2</sup>当使用 Microsoft Edge 时，Windows 10 讲述人（有时称为 "屏幕阅读器"）将读取 `<title>` 在任务窗格中打开的页面中的标记。</span><span class="sxs-lookup"><span data-stu-id="7f459-133"><sup>2</sup> When Microsoft Edge is being used, the Windows 10 Narrator (sometimes called a "screen reader") reads the `<title>` tag in the page that opens in the task pane.</span></span> <span data-ttu-id="7f459-134">如果使用的是 Internet Explorer 11，则Narrator 将会读取任务窗格的标题栏，它来自加载项清单中的 `<DisplayName>` 值。</span><span class="sxs-lookup"><span data-stu-id="7f459-134">When Internet Explorer 11 is being used, the Narrator reads the title bar of the task pane, which comes from the `<DisplayName>` value in the add-in's manifest.</span></span>

<span data-ttu-id="7f459-135"><sup>3</sup>如果加载项包括 `Runtimes` 清单中的元素，则使用 Internet Explorer 11，而无需考虑 Windows 或 Office 365 版本。</span><span class="sxs-lookup"><span data-stu-id="7f459-135"><sup>3</sup> If your add-in includes the `Runtimes` element in the manifest, it uses Internet Explorer 11 regardless of the Windows or Office 365 version.</span></span> <span data-ttu-id="7f459-136">有关详细信息，请参阅[运行时](../reference/manifest/runtimes.md)。</span><span class="sxs-lookup"><span data-stu-id="7f459-136">For more information, see [Runtimes](../reference/manifest/runtimes.md).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="7f459-137">Internet Explorer 11 不支持高于 ES5 的 JavaScript 版本。</span><span class="sxs-lookup"><span data-stu-id="7f459-137">Internet Explorer 11 does not support JavaScript versions later than ES5.</span></span> <span data-ttu-id="7f459-138">如果任何加载项用户安装的是使用 Internet Explorer 11 的平台，若要使用 ECMAScript 2015 或更高版本的语法和功能，则必须将 JavaScript 转换为 ES5 或使用填充代码。</span><span class="sxs-lookup"><span data-stu-id="7f459-138">If any of your add-in's users have platforms that use Internet Explorer 11, then to use the syntax and features of ECMAScript 2015 or later, you will need to either transpile your JavaScript to ES5 or use a polyfill.</span></span> <span data-ttu-id="7f459-139">此外，Internet Explorer 11 不支持媒体、录制和位置等部分 HTML5 功能。</span><span class="sxs-lookup"><span data-stu-id="7f459-139">Also, Internet Explorer 11 does not support some HTML5 features such as media, recording, and location.</span></span>

## <a name="troubleshooting-microsoft-edge-issues"></a><span data-ttu-id="7f459-140">Microsoft Edge 问题疑难解答</span><span class="sxs-lookup"><span data-stu-id="7f459-140">Troubleshooting Microsoft Edge Issues</span></span>

### <a name="service-workers-are-not-working"></a><span data-ttu-id="7f459-141">服务工作人员不工作</span><span class="sxs-lookup"><span data-stu-id="7f459-141">Service Workers are not working</span></span>

<span data-ttu-id="7f459-142">Office 外接程序不支持[Microsoft Edge web](/microsoft-edge/hosting/webview)上的服务工作线程。</span><span class="sxs-lookup"><span data-stu-id="7f459-142">Office Add-ins do not support Service Workers on [Microsoft Edge WebView](/microsoft-edge/hosting/webview).</span></span> <span data-ttu-id="7f459-143">请参阅[Office 外接程序概述](../overview/office-add-ins.md)，了解有关边缘 web 视图控件的最新支持的功能。</span><span class="sxs-lookup"><span data-stu-id="7f459-143">Please see the [Office Add-ins overview](../overview/office-add-ins.md) for the latest supported features on the Edge WebView control.</span></span> <span data-ttu-id="7f459-144">我们正在努力将基于 Chromium 的新[边缘 WebView2](/microsoft-edge/hosting/webview2)带到 Office 外接程序平台，我们预期将支持服务工作人员。</span><span class="sxs-lookup"><span data-stu-id="7f459-144">We are working hard to bring the new [Chromium-based Edge WebView2](/microsoft-edge/hosting/webview2) to the Office Add-ins platform, which we expect will support Service Workers.</span></span>

### <a name="chromium-based-edge-is-installed-on-my-development-computer-but-my-add-in-does-not-use-it"></a><span data-ttu-id="7f459-145">在我的开发计算机上安装了基于 Chromium 的边缘，但我的加载项不使用它</span><span class="sxs-lookup"><span data-stu-id="7f459-145">Chromium-based Edge is installed on my development computer, but my add-in does not use it</span></span>

<span data-ttu-id="7f459-146">[Microsoft Edge](https://support.microsoft.com/help/4501095/download-the-new-microsoft-edge-based-on-chromium)中的基本浏览器已更改为 Chromium。</span><span class="sxs-lookup"><span data-stu-id="7f459-146">The base browser in [Microsoft Edge](https://support.microsoft.com/help/4501095/download-the-new-microsoft-edge-based-on-chromium) has changed to Chromium.</span></span> <span data-ttu-id="7f459-147">在安装基于 Chromium 的边缘时，不会删除较早的 base （称为 "EdgeHTML"）。</span><span class="sxs-lookup"><span data-stu-id="7f459-147">The older base, called EdgeHTML, is not removed when Chromium-based Edge is installed.</span></span> <span data-ttu-id="7f459-148">Office 仍将使用加载项的 EdgeHTML 基础，直到在计算机上安装了支持 Chromium 的 Office 365 版本。</span><span class="sxs-lookup"><span data-stu-id="7f459-148">Office will still use the EdgeHTML base for add-ins until a build of Office 365 that supports Chromium is installed on the computer.</span></span> <span data-ttu-id="7f459-149">我们预计这些版本将在2020中发货。</span><span class="sxs-lookup"><span data-stu-id="7f459-149">We expect these builds to ship in 2020.</span></span> <span data-ttu-id="7f459-150">它们可能会在预览体验频道中的年上半年显示。</span><span class="sxs-lookup"><span data-stu-id="7f459-150">They will likely appear in the Insiders channel in the first half of the year.</span></span>

### <a name="scroll-bar-does-not-appear-in-task-pane"></a><span data-ttu-id="7f459-151">任务窗格中不显示滚动条</span><span class="sxs-lookup"><span data-stu-id="7f459-151">Scroll bar does not appear in task pane</span></span>

<span data-ttu-id="7f459-152">默认情况下，Microsoft Edge 中的滚动条是隐藏的，直到在其上悬停时。</span><span class="sxs-lookup"><span data-stu-id="7f459-152">By default, scroll bars in Microsoft Edge are hidden until hovered over.</span></span> <span data-ttu-id="7f459-153">适用于任务窗格中页面的 `<body>` 元素的 CSS 样式应包含 [-ms-overflow-style](https://developer.mozilla.org/docs/Web/CSS/-ms-overflow-style) 属性，且应将其设置为 `scrollbar`。</span><span class="sxs-lookup"><span data-stu-id="7f459-153">To ensure that the scroll bar is always visible, the CSS styling that applies to the `<body>` element of the pages in the task pane should include the [-ms-overflow-style](https://developer.mozilla.org/docs/Web/CSS/-ms-overflow-style) property and it should be set to `scrollbar`.</span></span> 

### <a name="when-debugging-with-the-microsoft-edge-devtools-the-add-in-crashes-or-reloads"></a><span data-ttu-id="7f459-154">使用 Microsoft Edge 开发工具进行调试时，加载项会崩溃或重新加载</span><span class="sxs-lookup"><span data-stu-id="7f459-154">When debugging with the Microsoft Edge DevTools, the add-in crashes or reloads</span></span>

<span data-ttu-id="7f459-155">[Microsoft Edge 开发工具](https://www.microsoft.com/p/microsoft-edge-devtools-preview/9mzbfrmz0mnj?rtc=1&activetab=pivot%3Aoverviewtab)中的设置断点可能导致 Office 认为该加载项已挂起。</span><span class="sxs-lookup"><span data-stu-id="7f459-155">Setting breakpoints in the [Microsoft Edge DevTools](https://www.microsoft.com/p/microsoft-edge-devtools-preview/9mzbfrmz0mnj?rtc=1&activetab=pivot%3Aoverviewtab) can cause Office to think that the add-in is hung.</span></span> <span data-ttu-id="7f459-156">发生这种情况时，它将自动重新加载该加载项。</span><span class="sxs-lookup"><span data-stu-id="7f459-156">It will automatically reload the add-in when this happens.</span></span> <span data-ttu-id="7f459-157">为防止这种情况，请将以下注册表项和值添加到开发计算机：`[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\16.0\Wef]"AlertInterval"=dword:00000000`。</span><span class="sxs-lookup"><span data-stu-id="7f459-157">To prevent this, add the following Registry key and value to the development computer: `[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\16.0\Wef]"AlertInterval"=dword:00000000`.</span></span>

### <a name="when-the-add-in-tries-to-open-get-add-in-error-we-cant-open-this-add-in-from-the-localhost-error"></a><span data-ttu-id="7f459-158">加载项尝试打开时，出现“加载项错误 我们无法从 localhost 打开此加载项”错误</span><span class="sxs-lookup"><span data-stu-id="7f459-158">When the add-in tries to open, get "ADD-IN ERROR We can't open this add-in from the localhost" error</span></span>

<span data-ttu-id="7f459-159">一个已知的原因是 Microsoft Edge 要求在开发计算机上为本地主机提供环回豁免。</span><span class="sxs-lookup"><span data-stu-id="7f459-159">One known cause is that Microsoft Edge requires that localhost be given a loopback exemption on the development computer.</span></span> <span data-ttu-id="7f459-160">按照[无法从 localhost 打开加载项](/office/troubleshoot/error-messages/cannot-open-add-in-from-localhost)中的说明操作。</span><span class="sxs-lookup"><span data-stu-id="7f459-160">Follow the instructions at [Cannot open add-in from localhost](/office/troubleshoot/error-messages/cannot-open-add-in-from-localhost).</span></span>

### <a name="get-errors-trying-to-download-a-pdf-file"></a><span data-ttu-id="7f459-161">在尝试下载 PDF 文件时遇到错误</span><span class="sxs-lookup"><span data-stu-id="7f459-161">Get errors trying to download a PDF file</span></span>

<span data-ttu-id="7f459-162">当 Edge 为浏览器时，不支持直接在外接程序中将 blob 作为 PDF 文件下载。</span><span class="sxs-lookup"><span data-stu-id="7f459-162">Directly downloading blobs as PDF files in an add-in is not supported when Edge is the browser.</span></span> <span data-ttu-id="7f459-163">解决方法是创建一个简单的 web 应用程序，将 blob 下载为 PDF 文件。</span><span class="sxs-lookup"><span data-stu-id="7f459-163">The workaround is to create a simple web application that downloads blobs as PDF files.</span></span> <span data-ttu-id="7f459-164">在外接程序中，调用该 `Office.context.ui.openBrowserWindow(url)` 方法并传递 web 应用程序的 URL。</span><span class="sxs-lookup"><span data-stu-id="7f459-164">In your add-in call the `Office.context.ui.openBrowserWindow(url)` method and pass the URL of the web application.</span></span> <span data-ttu-id="7f459-165">这将在 Office 外部的浏览器窗口中打开 web 应用程序。</span><span class="sxs-lookup"><span data-stu-id="7f459-165">This will open the web application in a browser window outside of Office.</span></span>

## <a name="see-also"></a><span data-ttu-id="7f459-166">另请参阅</span><span class="sxs-lookup"><span data-stu-id="7f459-166">See also</span></span>

- [<span data-ttu-id="7f459-167">Office 加载项的运行要求</span><span class="sxs-lookup"><span data-stu-id="7f459-167">Requirements for Running Office Add-ins</span></span>](requirements-for-running-office-add-ins.md)
