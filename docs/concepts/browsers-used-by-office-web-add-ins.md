---
title: Office 加载项使用的浏览器
description: 指定操作系统和 Office 版本如何确定 Office 加载项使用的浏览器。
ms.date: 08/13/2020
localization_priority: Normal
ms.openlocfilehash: 544388014bfef0dd647a79d655a173d09f5a4ff7
ms.sourcegitcommit: c6308cf245ac1bc66a876eaa0a7bb4a2492991ac
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/08/2020
ms.locfileid: "47408437"
---
# <a name="browsers-used-by-office-add-ins"></a><span data-ttu-id="4459e-103">Office 加载项使用的浏览器</span><span class="sxs-lookup"><span data-stu-id="4459e-103">Browsers used by Office Add-ins</span></span>

<span data-ttu-id="4459e-104">Office 外接程序是在 web 上运行 Office 时使用 Iframe 显示的 web 应用程序，在 Office 中使用嵌入的浏览器控件用于桌面和移动客户端。</span><span class="sxs-lookup"><span data-stu-id="4459e-104">Office Add-ins are web applications that are displayed using iFrames when running in Office on the web and using embedded browser controls in Office for desktop and mobile clients.</span></span> <span data-ttu-id="4459e-105">加载项还需要使用 JavaScript 引擎来运行 JavaScript。</span><span class="sxs-lookup"><span data-stu-id="4459e-105">Add-ins also need a JavaScript engine to run the JavaScript.</span></span> <span data-ttu-id="4459e-106">嵌入的浏览器和引擎都是由安装在用户计算机上的浏览器提供的。</span><span class="sxs-lookup"><span data-stu-id="4459e-106">Both the embedded browser and the engine are supplied by a browser installed on the user's computer.</span></span>

<span data-ttu-id="4459e-107">要使用的浏览器取决于：</span><span class="sxs-lookup"><span data-stu-id="4459e-107">Which browser is used depends on:</span></span>

- <span data-ttu-id="4459e-108">计算机的操作系统。</span><span class="sxs-lookup"><span data-stu-id="4459e-108">The computer's operating system.</span></span>
- <span data-ttu-id="4459e-109">加载项是在 web 上的 Office、Microsoft 365 或非订阅 Office 2013 或更高版本上运行。</span><span class="sxs-lookup"><span data-stu-id="4459e-109">Whether the add-in is running in Office on the web, Microsoft 365, or non-subscription Office 2013 or later.</span></span>

<span data-ttu-id="4459e-110">下表显示在不同平台和操作系统中使用的浏览器。</span><span class="sxs-lookup"><span data-stu-id="4459e-110">The following table shows which browser is used for the various platforms and operating systems.</span></span>

|<span data-ttu-id="4459e-111">OS</span><span class="sxs-lookup"><span data-stu-id="4459e-111">OS</span></span>|<span data-ttu-id="4459e-112">Office 版本</span><span class="sxs-lookup"><span data-stu-id="4459e-112">Office version</span></span>|<span data-ttu-id="4459e-113">是否安装了边缘 WebView2 (Chromium 基于) ？</span><span class="sxs-lookup"><span data-stu-id="4459e-113">Edge WebView2 (Chromium-based) installed?</span></span>|<span data-ttu-id="4459e-114">浏览器</span><span class="sxs-lookup"><span data-stu-id="4459e-114">Browser</span></span>|
|:-----|:-----|:-----|:-----|:-----|:-----|:-----|
|<span data-ttu-id="4459e-115">任意</span><span class="sxs-lookup"><span data-stu-id="4459e-115">any</span></span>|<span data-ttu-id="4459e-116">Office 网页版</span><span class="sxs-lookup"><span data-stu-id="4459e-116">Office on the web</span></span>|<span data-ttu-id="4459e-117">不适用</span><span class="sxs-lookup"><span data-stu-id="4459e-117">Not applicable</span></span>|<span data-ttu-id="4459e-118">在其中打开 Office 的浏览器。</span><span class="sxs-lookup"><span data-stu-id="4459e-118">The browser in which Office is opened.</span></span>|
|<span data-ttu-id="4459e-119">Mac</span><span class="sxs-lookup"><span data-stu-id="4459e-119">Mac</span></span>|<span data-ttu-id="4459e-120">任意</span><span class="sxs-lookup"><span data-stu-id="4459e-120">any</span></span>|<span data-ttu-id="4459e-121">不适用</span><span class="sxs-lookup"><span data-stu-id="4459e-121">Not applicable</span></span>|<span data-ttu-id="4459e-122">Safari</span><span class="sxs-lookup"><span data-stu-id="4459e-122">Safari</span></span>|
|<span data-ttu-id="4459e-123">iOS</span><span class="sxs-lookup"><span data-stu-id="4459e-123">iOS</span></span>|<span data-ttu-id="4459e-124">任意</span><span class="sxs-lookup"><span data-stu-id="4459e-124">any</span></span>|<span data-ttu-id="4459e-125">不适用</span><span class="sxs-lookup"><span data-stu-id="4459e-125">Not applicable</span></span>|<span data-ttu-id="4459e-126">Safari</span><span class="sxs-lookup"><span data-stu-id="4459e-126">Safari</span></span>|
|<span data-ttu-id="4459e-127">Android</span><span class="sxs-lookup"><span data-stu-id="4459e-127">Android</span></span>|<span data-ttu-id="4459e-128">任意</span><span class="sxs-lookup"><span data-stu-id="4459e-128">any</span></span>|<span data-ttu-id="4459e-129">不适用</span><span class="sxs-lookup"><span data-stu-id="4459e-129">Not applicable</span></span>|<span data-ttu-id="4459e-130">Chrome</span><span class="sxs-lookup"><span data-stu-id="4459e-130">Chrome</span></span>|
|<span data-ttu-id="4459e-131">Windows 7、8.1、10</span><span class="sxs-lookup"><span data-stu-id="4459e-131">Windows 7, 8.1, 10</span></span> | <span data-ttu-id="4459e-132">非订阅 Office 2013 或更高版本</span><span class="sxs-lookup"><span data-stu-id="4459e-132">non-subscription Office 2013 or later</span></span>|<span data-ttu-id="4459e-133">无关紧要</span><span class="sxs-lookup"><span data-stu-id="4459e-133">Doesn't matter</span></span>|<span data-ttu-id="4459e-134">Internet Explorer 11</span><span class="sxs-lookup"><span data-stu-id="4459e-134">Internet Explorer 11</span></span>|
|<span data-ttu-id="4459e-135">Windows 7</span><span class="sxs-lookup"><span data-stu-id="4459e-135">Windows 7</span></span> | <span data-ttu-id="4459e-136">Microsoft 365</span><span class="sxs-lookup"><span data-stu-id="4459e-136">Microsoft 365</span></span>| <span data-ttu-id="4459e-137">无关紧要</span><span class="sxs-lookup"><span data-stu-id="4459e-137">Doesn't matter</span></span> | <span data-ttu-id="4459e-138">Internet Explorer 11</span><span class="sxs-lookup"><span data-stu-id="4459e-138">Internet Explorer 11</span></span>|
|<span data-ttu-id="4459e-139">Windows 8.1，</span><span class="sxs-lookup"><span data-stu-id="4459e-139">Windows 8.1,</span></span><br><span data-ttu-id="4459e-140">Windows 10 ver。 &nbsp; < &nbsp;1903</span><span class="sxs-lookup"><span data-stu-id="4459e-140">Windows 10 ver.&nbsp;<&nbsp;1903</span></span>| <span data-ttu-id="4459e-141">Microsoft 365</span><span class="sxs-lookup"><span data-stu-id="4459e-141">Microsoft 365</span></span> | <span data-ttu-id="4459e-142">否</span><span class="sxs-lookup"><span data-stu-id="4459e-142">No</span></span>| <span data-ttu-id="4459e-143">Internet Explorer 11</span><span class="sxs-lookup"><span data-stu-id="4459e-143">Internet Explorer 11</span></span>|
|<span data-ttu-id="4459e-144">Windows 10 ver。 &nbsp; >= &nbsp;1903</span><span class="sxs-lookup"><span data-stu-id="4459e-144">Windows 10 ver.&nbsp;>=&nbsp;1903</span></span> | <span data-ttu-id="4459e-145">Microsoft 365 ver。 &nbsp; < &nbsp;16.0.11629<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="4459e-145">Microsoft 365 ver.&nbsp;<&nbsp;16.0.11629<sup>1</sup></span></span>| <span data-ttu-id="4459e-146">无关紧要</span><span class="sxs-lookup"><span data-stu-id="4459e-146">Doesn't matter</span></span>|<span data-ttu-id="4459e-147">Internet Explorer 11</span><span class="sxs-lookup"><span data-stu-id="4459e-147">Internet Explorer 11</span></span>|
|<span data-ttu-id="4459e-148">Windows 10 ver。 &nbsp; >= &nbsp;1903</span><span class="sxs-lookup"><span data-stu-id="4459e-148">Windows 10 ver.&nbsp;>=&nbsp;1903</span></span> | <span data-ttu-id="4459e-149">Microsoft 365 ver。 &nbsp; >= &nbsp;16.0.11629 &nbsp; _和_ &nbsp; < &nbsp; 16.0.13127.20082<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="4459e-149">Microsoft 365 ver.&nbsp;>=&nbsp;16.0.11629&nbsp;_AND_&nbsp;<&nbsp;16.0.13127.20082<sup>1</sup></span></span>| <span data-ttu-id="4459e-150">无关紧要</span><span class="sxs-lookup"><span data-stu-id="4459e-150">Doesn't matter</span></span>|<span data-ttu-id="4459e-151">Microsoft Edge<sup>2、3</sup> 和原始 web 视图 (EdgeHTML) </span><span class="sxs-lookup"><span data-stu-id="4459e-151">Microsoft Edge<sup>2, 3</sup> with original WebView (EdgeHTML)</span></span>|
|<span data-ttu-id="4459e-152">Windows 10 ver。 &nbsp; >= &nbsp;1903</span><span class="sxs-lookup"><span data-stu-id="4459e-152">Windows 10 ver.&nbsp;>=&nbsp;1903</span></span> | <span data-ttu-id="4459e-153">Microsoft 365 ver。 &nbsp; >= &nbsp;16.0.13127.20082<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="4459e-153">Microsoft 365 ver.&nbsp;>=&nbsp;16.0.13127.20082<sup>1</sup></span></span>| <span data-ttu-id="4459e-154">否</span><span class="sxs-lookup"><span data-stu-id="4459e-154">No</span></span> |<span data-ttu-id="4459e-155">Microsoft Edge<sup>2、3</sup> 和原始 web 视图 (EdgeHTML) </span><span class="sxs-lookup"><span data-stu-id="4459e-155">Microsoft Edge<sup>2, 3</sup> with original WebView (EdgeHTML)</span></span>|
|<span data-ttu-id="4459e-156">Windows 8.1</span><span class="sxs-lookup"><span data-stu-id="4459e-156">Windows 8.1</span></span><br><span data-ttu-id="4459e-157">Windows 10</span><span class="sxs-lookup"><span data-stu-id="4459e-157">Windows 10</span></span>| <span data-ttu-id="4459e-158">Microsoft 365 ver。 &nbsp; >= &nbsp;16.0.13127.20082<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="4459e-158">Microsoft 365 ver.&nbsp;>=&nbsp;16.0.13127.20082<sup>1</sup></span></span>| <span data-ttu-id="4459e-159">是</span><span class="sxs-lookup"><span data-stu-id="4459e-159">Yes</span></span>|  <span data-ttu-id="4459e-160">请参阅下面的注释4。</span><span class="sxs-lookup"><span data-stu-id="4459e-160">See note 4 below.</span></span> |

<span data-ttu-id="4459e-161"><sup>1</sup> 有关更多详细信息，请参阅 " [更新历史记录" 页面](/officeupdates/update-history-office365-proplus-by-date) 以及如何 [查找 Office 客户端版本和更新频道](https://support.office.com/article/What-version-of-Office-am-I-using-932788b8-a3ce-44bf-bb09-e334518b8b19) 。</span><span class="sxs-lookup"><span data-stu-id="4459e-161"><sup>1</sup> See the [update history page](/officeupdates/update-history-office365-proplus-by-date) and how to [find your Office client version and update channel](https://support.office.com/article/What-version-of-Office-am-I-using-932788b8-a3ce-44bf-bb09-e334518b8b19) for more details.</span></span>

<span data-ttu-id="4459e-162"><sup>2</sup> 当使用 Microsoft Edge 时，Windows 10 讲述人 (有时称为 "屏幕阅读器" ) 读取 `<title>` 在任务窗格中打开的页面中的标记。</span><span class="sxs-lookup"><span data-stu-id="4459e-162"><sup>2</sup> When Microsoft Edge is being used, the Windows 10 Narrator (sometimes called a "screen reader") reads the `<title>` tag in the page that opens in the task pane.</span></span> <span data-ttu-id="4459e-163">如果使用的是 Internet Explorer 11，则Narrator 将会读取任务窗格的标题栏，它来自加载项清单中的 `<DisplayName>` 值。</span><span class="sxs-lookup"><span data-stu-id="4459e-163">When Internet Explorer 11 is being used, the Narrator reads the title bar of the task pane, which comes from the `<DisplayName>` value in the add-in's manifest.</span></span>

<span data-ttu-id="4459e-164"><sup>3</sup> 如果加载项包括 `Runtimes` 清单中的元素，则使用 Internet Explorer 11，而不考虑 Windows 或 Microsoft 365 版本。</span><span class="sxs-lookup"><span data-stu-id="4459e-164"><sup>3</sup> If your add-in includes the `Runtimes` element in the manifest, it uses Internet Explorer 11 regardless of the Windows or Microsoft 365 version.</span></span> <span data-ttu-id="4459e-165">有关详细信息，请参阅[运行时](../reference/manifest/runtimes.md)。</span><span class="sxs-lookup"><span data-stu-id="4459e-165">For more information, see [Runtimes](../reference/manifest/runtimes.md).</span></span>

<span data-ttu-id="4459e-166"><sup>4</sup> 用于此版本组合的浏览器取决于 Microsoft 365 订阅的更新通道。</span><span class="sxs-lookup"><span data-stu-id="4459e-166"><sup>4</sup> The browser that is used for this combination of versions depends on the update channel of the Microsoft 365 subscription.</span></span> <span data-ttu-id="4459e-167">如果用户在 [Beta 通道](https://insider.office.com/join/windows) 上 (以前的 "快速) " 快速频道 "，则 Office 将使用 Microsoft Edge 与 WebView2 (基于 Chromium 的) 。</span><span class="sxs-lookup"><span data-stu-id="4459e-167">If the user is on the [Beta channel](https://insider.office.com/join/windows) (formerly Insiders Fast channel), then Office uses Microsoft Edge with WebView2 (Chromium-based).</span></span> <span data-ttu-id="4459e-168">对于任何其他频道，Office 将 Microsoft Edge 与原始 Web 视图一起使用 (EdgeHTML) 。</span><span class="sxs-lookup"><span data-stu-id="4459e-168">For any other channel, Office uses Microsoft Edge with the original WebView (EdgeHTML).</span></span> <span data-ttu-id="4459e-169">对其他频道中的 WebView2 的支持预计在早期2021。</span><span class="sxs-lookup"><span data-stu-id="4459e-169">Support for WebView2 in other channels is expected in early 2021.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="4459e-170">Internet Explorer 11 不支持高于 ES5 的 JavaScript 版本。</span><span class="sxs-lookup"><span data-stu-id="4459e-170">Internet Explorer 11 does not support JavaScript versions later than ES5.</span></span> <span data-ttu-id="4459e-171">如果你的外接程序的任何用户具有使用 Internet Explorer 11 的平台，然后使用 ECMAScript 2015 或更高版本的语法和功能，则有两种选择：</span><span class="sxs-lookup"><span data-stu-id="4459e-171">If any of your add-in's users have platforms that use Internet Explorer 11, then to use the syntax and features of ECMAScript 2015 or later, you have two options:</span></span>
>
> - <span data-ttu-id="4459e-172">在 ECMAScript 2015 (也称为 ES6) 或更高版本 JavaScript，或在 TypeScript 中编写代码，然后使用编译器（如 [babel](https://babeljs.io/) 或 [tsc](https://www.typescriptlang.org/index.html)）将代码编译为 ES5 JavaScript。</span><span class="sxs-lookup"><span data-stu-id="4459e-172">Write your code in ECMAScript 2015 (also called ES6) or later JavaScript, or in TypeScript, and then compile your code to ES5 JavaScript using a compiler such as [babel](https://babeljs.io/) or [tsc](https://www.typescriptlang.org/index.html).</span></span>
> - <span data-ttu-id="4459e-173">在 ECMAScript 2015 或更高版本的 JavaScript 中编写，但还要加载一个 [polyfill](https://wikipedia.org/wiki/Polyfill_(programming)) 库，如 [core-JS](https://github.com/zloirock/core-js) ，使 IE 能够运行您的代码。</span><span class="sxs-lookup"><span data-stu-id="4459e-173">Write in ECMAScript 2015 or later JavaScript, but also load a [polyfill](https://wikipedia.org/wiki/Polyfill_(programming)) library such as [core-js](https://github.com/zloirock/core-js) that enables IE to run your code.</span></span>
>
> <span data-ttu-id="4459e-174">此外，Internet Explorer 11 不支持媒体、录制和位置等部分 HTML5 功能。</span><span class="sxs-lookup"><span data-stu-id="4459e-174">Also, Internet Explorer 11 does not support some HTML5 features such as media, recording, and location.</span></span>

## <a name="troubleshooting-microsoft-edge-issues"></a><span data-ttu-id="4459e-175">Microsoft Edge 问题故障排除</span><span class="sxs-lookup"><span data-stu-id="4459e-175">Troubleshooting Microsoft Edge issues</span></span>

### <a name="service-workers-are-not-working"></a><span data-ttu-id="4459e-176">服务工作人员不工作</span><span class="sxs-lookup"><span data-stu-id="4459e-176">Service Workers are not working</span></span>

<span data-ttu-id="4459e-177">使用原始 [Microsoft Edge Web 视图](/microsoft-edge/hosting/webview) 时，Office 外接程序不支持服务工作人员。</span><span class="sxs-lookup"><span data-stu-id="4459e-177">Office Add-ins do not support Service Workers when the original [Microsoft Edge WebView](/microsoft-edge/hosting/webview) is used.</span></span> <span data-ttu-id="4459e-178">它们在 [基于 Chromium 的边缘 WebView2](/microsoft-edge/hosting/webview2)中受支持。</span><span class="sxs-lookup"><span data-stu-id="4459e-178">They are supported with the [Chromium-based Edge WebView2](/microsoft-edge/hosting/webview2).</span></span>

### <a name="scroll-bar-does-not-appear-in-task-pane"></a><span data-ttu-id="4459e-179">任务窗格中不显示滚动条</span><span class="sxs-lookup"><span data-stu-id="4459e-179">Scroll bar does not appear in task pane</span></span>

<span data-ttu-id="4459e-180">默认情况下，Microsoft Edge 中的滚动条是隐藏的，直到在其上悬停时。</span><span class="sxs-lookup"><span data-stu-id="4459e-180">By default, scroll bars in Microsoft Edge are hidden until hovered over.</span></span> <span data-ttu-id="4459e-181">适用于任务窗格中页面的 `<body>` 元素的 CSS 样式应包含 [-ms-overflow-style](https://developer.mozilla.org/docs/Web/CSS/-ms-overflow-style) 属性，且应将其设置为 `scrollbar`。</span><span class="sxs-lookup"><span data-stu-id="4459e-181">To ensure that the scroll bar is always visible, the CSS styling that applies to the `<body>` element of the pages in the task pane should include the [-ms-overflow-style](https://developer.mozilla.org/docs/Web/CSS/-ms-overflow-style) property and it should be set to `scrollbar`.</span></span> 

### <a name="when-debugging-with-the-microsoft-edge-devtools-the-add-in-crashes-or-reloads"></a><span data-ttu-id="4459e-182">使用 Microsoft Edge 开发工具进行调试时，加载项会崩溃或重新加载</span><span class="sxs-lookup"><span data-stu-id="4459e-182">When debugging with the Microsoft Edge DevTools, the add-in crashes or reloads</span></span>

<span data-ttu-id="4459e-183">[Microsoft Edge 开发工具](https://www.microsoft.com/p/microsoft-edge-devtools-preview/9mzbfrmz0mnj?rtc=1&activetab=pivot%3Aoverviewtab)中的设置断点可能导致 Office 认为该加载项已挂起。</span><span class="sxs-lookup"><span data-stu-id="4459e-183">Setting breakpoints in the [Microsoft Edge DevTools](https://www.microsoft.com/p/microsoft-edge-devtools-preview/9mzbfrmz0mnj?rtc=1&activetab=pivot%3Aoverviewtab) can cause Office to think that the add-in is hung.</span></span> <span data-ttu-id="4459e-184">发生这种情况时，它将自动重新加载该加载项。</span><span class="sxs-lookup"><span data-stu-id="4459e-184">It will automatically reload the add-in when this happens.</span></span> <span data-ttu-id="4459e-185">为防止这种情况，请将以下注册表项和值添加到开发计算机：`[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\16.0\Wef]"AlertInterval"=dword:00000000`。</span><span class="sxs-lookup"><span data-stu-id="4459e-185">To prevent this, add the following Registry key and value to the development computer: `[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\16.0\Wef]"AlertInterval"=dword:00000000`.</span></span>

### <a name="when-the-add-in-tries-to-open-get-add-in-error-we-cant-open-this-add-in-from-the-localhost-error"></a><span data-ttu-id="4459e-186">加载项尝试打开时，出现“加载项错误 我们无法从 localhost 打开此加载项”错误</span><span class="sxs-lookup"><span data-stu-id="4459e-186">When the add-in tries to open, get "ADD-IN ERROR We can't open this add-in from the localhost" error</span></span>

<span data-ttu-id="4459e-187">一个已知的原因是 Microsoft Edge 要求在开发计算机上为本地主机提供环回豁免。</span><span class="sxs-lookup"><span data-stu-id="4459e-187">One known cause is that Microsoft Edge requires that localhost be given a loopback exemption on the development computer.</span></span> <span data-ttu-id="4459e-188">按照[无法从 localhost 打开加载项](/office/troubleshoot/error-messages/cannot-open-add-in-from-localhost)中的说明操作。</span><span class="sxs-lookup"><span data-stu-id="4459e-188">Follow the instructions at [Cannot open add-in from localhost](/office/troubleshoot/error-messages/cannot-open-add-in-from-localhost).</span></span>

### <a name="get-errors-trying-to-download-a-pdf-file"></a><span data-ttu-id="4459e-189">在尝试下载 PDF 文件时遇到错误</span><span class="sxs-lookup"><span data-stu-id="4459e-189">Get errors trying to download a PDF file</span></span>

<span data-ttu-id="4459e-190">当 Edge 为浏览器时，不支持直接在外接程序中将 blob 作为 PDF 文件下载。</span><span class="sxs-lookup"><span data-stu-id="4459e-190">Directly downloading blobs as PDF files in an add-in is not supported when Edge is the browser.</span></span> <span data-ttu-id="4459e-191">解决方法是创建一个简单的 web 应用程序，将 blob 下载为 PDF 文件。</span><span class="sxs-lookup"><span data-stu-id="4459e-191">The workaround is to create a simple web application that downloads blobs as PDF files.</span></span> <span data-ttu-id="4459e-192">在加载项中，调用 `Office.context.ui.openBrowserWindow(url)` 方法并传递 web 应用程序的 URL。</span><span class="sxs-lookup"><span data-stu-id="4459e-192">In your add-in, call the `Office.context.ui.openBrowserWindow(url)` method and pass the URL of the web application.</span></span> <span data-ttu-id="4459e-193">这将在 Office 外部的浏览器窗口中打开 web 应用程序。</span><span class="sxs-lookup"><span data-stu-id="4459e-193">This will open the web application in a browser window outside of Office.</span></span>

## <a name="see-also"></a><span data-ttu-id="4459e-194">另请参阅</span><span class="sxs-lookup"><span data-stu-id="4459e-194">See also</span></span>

- [<span data-ttu-id="4459e-195">Office 加载项的运行要求</span><span class="sxs-lookup"><span data-stu-id="4459e-195">Requirements for Running Office Add-ins</span></span>](requirements-for-running-office-add-ins.md)
