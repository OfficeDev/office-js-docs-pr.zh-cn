---
title: 在不使用 SSO 的情况下对 Microsoft Graph 授权
description: ''
ms.date: 08/07/2019
localization_priority: Priority
ms.openlocfilehash: 0bf79daa74542d36d90976dfd3f699591a8646a6
ms.sourcegitcommit: 1dc1bb0befe06d19b587961da892434bd0512fb5
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/13/2019
ms.locfileid: "36302931"
---
# <a name="authorize-to-microsoft-graph-without-sso"></a><span data-ttu-id="0da5c-102">在不使用 SSO 的情况下对 Microsoft Graph 授权</span><span class="sxs-lookup"><span data-stu-id="0da5c-102">Authorize to Microsoft Graph without SSO</span></span>

<span data-ttu-id="0da5c-103">可通过从 Azure Active Directory (AAD) 获取 Graph 的访问令牌，获得加载项的 Microsoft Graph 数据的授权。</span><span class="sxs-lookup"><span data-stu-id="0da5c-103">You can get authorization to Microsoft Graph data for your add-in by obtaining an access token to Graph from Azure Active Directory (AAD).</span></span> <span data-ttu-id="0da5c-104">你可同在任何其他 Web 应用程序中一样，使用授权代码流或隐式流执行此操作，但存在一个例外：AAD 禁止其登录页在 iframe 中打开。</span><span class="sxs-lookup"><span data-stu-id="0da5c-104">You do this using either the Authorization Code flow or the Implicit Flow just as you would any in any other web application with one exception: AAD does not allow its login page to open in an iframe.</span></span> <span data-ttu-id="0da5c-105">当 Office 加载项在 *Office 网页版*中运行时，任务窗格是一个 iframe。</span><span class="sxs-lookup"><span data-stu-id="0da5c-105">When an Office Add-in is running on *Office on the web*, the task pane is an iframe.</span></span> <span data-ttu-id="0da5c-106">这意味着你将需要在通过 Office 对话框 API 打开的对话框中打开 AAD 登录屏幕。</span><span class="sxs-lookup"><span data-stu-id="0da5c-106">This means that you will need to open the AAD login screen in a dialog opened with the Office Dialog API.</span></span> <span data-ttu-id="0da5c-107">这将影响你使用身份验证和授权帮助程序库的方式。</span><span class="sxs-lookup"><span data-stu-id="0da5c-107">This will effect how you use authentication and authorization helper libraries.</span></span> <span data-ttu-id="0da5c-108">有关详细信息，请参阅[使用 Office 对话框 API 进行身份验证](auth-with-office-dialog-api.md)。</span><span class="sxs-lookup"><span data-stu-id="0da5c-108">For more information, see [Authentication with the Office Dialog API](auth-with-office-dialog-api.md).</span></span>

<span data-ttu-id="0da5c-109">要了解如何使用 AAD 对身份验证进行编程，首先请查看 [Microsoft 标识平台 (v2.0) 概述](/azure/active-directory/develop/v2-overview)。</span><span class="sxs-lookup"><span data-stu-id="0da5c-109">For information about programming authentication with AAD, begin with [Microsoft identity platform (v2.0) overview](/azure/active-directory/develop/v2-overview).</span></span> <span data-ttu-id="0da5c-110">该文档集中有很多教程和指南，还有相关示例的链接。</span><span class="sxs-lookup"><span data-stu-id="0da5c-110">There are many tutorials and guides in that documentation set, as well as links to relevant samples.</span></span> <span data-ttu-id="0da5c-111">再次提醒一下：你可能需要调整示例中的代码以在 Office 对话框中运行, 以考虑该对话框在与任务窗格不同的进程中运行的情况。</span><span class="sxs-lookup"><span data-stu-id="0da5c-111">Once again a reminder: you may need to adjust the code in the samples to run in the Office Dialog to account for the fact that the Dialog runs in a separate process from the task pane.</span></span>

<span data-ttu-id="0da5c-112">代码获取 Microsoft Graph 的访问令牌后，可将访问令牌从对话框传递到任务窗格，或将令牌存储在数据库中, 并向任务窗格发出通知，表明该令牌可用。</span><span class="sxs-lookup"><span data-stu-id="0da5c-112">After your code has obtained the access token to Microsoft Graph, either it passes the access token from the dialog to the task pane, or it stores the token in a database and signals the task pane that the token is available there.</span></span> <span data-ttu-id="0da5c-113">（有关详细信息，请参阅[ Office 对话框 API 的身份验证](auth-with-office-dialog-api.md)）任务窗格中的代码请求从 Microsoft Graph 中获得数据, 并将令牌包含在这些请求中。</span><span class="sxs-lookup"><span data-stu-id="0da5c-113">(See [Authentication with the Office Dialog API](auth-with-office-dialog-api.md) for details.) Code in the task pane requests data from Microsoft Graph, and includes the token in those requests.</span></span> <span data-ttu-id="0da5c-114">有关调用 Microsoft Graph 和 Microsoft Graph 的 SDK 的详细信息，请参阅[Microsoft Graph 文档](/graph/)。</span><span class="sxs-lookup"><span data-stu-id="0da5c-114">For more information about calling Microsoft Graph and the SDKs for Microsoft Graph, see [Microsoft Graph documentation](/graph/).</span></span>

## <a name="recommended-libraries-and-samples"></a><span data-ttu-id="0da5c-115">推荐的库和示例</span><span class="sxs-lookup"><span data-stu-id="0da5c-115">Recommended libraries and samples</span></span>

<span data-ttu-id="0da5c-116">建议在不使用 SSO 访问 Microsoft Graph 时使用下列库：</span><span class="sxs-lookup"><span data-stu-id="0da5c-116">We recommend that you use the following libraries when accessing Microsoft Graph without using SSO:</span></span>

- <span data-ttu-id="0da5c-117">对于使用服务器端并采用基于网络的框架（如 .NET Core 或 ASP.NET）的加载项，请使用 [MSAL.NET](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki#conceptual-documentation)。</span><span class="sxs-lookup"><span data-stu-id="0da5c-117">For add-ins using a server-side with a .NET-based framework such as .NET Core or ASP.NET, use [MSAL.NET](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki#conceptual-documentation).</span></span>
- <span data-ttu-id="0da5c-118">对于使用基于 NodeJS 的服务器端的加载项, 请使用[Passport Azure AD](https://github.com/AzureAD/passport-azure-ad)。</span><span class="sxs-lookup"><span data-stu-id="0da5c-118">For add-ins using a NodeJS-based server-side, use [Passport Azure AD](https://github.com/AzureAD/passport-azure-ad).</span></span>
- <span data-ttu-id="0da5c-119">对于使用隐式流的加载项，请使用[msal.js](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki)。</span><span class="sxs-lookup"><span data-stu-id="0da5c-119">For add-ins using the Implicit flow, use [msal.js](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki).</span></span>

<span data-ttu-id="0da5c-120">有关使用 Microsoft 标识平台 (以前称为 "AAD v. 2.0") 的推荐库的详细信息，请参阅Microsoft 标识平台身份验证库](/azure/active-directory/develop/reference-v2-libraries.md)。</span><span class="sxs-lookup"><span data-stu-id="0da5c-120">For more information about recommended libraries for working with Microsoft Identity Platform (formerly AAD v.2.0), see [Microsoft identity platform authentication libraries](/azure/active-directory/develop/reference-v2-libraries.md).</span></span>

<span data-ttu-id="0da5c-121">以下示例从 Office 加载项获取 Microsoft Graph 数据：</span><span class="sxs-lookup"><span data-stu-id="0da5c-121">The following samples get Microsoft Graph data from an Office Add-in:</span></span>

- [<span data-ttu-id="0da5c-122">Office 加载项 Microsoft Graph ASP.NET</span><span class="sxs-lookup"><span data-stu-id="0da5c-122">Office Add-in Microsoft Graph ASP.NET</span></span>](https://github.com/OfficeDev/office-add-in-microsoft-graph-aspnet)
- [<span data-ttu-id="0da5c-123">Outlook 加载项 Microsoft Graph ASP.NET</span><span class="sxs-lookup"><span data-stu-id="0da5c-123">Outlook Add-in Microsoft Graph ASP.NET</span></span>](https://github.com/OfficeDev/outlook-add-in-microsoft-graph-aspnet)

