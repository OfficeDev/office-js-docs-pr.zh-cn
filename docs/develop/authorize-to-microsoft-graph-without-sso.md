---
title: 在不使用 SSO 的情况下对 Microsoft Graph 授权
description: 了解如何在不使用 SSO 的情况下对 Microsoft Graph 授权
ms.date: 01/29/2020
localization_priority: Priority
ms.openlocfilehash: a7dbd1fdd85852a82fcb00050283fece84a04e04
ms.sourcegitcommit: 4c9e02dac6f8030efc7415e699370753ec9415c8
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/01/2020
ms.locfileid: "41649968"
---
# <a name="authorize-to-microsoft-graph-without-sso"></a><span data-ttu-id="643af-103">在不使用 SSO 的情况下对 Microsoft Graph 授权</span><span class="sxs-lookup"><span data-stu-id="643af-103">Authorize to Microsoft Graph without SSO</span></span>

<span data-ttu-id="643af-104">你的加载项可通过从 Azure Active Directory (AAD) 获取 Graph 的访问令牌，获得 Microsoft Graph 数据的授权。</span><span class="sxs-lookup"><span data-stu-id="643af-104">Your add-in can get authorization to Microsoft Graph data by obtaining an access token to Graph from Azure Active Directory (AAD).</span></span> <span data-ttu-id="643af-105">可同在任何其他 Web 应用程序中一样，使用授权代码流或隐式流执行此操作，但存在一个例外：AAD 禁止其登录页在 iframe 中打开。</span><span class="sxs-lookup"><span data-stu-id="643af-105">Use either the Authorization Code flow or the Implicit flow just as you would in other web applications but with one exception: AAD does not allow its login page to open in an iframe.</span></span> <span data-ttu-id="643af-106">当 Office 加载项在 *Office 网页版*中运行时，任务窗格是一个 iFrame。</span><span class="sxs-lookup"><span data-stu-id="643af-106">When an Office Add-in is running on *Office on the web*, the task pane is an iframe.</span></span> <span data-ttu-id="643af-107">这意味着将需要在通过 Office 对话框 API 打开的对话框中打开 AAD 登录屏幕。</span><span class="sxs-lookup"><span data-stu-id="643af-107">This means you'll need to open the AAD login screen in a dialog box opened with the Office dialog API.</span></span> <span data-ttu-id="643af-108">这将影响你使用身份验证和授权帮助程序库的方式。</span><span class="sxs-lookup"><span data-stu-id="643af-108">This affects how you use authentication and authorization helper libraries.</span></span> <span data-ttu-id="643af-109">有关详细信息，请参阅[使用 Office 对话框 API 进行身份验证](auth-with-office-dialog-api.md)。</span><span class="sxs-lookup"><span data-stu-id="643af-109">For more information, see [Authentication with the Office dialog API](auth-with-office-dialog-api.md).</span></span>

<span data-ttu-id="643af-110">有关使用 AAD 设置身份验证的信息，请先参阅[Microsoft 标识平台 (v2.0) 概览](/azure/active-directory/develop/v2-overview)，其中可找到此文档集中的教程和指南以及相关示例的链接。</span><span class="sxs-lookup"><span data-stu-id="643af-110">For information about programming authentication with AAD, begin with [Microsoft identity platform (v2.0) overview](/azure/active-directory/develop/v2-overview), where you'll find tutorials and guides in that documentation set, as well as links to relevant samples.</span></span> <span data-ttu-id="643af-111">另外可能需要调整示例中的代码以在 Office 对话框中运行, 以考虑该 Office 对话框在与任务窗格不同的进程中运行的情况。</span><span class="sxs-lookup"><span data-stu-id="643af-111">Once again, you may need to adjust the code in the samples to run in the Office dialog box to account for the fact that the Office dialog box runs in a separate process from the task pane.</span></span>

<span data-ttu-id="643af-112">代码获取 Microsoft Graph 的访问令牌后，可将访问令牌从对话框传递到任务窗格，或将令牌存储在数据库中, 并向任务窗格发出通知，表明该令牌可用。</span><span class="sxs-lookup"><span data-stu-id="643af-112">After your code obtains the access token to Graph, either it passes the access token from the dialog box to the task pane, or it stores the token in a database and signals the task pane that the token is available.</span></span> <span data-ttu-id="643af-113">（有关详细信息，请参阅 [Office 对话框 API 的身份验证](auth-with-office-dialog-api.md)）任务窗格中的代码请求从 Microsoft Graph 中获得数据, 并将令牌包含在这些请求中。</span><span class="sxs-lookup"><span data-stu-id="643af-113">(See [Authentication with the Office dialog API](auth-with-office-dialog-api.md) for details.) Code in the task pane requests data from Graph, and includes the token in those requests.</span></span> <span data-ttu-id="643af-114">有关调用 Microsoft Graph 和 Microsoft Graph SDK 的详细信息，请参阅[Microsoft Graph 文档](/graph/)。</span><span class="sxs-lookup"><span data-stu-id="643af-114">For more information about calling Graph and the Graph SDKs, see [Microsoft Graph documentation](/graph/).</span></span>

## <a name="recommended-libraries-and-samples"></a><span data-ttu-id="643af-115">推荐的库和示例</span><span class="sxs-lookup"><span data-stu-id="643af-115">Recommended libraries and samples</span></span>

<span data-ttu-id="643af-116">建议在不使用 SSO 访问 Microsoft Graph 时使用下列库：</span><span class="sxs-lookup"><span data-stu-id="643af-116">We recommend that you use the following libraries when accessing Microsoft Graph without using SSO:</span></span>

- <span data-ttu-id="643af-117">对于使用服务器端并采用基于网络的框架（如 .NET Core 或 ASP.NET）的加载项，请使用 [MSAL.NET](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki#conceptual-documentation)。</span><span class="sxs-lookup"><span data-stu-id="643af-117">For add-ins using a server-side with a .NET-based framework such as .NET Core or ASP.NET, use [MSAL.NET](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki#conceptual-documentation).</span></span>
- <span data-ttu-id="643af-118">对于使用基于 NodeJS 的服务器端的加载项, 请使用[Passport Azure AD](https://github.com/AzureAD/passport-azure-ad)。</span><span class="sxs-lookup"><span data-stu-id="643af-118">For add-ins using a NodeJS-based server-side, use [Passport Azure AD](https://github.com/AzureAD/passport-azure-ad).</span></span>
- <span data-ttu-id="643af-119">对于使用隐式流的加载项，请使用[msal.js](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki)。</span><span class="sxs-lookup"><span data-stu-id="643af-119">For add-ins using the Implicit flow, use [msal.js](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki).</span></span>

<span data-ttu-id="643af-120">有关使用 Microsoft 标识平台 (以前称为 "AAD v. 2.0") 的推荐库的详细信息，请参阅[Microsoft 标识平台身份验证库](/azure/active-directory/develop/reference-v2-libraries)。</span><span class="sxs-lookup"><span data-stu-id="643af-120">For more information about recommended libraries for working with Microsoft Identity Platform (formerly AAD v.2.0), see [Microsoft identity platform authentication libraries](/azure/active-directory/develop/reference-v2-libraries).</span></span>

<span data-ttu-id="643af-121">以下示例从 Office 加载项获取 Microsoft Graph 数据：</span><span class="sxs-lookup"><span data-stu-id="643af-121">The following samples get Microsoft Graph data from an Office Add-in:</span></span>

- [<span data-ttu-id="643af-122">Office 加载项 Microsoft Graph ASP.NET</span><span class="sxs-lookup"><span data-stu-id="643af-122">Office Add-in Microsoft Graph ASP.NET</span></span>](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Samples/auth/Office-Add-in-Microsoft-Graph-ASPNET)
- [<span data-ttu-id="643af-123">Outlook 加载项 Microsoft Graph ASP.NET</span><span class="sxs-lookup"><span data-stu-id="643af-123">Outlook Add-in Microsoft Graph ASP.NET</span></span>](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Samples/auth/Outlook-Add-in-Microsoft-Graph-ASPNET)
- [<span data-ttu-id="643af-124">Office 加载项 Microsoft Graph React</span><span class="sxs-lookup"><span data-stu-id="643af-124">Office Add-in Microsoft Graph React</span></span>](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Samples/auth/Office-Add-in-Microsoft-Graph-React)
