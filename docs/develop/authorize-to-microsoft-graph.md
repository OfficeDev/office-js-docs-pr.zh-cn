---
title: ??? Office ?????? Microsoft Graph ??
description: ''
ms.date: 04/10/2018
ms.openlocfilehash: 495aa5554550d10711c418339d412e3a312d02fb
ms.sourcegitcommit: c72c35e8389c47a795afbac1b2bcf98c8e216d82
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/23/2018
ms.locfileid: "19437463"
---
# <a name="authorize-to-microsoft-graph-in-your-office-add-in-preview"></a>??? Office ??????????? Microsoft Graph??

??????????? Microsoft ??/????? (Office 365) ????? Office????????????? Office ?????? [Microsoft Graph](https://developer.microsoft.com/graph/docs) ????????????????? Office ????? ?????Office ????????? Microsoft Graph ??????????? 

> [!NOTE]
> ???Word?Excel?Outlook ? PowerPoint ????????? API? ?????????????? API ??????? [IdentityAPI ???](https://dev.office.com/reference/add-ins/requirement-sets/identity-api-requirement-sets)?
> ?????? Outlook ???????? Office 365 ????????? ????????????? [Exchange Online????????????](https://social.technet.microsoft.com/wiki/contents/articles/32711.exchange-online-how-to-enable-your-tenant-for-modern-authentication.aspx)?

## <a name="add-in-architecture-for-sso-and-microsoft-graph"></a>?? SSO ? Microsoft Graph ?????????

???? Web ???????? JavaScript ??????????????[???????](https://msdn.microsoft.com/en-us/library/windows/desktop/ms682135.aspx#_dns_fully_qualified_domain_name_fqdn__gly)??????? Web API??? API ??? Microsoft Graph ??????????????

???????????????????? Azure Active Directory (Azure AD) v2.0 ???????????????????? Microsoft Graph ??????

### <a name="how-it-works-at-runtime"></a>Microsoft Graph ????????

???????? Microsoft Graph ?????????????

![SSO ?????](../images/sso-access-to-microsoft-graph.png)

1. ??????JavaScript ???? Office.js API `getAccessTokenAsync`? ???? Office ??????????????????? ???????? **????????** ??????????????????? ???????????????????? [??????](sso-in-office-add-ins.md#example-access-token)?
1. ????????Office ?????????????????????
1. ?????????????????????????
1. Office ???????????? Azure AD v2.0 ?????? **????????**?
1. Azure AD ?????????? Office ???????
1. Office ????????????? **????????** ??? `getAccessTokenAsync` ?????????????
1. ?????? JavaScript ? Web API????????????????????? HTTP ?????? **????????** ???????  
1. ?????????? **????????**?
1. ??????????????? [OAuth2 ????](https://tools.ietf.org/html/draft-ietf-oauth-token-exchange-02) ? [Web API Azure ???????????????](https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-authentication-scenarios#daemon-or-server-application-to-web-api)?????? Microsoft Graph ?????????????????
1. Azure AD ? Microsoft Graph ???? ??????????? *offline_access* ?????????????????????
1. ???????????????? Microsoft Graph?
1. ??????? Microsoft Graph ?????????????? Microsoft Graph ??
1. Microsoft Graph ??????????????????????? UI?
1. ? Microsoft Graph ???????????????????????????? Microsoft Graph ?????

## <a name="develop-an-sso-add-in-that-accesses-microsoft-graph"></a>?????? Microsoft Graph ? SSO ????

?????????? SSO ????????????????? Microsoft Graph ?????? ?????????? [? Office ??????????](https://docs.microsoft.com/en-us/office/dev/add-ins/develop/sso-in-office-add-ins)????????????? Microsoft Graph ????????????? Web API ??????????????????????? 

???????????????????????????????? ???????????

* ?????????????????????????????? ?????????? [??????](sso-in-office-add-ins.md#validate-the-access-token)? 
* ???? Azure AD v2.0 ???????????????????????????????????????????????? ID ?????
* ??????????? Microsoft Graph? ?????????????? [Azure Active Directory v2.0 ? OAuth 2.0 ???](https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-v2-protocols-oauth-on-behalf-of)?
* ????????????? Microsoft Graph?????????? Microsoft Graph ??? Web API ???

> [!NOTE]
> ?????????????? Microsoft Graph ?????????? [Azure Active Directory v2.0 ? OAuth 2.0 ???](https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-v2-protocols-oauth-on-behalf-of)?

???????????????????

* [????????? Node.js Office ?????????](create-sso-office-add-ins-nodejs.md)
* [????????? ASP.NET Office ????](create-sso-office-add-ins-aspnet.md)
* [?????? Outlook ?????????????](https://docs.microsoft.com/en-us/outlook/add-ins/implement-sso-in-outlook-add-in)



