---
title: ?????? Excel?Word ? PowerPoint ??????
description: ?????? VersionOverrides ?? Excel?Word ? PowerPoint ?????? ?????????? UI ????????????????????????
ms.date: 12/04/2017
ms.openlocfilehash: 95861fe0de6f0f56f6436b98cd7ad8dee510e82d
ms.sourcegitcommit: c72c35e8389c47a795afbac1b2bcf98c8e216d82
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/23/2018
---
# <a name="create-add-in-commands-in-your-manifest-for-excel-word-and-powerpoint"></a>?????? Excel?Word ? PowerPoint ?????


?????? **[VersionOverrides](https://dev.office.com/reference/add-ins/manifest/versionoverrides)** ?? Excel?Word ? PowerPoint ?????? ????????????????? UI ????????? Office ???? (UI) ?????? ????????????????
- ?? UI ?????????????????????????  
  
- ?????????????????    
  
- ??????????????????????????????????????    
  
- ????????????????????
    
  - ??????????????????????????????????????????? Office UI ??????? UI ? HTML?
    
     *??* 
      
  - ?? JavaScript ?????????????? UI ???????
      
?????????????????????????????????????????????????????????? 
      
??????????????????? 
![?????????????](../images/version-overrides.png)
 
## <a name="step-1-start-from-a-sample"></a>? 1 ???????

????? [Office ???????](https://github.com/OfficeDev/Office-Add-in-Command-Sample)?????????????????????????????????????Office ???????????? XSD ??????????????????????? [Excel?Word ? PowerPoint ?????](../design/add-in-commands.md)?

## <a name="step-2-create-a-task-pane-add-in"></a>? 2 ???????????

??????????????????????????????????????????????????????????????????????? **XML ????**? **VersionOverrides** ??????????[? 3 ???? VersionOverrides ??](#step-3-add-versionoverrides-element)????
   
??????? Office 2013 ??????????????????????????? **VersionOverrides** ???Office 2013 ??????????????? **VersionOverrides** ??????????????? Office 2013 ? Office 2016 ????? Office 2013 ????????????????????? **SourceLocation** ?????????????????????? Office 2016 ??????? **VersionOverrides** ?????? **SourceLocation** ??????????????? **VersionOverrides**???????????????????????????????????????
  
```xml
<OfficeApp xmlns="http://schemas.microsoft.com/office/appforoffice/1.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0" xmlns:ov="http://schemas.microsoft.com/office/taskpaneappversionoverrides" xsi:type="TaskPaneApp">
  <Id>657a32a9-ab8a-4579-ac9f-df1a11a64e52</Id>
  <Version>1.0.0.0</Version>
  <ProviderName>Contoso</ProviderName>
  <DefaultLocale>en-US</DefaultLocale>
  <DisplayName DefaultValue="Contoso Add-in Commands" />
  <Description DefaultValue="Contoso Add-in Commands"/>
  <IconUrl DefaultValue="~remoteAppUrl/Images/Icon_32.png" />
 
  <AppDomains>
    <AppDomain>AppDomain1</AppDomain>
    <AppDomain>AppDomain2</AppDomain>
    <AppDomain>AppDomain3</AppDomain>
  </AppDomains>
  <Hosts>
    <Host Name="Workbook" />
  </Hosts>
  <DefaultSettings>
    <SourceLocation DefaultValue="https://www.contoso.com/Pages/Home.aspx" />
  </DefaultSettings>
  <Permissions>ReadWriteDocument</Permissions>

 <!-- The VersionOverrides element is inserted at this location in the manifest. -->

</OfficeApp>
```

## <a name="step-3-add-versionoverrides-element"></a>?? 3??? VersionOverrides ??
**VersionOverrides** ??????????????????**VersionOverrides** ???? **OfficeApp** ???????????? **VersionOverrides** ??????

|**??**|**??**|
|:-----|:-----|
|**xmlns** <br/> | ????????????http://schemas.microsoft.com/office/taskpaneappversionoverrides?? <br/> |
|**xsi:type** <br/> |?????????????????"VersionOverridesV1_0"?  <br/> |
   
????? **VersionOverrides** ?????
  
|**??**|**??**|
|:-----|:-----|
|**??** <br/> |????????????? **Description** ?????????????? **Description** ???? **Description** ??? **resid** ?????? **String** ??? **id**?**String** ???? **Description** ???? <br/> |
|**Requirements** <br/> |?????????????????? Office.js ??????? **Requirements** ????????????? **Requirements** ?????????????[?? Office ??? API ??](../develop/specify-office-hosts-and-api-requirements.md)?  <br/> |
|**Hosts** <br/> |????? Office ???????? **Hosts** ????????????? **Hosts** ????????????Workbook???Document?? **xsi:type** ?? <br/> |
|**Resources** <br/> |????????????????????URL ????????**Description** ??????? **Resources** ??????**Resources** ????????????[?? 7??? Resources ??](#step-7-add-the-resources-element)?????? <br/> |
   
??????????? **VersionOverrides** ????????

```xml
<OfficeApp>
...
  <VersionOverrides xmlns="http://schemas.microsoft.com/office/taskpaneappversionoverrides" xsi:type="VersionOverridesV1_0">
    <Description resid="residDescription" />
    <Requirements>
      <!-- add information about requirement sets -->
    </Requirements>
    <Hosts>
      <Host xsi:type="Workbook">
        <!-- add information about form factors -->
      </Host>
      <Host xsi:type="Document">
        <!-- add information about form factors -->
      </Host>
    </Hosts>
    <Resources> 
      <!-- add information about resources -->
    </Resources>
  </VersionOverrides>
...
</OfficeApp>
```

## <a name="step-4-add-hosts-host-and-desktopformfactor-elements"></a>?? 4??? Hosts?Host ? DesktopFormFactor ??

**Hosts** ????????? **Host** ????? **Host** ????????? Office ???**Host** ????????????????????? Office ???????????????????????????????? Office ???????????????????? **Host** ??????????
       
**DesktopFormFactor** ??????? Windows ??? Office ????? Office Online???????????????????
      
??????? **Hosts**?**Host** ? **DesktopFormFactor** ??????

```xml
<OfficeApp>
...
  <VersionOverrides xmlns="http://schemas.microsoft.com/office/taskpaneappversionoverrides" xsi:type="VersionOverridesV1_0">
  ...
    <Hosts>
      <Host xsi:type="Workbook">
        <DesktopFormFactor>

              <!-- information about FunctionFile and ExtensionPoint -->

        </DesktopFormFactor>
      </Host>
    </Hosts>
  ...
  </VersionOverrides>
...
</OfficeApp>
```

## <a name="step-5-add-the-functionfile-element"></a>?? 5??? FunctionFile ??

"FunctionFile"???????????????????????"ExecuteFunction"??????? JavaScript ?????? ?????????????"FunctionFile"???"resid"?????????????????? JavaScript ??? HTML ????????? JavaScript ???????????"Resources"????"Url"???********[](https://dev.office.com/reference/add-ins/manifest/control#Button-control)****************
        
???????? **FunctionFile** ???
  
```xml
<DesktopFormFactor>
    <FunctionFile resid="residDesktopFuncUrl" />
    <ExtensionPoint xsi:type="PrimaryCommandSurface">
      <!-- information about this extension point -->
    </ExtensionPoint> 

    <!-- You can define more than one ExtensionPoint element as needed -->
</DesktopFormFactor>
```

> [!IMPORTANT]
> ??? JavaScript ????? `Office.initialize`? 
   
**FunctionFile** ????? HTML ???? JavaScript ???? `Office.initialize`?**FunctionName** ??????[????](https://dev.office.com/reference/add-ins/manifest/control#Button-control)????????? **FunctionFile** ?????
     
???????????? **FunctionName** ??????

```javascript

<script>
    // The initialize function must be run each time a new page is loaded.
    (function () {
        Office.initialize = function (reason) {
            // If you need to initialize something you can do so here. 
        };
    })();

    // Your function must be in the global namespace.
    function writeText(event) {

        // Implement your custom code here. The following code is a simple example.  
        Office.context.document.setSelectedDataAsync("ExecuteFunction works. Button ID=" + event.source.id,
            function (asyncResult) {
                var error = asyncResult.error;
                if (asyncResult.status === "failed") {
                    // Show error message. 
                }
                else {
                    // Show success message.
                }
            });
        
        // Calling event.completed is required. event.completed lets the platform know that processing has completed. 
        event.completed();
    }
</script>
```

> [!IMPORTANT]
> ?? **event.completed** ?????????????????????????????????????????????????????????????????????????????? **event.completed**?????????????????????? **event.completed**??????????
 
## <a name="step-6-add-extensionpoint-elements"></a>? 6 ???? ExtensionPoint ??

**ExtensionPoint** ???????????? Office UI ??????????????? **xsi:type** ??? **ExtensionPoint** ???
   
- **PrimaryCommandSurface**???? Office ??????
     
- **ContextMenu**?????? Office UI ??????????????
    
?????????? **ExtensionPoint** ??? **PrimaryCommandSurface** ? **ContextMenu** ??????????????????????
    
> [!IMPORTANT]
> ???? ID ????????????? ID????????? ID ????????????????`<CustomTab id="mycompanyname.mygroupname">`? 
  
```xml
<ExtensionPoint xsi:type="PrimaryCommandSurface">
  <CustomTab id="Contoso Tab">
  <!-- If you want to use a default tab that comes with Office, remove the above CustomTab element, and then uncomment the following OfficeTab element -->
  <!-- <OfficeTab id="TabData"> -->
    <Label resid="residLabel4" />
    <Group id="Group1Id12">
      <Label resid="residLabel4" />
      <Icon>
        <bt:Image size="16" resid="icon1_32x32" />
        <bt:Image size="32" resid="icon1_32x32" />
        <bt:Image size="80" resid="icon1_32x32" />
      </Icon>
      <Tooltip resid="residToolTip" />
      <Control xsi:type="Button" id="Button1Id1">
        
        <!-- information about the control -->
      </Control>   
      <!-- other controls, as needed -->                                    
    </Group>
  </CustomTab>
</ExtensionPoint>
<ExtensionPoint xsi:type="ContextMenu">
  <OfficeMenu id="ContextMenuCell">
    <Control xsi:type="Menu" id="ContextMenu2">
            <!-- information about the control -->
    </Control>   
    <!-- other controls, as needed -->         
  </OfficeMenu>
</ExtensionPoint>
```

|**??**|**??**|
|:-----|:-----|
|**CustomTab** <br/> |??????? **PrimaryCommandSurface**???????????????????????? **CustomTab** ???????? **OfficeTab** ???**id** ??????? <br/> |
|**OfficeTab** <br/> |??????? **PrimaryCommandSurface**????? Office ????????????????? **OfficeTab** ???????? **CustomTab** ??? <br/> ??? **id** ????????? tab ?????[?? Office ??????? Tab ?](https://dev.office.com/reference/add-ins/manifest/officetab)?  <br/> |
|**OfficeMenu** <br/> | ?????? **ContextMenu**??????????????????????????**id** ???????? <br/> ??????????????????????? Excel ? Word ? **ContextMenuText**??????????? <br/> ??? Excel ? **ContextMenuCell**??????????????????????????????? <br/> |
|**Group** <br/> |???????????????????????????**id** ?????????????? 125 ???????? <br/> |
|**Label** <br/> |???????**resid** ??????? **String** ??? **id** ?????**String** ??? **ShortStrings** ???????? ShortStrings ??? **Resources** ??????? <br/> |
|**Icon** <br/> |?????????????????????????????????**resid** ??????? **Image** ??? **id** ?????**Image** ??? **Images** ???????? Images ??? **Resources** ???????**size** ???????????????????????????16?32 ? 80?????????????20?24?40?48 ? 64? <br/> |
|**Tooltip** <br/> |?????????**resid** ??????? **String** ??? **id** ?????**String** ??? **LongStrings** ???????? LongStrings ??? **Resources** ??????? <br/> |
|**Control** <br/> |??????????????**Control** ????? **Button**????? **Menu**??? **Menu** ???????????????????????????[????](https://dev.office.com/reference/add-ins/manifest/control)?[????](https://dev.office.com/reference/add-ins/manifest/control)?????????? <br/>**???**???????? **Control** ????? **Resources** ??????????????          |
   

### <a name="button-controls"></a>????
???????????????????????? JavaScript ??????????????????????????????????? UI ?????? JavaScript ???????????????? **Control** ????        

- **type** ?????????????? **Button**?
    
- **Control** ??? **id** ???????? 125 ????????
    
```xml
<!-- Define a control that calls a JavaScript function. -->
<Control xsi:type="Button" id="Button1Id1">
  <Label resid="residLabel" />
  <Tooltip resid="residToolTip" />
  <Supertip>
    <Title resid="residLabel" />
    <Description resid="residToolTip" />
  </Supertip>
  <Icon>
    <bt:Image size="16" resid="icon1_32x32" />
    <bt:Image size="32" resid="icon1_32x32" />
    <bt:Image size="80" resid="icon1_32x32" />
  </Icon>
  <Action xsi:type="ExecuteFunction">
    <FunctionName>getData</FunctionName>
  </Action>
</Control>

<!-- Define a control that shows a task pane. -->
<Control xsi:type="Button" id="Button2Id1">
  <Label resid="residLabel2" />
  <Tooltip resid="residToolTip" />
  <Supertip>
    <Title resid="residLabel" />
    <Description resid="residToolTip" />
  </Supertip>
  <Icon>
    <bt:Image size="16" resid="icon2_32x32" />
    <bt:Image size="32" resid="icon2_32x32" />
    <bt:Image size="80" resid="icon2_32x32" />
  </Icon>
  <Action xsi:type="ShowTaskpane">
    <SourceLocation resid="residUnitConverterUrl" />
  </Action>
</Control>
```

|**??**|**??**|
|:-----|:-----|
|**Label** <br/> |????????**resid** ??????? **String** ??? **id** ?????**String** ??? **ShortStrings** ???????? ShortStrings ??? **Resources** ??????? <br/> |
|**Tooltip** <br/> |???????????**resid** ??????? **String** ??? **id** ?????**String** ??? **LongStrings** ???????? LongStrings ??? **Resources** ??????? <br/> |
|**Supertip** <br/> | ??????? SuperTip?????? <br/> **??** <br/>  ???supertip ????????resid?????? String ??? id ????String ??? ShortStrings ????????  ????Resources???????? ************************<br/> **??** <br/>  ???supertip ????????resid?????? String ??? id ????String ??? LongStrings ????????  ????Resources???????? ************************<br/> |
|**Icon** <br/> | ???????? **Image** ?????????? .png ??? <br/> **Image** <br/>  ????????????**resid** ??????? **Image** ??? **id** ?????**Image** ??? **Images** ???????? Images ??? **Resources** ???????**size** ???????????????????????????16?32 ? 80?????????????20?24?40?48 ? 64? <br/> |
|**??** <br/> | ?????????????????????? **xsi:type** ???????????? <br/> **ExecuteFunction**?????? **FunctionFile** ??????? JavaScript ???**ExecuteFunction** ??? UI?**FunctionName** ??????????????? <br/> **ShowTaskPane**?????????????**SourceLocation** ????????????????????????**resid** ??????? **Resources** ??? **Urls** ??? **Url** ??? **id** ????? <br/> |
   

### <a name="menu-controls"></a>????
**Menu** ???? **PrimaryCommandSurface** ? **ContextMenu** ?????????
  
- ???????
   
- ????????
 
? **PrimaryCommandSurface** ?????????????????????????????????????????? **ContextMenu** ????????????????????????????????????????????? JavaScript ???????????????????????
       
???????????????????????????????????????????????? JavaScript ???? **Control** ????
    
- **xsi:type** ?????????????? **Menu**?
  
- **id** ???????? 125 ????????
    
```xml

<Control xsi:type="Menu" id="TestMenu2">
  <Label resid="residLabel3" />
  <Tooltip resid="residToolTip" />
  <Supertip>
    <Title resid="residLabel" />
    <Description resid="residToolTip" />
  </Supertip>
  <Icon>
    <bt:Image size="16" resid="icon1_32x32" />
    <bt:Image size="32" resid="icon1_32x32" />
    <bt:Image size="80" resid="icon1_32x32" />
  </Icon>
  <Items>
    <Item id="showGallery2">
      <Label resid="residLabel3"/>
      <Supertip>
        <Title resid="residLabel" />
        <Description resid="residToolTip" />
      </Supertip>
      <Icon>
        <bt:Image size="16" resid="icon1_32x32" />
        <bt:Image size="32" resid="icon1_32x32" />
        <bt:Image size="80" resid="icon1_32x32" />
      </Icon>
      <Action xsi:type="ShowTaskpane">
        <TaskpaneId>MyTaskPaneID1</TaskpaneId>
        <SourceLocation resid="residUnitConverterUrl" />
      </Action>
    </Item>
    <Item id="showGallery3">
      <Label resid="residLabel5"/>
      <Supertip>
        <Title resid="residLabel" />
        <Description resid="residToolTip" />
      </Supertip>
      <Icon>
        <bt:Image size="16" resid="icon4_32x32" />
        <bt:Image size="32" resid="icon4_32x32" />
        <bt:Image size="80" resid="icon4_32x32" />
      </Icon>
      <Action xsi:type="ExecuteFunction">
        <FunctionName>getButton</FunctionName>
      </Action>
    </Item>
  </Items>
</Control>
```

|**??**|**??**|
|:-----|:-----|
|**Label** <br/> |???????????**resid** ??????? **String** ??? **id** ?????**String** ??? **ShortStrings** ???????? ShortStrings ??? **Resources** ??????? <br/> |
|**Tooltip** <br/> |???????????**resid** ??????? **String** ??? **id** ?????**String** ??? **LongStrings** ???????? LongStrings ??? **Resources** ??????? <br/> |
|**SuperTip** <br/> | ?????? SuperTip?????? <br/> **??** <br/>  ???supertip ????????resid?????? String ??? id ????String ??? ShortStrings ????????  ????Resources???????? ************************<br/> **??** <br/>  ???supertip ????????resid?????? String ??? id ????String ??? LongStrings ????????  ????Resources???????? ************************<br/> |
|**Icon** <br/> | ???????? **Image** ?????????? .png ??? <br/> **Image** <br/>  ??????**resid** ??????? **Image** ??? **id** ?????**Image** ??? **Images** ???????? Images ??? **Resources** ???????**size** ???????????????????????????????????16?32 ? 80?????????????????????20?24?40?48 ? 64? <br/> |
|**Items** <br/> |???????????? **Item** ????? **Item** ??????????[????](https://dev.office.com/reference/add-ins/manifest/control)???  <br/> |
   
## <a name="step-7-add-the-resources-element"></a>?? 7??? Resources ??

**Resources** ???? **VersionOverrides** ???????????????????????????? URL???????????????? **id** ????????? **id** ???????????????????????????????????? **id** ????? 32 ????
  
    
    
??????????? **Resources** ???????????????? **Override** ??????????????????


```xml
<Resources>
  <bt:Images>
    <bt:Image id="icon1_16x16" DefaultValue="https://www.contoso.com/Images/icon_default.png">
      <bt:Override Locale="ja-jp" Value="https://www.contoso.com/Images/ja-jp16-icon_default.png" />
    </bt:Image>
    <bt:Image id="icon1_32x32" DefaultValue="https://www.contoso.com/Images/icon_default.png">
      <bt:Override Locale="ja-jp" Value="https://www.contoso.com/Images/ja-jp32-icon_default.png" />
    </bt:Image>
    <bt:Image id="icon1_80x80" DefaultValue="https://www.contoso.com/Images/icon_default.png">
      <bt:Override Locale="ja-jp" Value="https://www.contoso.com/Images/ja-jp80-icon_default.png" />
    </bt:Image>        
  </bt:Images>
  <bt:Urls>
    <bt:Url id="residDesktopFuncUrl" DefaultValue="https://www.contoso.com/Pages/Home.aspx">
      <bt:Override Locale="ja-jp" Value="https://www.contoso.com/Pages/Home.aspx" />
    </bt:Url>        
  </bt:Urls>
  <bt:ShortStrings>
    <bt:String id="residLabel" DefaultValue="GetData">
      <bt:Override Locale="ja-jp" Value="JA-JP-GetData" />
    </bt:String>      
  </bt:ShortStrings>
  <bt:LongStrings>
    <bt:String id="residToolTip" DefaultValue="Get data for your document.">
      <bt:Override Locale="ja-jp" Value="JA-JP - Get data for your document." />
    </bt:String>
  </bt:LongStrings>
</Resources>
```

|**Resource**|**??**|
|:-----|:-----|
|**Images**/ **Image** <br/> | ??????? HTTPS URL??????????????????? <br/>  16?16 <br/>  32?32 <br/>  80?80 <br/>  ????????????????? <br/>  20?20 <br/>  24?24 <br/>  40?40 <br/>  48?48 <br/>  64?64 <br/> |
|**Urls**/ **Url** <br/> |?? HTTPS URL ???URL ???? 2048 ????  <br/> |
|**ShortStrings**/ **String** <br/> |**Label** ? **Title** ???????? **String** ????? 125 ???? <br/> |
|**LongStrings**/ **String** <br/> |**Tooltip** ? **Description** ???????? **String** ????? 250 ???? <br/> |
   
> [!NOTE] 
> ??? **Image** ? **Url** ?????? URL ???????? (SSL)?

### <a name="tab-values-for-default-office-ribbon-tabs"></a>?? Office ??????? tab ?
? Excel ? Word ???????? Office UI ????????????????????????? **OfficeTab** ??? **id** ??????? Tab ???????

|**Office ????**|**Tab ?**|
|:-----|:-----|
|Excel  <br/> |**TabHome**         **TabInsert**         **TabPageLayoutExcel**         **TabFormulas**         **TabData**         **TabReview**         **TabView**         **TabDeveloper**         **TabAddIns**         **TabPrintPreview**         **TabBackgroundRemoval** <br/> |
|Word  <br/> |**TabHome**         **TabInsert**         **TabWordDesign**         **TabPageLayoutWord**         **TabReferences**         **TabMailings**         **TabReviewWord**         **TabView**         **TabDeveloper**         **TabAddIns**         **TabBlogPost**         **TabBlogInsert**         **TabPrintPreview**         **TabOutlining**         **TabConflicts**         **TabBackgroundRemoval**         **TabBroadcastPresentation** <br/> |
|PowerPoint  <br/> |**TabHome**         **TabInsert**         **TabDesign**         **TabTransitions**         **TabAnimations**         **TabSlideShow**         **TabReview**         **TabView**         **TabDeveloper**         **TabAddIns**         **TabPrintPreview**         **TabMerge**         **TabGrayscale**         **TabBlackAndWhite**         **TabBroadcastPresentation**         **TabSlideMaster**         **TabHandoutMaster**         **TabNotesMaster**         **TabBackgroundRemoval**         **TabSlideMasterHome**          <br/> |
   
## <a name="see-also"></a>????

-  [Excel?Word ? PowerPoint ?????](../design/add-in-commands.md)      
