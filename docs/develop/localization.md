---
title: Office ???????
description: ''
ms.date: 01/23/2018
ms.openlocfilehash: d7888859ca29a62541020b45b0b7a3638c41f4f2
ms.sourcegitcommit: c72c35e8389c47a795afbac1b2bcf98c8e216d82
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/23/2018
---
# <a name="localization-for-office-add-ins"></a>Office ???????

??????? Office ?????????????Office ??????? JavaScript API ???????????????????? Office ? JavaScript API ?????????????????????????????????????????????????????????????????????????????? Microsoft Ajax ????????????

## <a name="use-the-javascript-api-to-determine-locale-specific-strings"></a>?? JavaScript API ????????????

??? Office ? JavaScript API ??????????????????????????????????

- [Context.displayLanguage][displayLanguage] ??????????????????????????????????????? en-US ? fr-Fr ???????????????????
    
    ```js
    function sayHelloWithDisplayLanguage() {
        var myLanguage = Office.context.displayLanguage;
        switch (myLanguage) {
            case 'en-US':
                write('Hello!');
                break;
            case 'fr-FR':
                write('Bonjour!');
                break;
        }
    }
    
    // Function that writes to a div with id='message' on the page.
    function write(message) {
        document.getElementById('message').innerText += message; 
    }
    ```

- [Context.contentLanguage][contentLanguage] ???????????????????????????? [displayLanguage] ?????? `myLanguage` ??? [contentLanguage] ??????????????????????????????
    
    ```js
    var myLanguage = Office.context.contentLanguage;
    ```

## <a name="control-localization-from-the-manifest"></a>?????????


?? Office ????????????? [DefaultLocale] ??????????????Office ??????? Office ??????? [Description]?[DisplayName]?[IconUrl]?[HighResolutionIconUrl] ? [SourceLocation] ??????????????????????????????????????????? [Override] ??????????????????????[DefaultLocale] ??? [Override] ??? `Locale` ?????? [RFC 3066]????????????????? 1 ??????????????

**? 1.?????**


|**??**|**?????**|
|:-----|:-----|
|[??]   |????????????????? AppSource????????????????????<br/>?? Outlook ?????????????? Exchange ???? (EAC) ??????|
|[DisplayName]   |????????????????? AppSource????????????????????<br/>?? Outlook ???????????????????? Outlook ???????????? EAC ????????<br/>???????????????????????????????????????|
|[IconUrl]        |????????????????????????????????????????????????????????????????????????????<br/>?? Outlook ?????????????????? EAC ???????<br/>???????????????????????????????????|
|[HighResolutionIconUrl] **?????**???????????????? 1.1 ????|???????????????????????  [IconUrl] ????????? [HighResolutionIconUrl] ????? DPI ?????????????????? [HighResolutionIconUrl] ???? [IconUrl] ??<br/>????????????????????????????????????????????????????????????????????????????<br/>?? Outlook ?????????????????? EAC ???????<br/>???????????????????????????????????|
|[Resources] **?????**???????????????? 1.1 ????   |???????????????????????????????????????????? |
|[SourceLocation]   |?????????????????????????????????????? |


> **??**?????? Office ????????????????????? Office ???????????????? [Office 2013 ???????? OptionState ID ?](http://technet.microsoft.com/en-us/library/cc179219.aspx)?


### <a name="examples"></a>??

???Office ?????? [DefaultLocale] ??? `en-us`??? [DisplayName] ????????????? `fr-fr` ?? [Override] ????????? 


```xml
<DefaultLocale>en-us</DefaultLocale>
...
<DisplayName DefaultValue="Video player">
    <Override Locale="fr-fr" Value="Lecteur vidéo" />
</DisplayName>
```

> **??**????????????????? `de-de` ? `de-at`??????????????????? `Override` ????? Office ??????????????????????????????? `de`??

??????????????? `en-us` ??????????????????? `fr-fr`????????????????Lecteur vid?o???????????????????????????Video player??

> **??**????????????????????????????????????? `en-us`???????? `en-us` ??? 

?????? [Description] ????????????????????? `en-us` ????????? [Override] ??????? `fr-fr` ??????????

```xml
<DefaultLocale>en-us</DefaultLocale>
...
<Description DefaultValue=
   "Watch YouTube videos referenced in the emails you receive 
   without leaving your email client.">
   <Override Locale="fr-fr" Value=
   "Visualisez les vidéos YouTube référencées dans vos courriers 
   électronique directement depuis Outlook et Outlook Web App."/>
</Description>
```

???????????? `en-us` ??????????????????? `fr-fr`??????????????????????????????? `DefaultValue` ?????????

??????????????? `fr-fr` ???????????????????????????? DefaultLogo.png????????????? `fr-fr` ?????????????? FrenchLogo.png? 


```xml
<!-- Replace "domain" with a real web server name and path. -->
<IconUrl DefaultValue="https://<domain>/DefaultLogo.png"/>
<Override Locale="fr-fr" Value="https://<domain>/FrenchLogo.png"/>
```

???????????? `Resources` ??????????????? `ja-jp` ????????????????

```xml
<Resources>
      <bt:Images>
        <bt:Image id="icon1_16x16" DefaultValue="https://www.contoso.com/icon_default.png">
          <bt:Override Locale="ja-jp" Value="https://www.contoso.com/ja-jp16-icon_default.png" />
        </bt:Image>
 ...
```


?? [SourceLocation] ?????????????????????????????? HTML ?????????????????????????????????????

?? Outlook ????[SourceLocation] ??????????????????????????????????????? HTML ??????????? settings ???[DesktopSettings]?[TabletSettings] ? [PhoneSettings]????????? [Override] ???????????????????????????????? settings ?????????????????? HTML ????????????????? HTML ???


```xml
<DesktopSettings>
   <SourceLocation DefaultValue="https://contoso.com/Desktop.html">
      <Override Locale="fr-fr" Value="https://contoso.com/fr/Desktop.html" />
   </SourceLocation>
   <RequestedHeight>250</RequestedHeight>
</DesktopSettings>
<TabletSettings>
   <SourceLocation DefaultValue="https://contoso.com/Tablet.html">
      <Override Locale="fr-fr" Value="https://contoso.com/fr/Tablet.html" />
   </SourceLocation>
   <RequestedHeight>200</RequestedHeight>
</TabletSettings>
<PhoneSettings>
   <SourceLocation DefaultValue="https://contoso.com/Mobile.html">
      <Override Locale="fr-fr" Value="https://contoso.com/fr/Mobile.html" />
   </SourceLocation>
</PhoneSettings>
```

## <a name="match-datetime-format-with-client-locale"></a>???/??????????????

???? [displayLanguage] ?????????????????????????????????????????????????????????????????????????/?????????????? Office ????????????????????????????????????? [displayLanguage] ????????????/?????

???? [contentLanguage] ??????????????????????????????????/?????????`jp-JP` ???????/?????? `yyyy/MM/dd`?? `fr-FR` ???????? `dd/MM/yyyy`?


## <a name="use-ajax-for-globalization-and-localization"></a>? Ajax ?????????


???? Visual Studio ?? Office ?????.NET Framework ? Ajax ???????????????????????

?????? Office ??????? JavaScript ????? [Date](http://msdn.microsoft.com/library/caf98d32-2de2-4704-8198-692350343681.aspx) ? [Number](http://msdn.microsoft.com/library/c216d3a1-12ae-47d1-bca1-c3666d04572f.aspx) JavaScript ????? JavaScript [Date](http://msdn.microsoft.com/library/ce2202bb-7ec9-4f5a-bf48-3a04feff283e.aspx) ?????????????????????????????? [Walkthrough: Globalizing a Date by Using Client Script](http://msdn.microsoft.com/library/69b34e6d-d590-4d03-a763-b7ae54b47d74.aspx)?

??????????????????? JavaScript ??????????????????????????????????????????????????????????????????????????? JSON ???????????????????????????????????????????? 


## <a name="example-build-a-localized-office-add-in"></a>???????? Office ???

?????????????? Office ???????????? UI?

????????????????????? Microsoft Office 2013 ??????????????????????????????????????????????????????????????

???????? Visual Studio 2015 Office ??????

> **??**????? Visual Studio 2015???? [Office ??????](https://www.visualstudio.com/features/office-tools-vs)??????????? Office ??????????

### <a name="configure-office-2013-to-use-additional-languages-for-display-or-editing"></a>? Office 2013 ??????????????

????? Office 2013 ?????????????????????????????? [Office 2013 ????](http://office.microsoft.com/en-us/language-packs/)?

> **??**??? MSDN ??????????? Office 2013 ??????????????????? Office 2013 ??????? [MSDN ????](https://msdn.microsoft.com/subscriptions/manage/)????????****????Office 2013 ??????????????****????????????****??????****???????????????????????****? 

???????????? Office 2013 ????????? UI ???????????????????????????????????????? Office 2013 ????

### <a name="create-an-office-add-in-project"></a>?? Office ?????

1. ? Visual Studio ??????????**** > ??????****?
    
2. ???????****?????????****?????Visual Basic?****??Visual C#?****????Office/SharePoint?****?????Office ????****?
    
3. ???Office ????****????????????WorldReadyAddIn????????****?
    
4. ???? Office ????****???????????????****??????****??????????????????????Word ?????????****???????
    

### <a name="localize-the-text-used-in-your-add-in"></a>????????????

???????????????????????

-  **??????????** ????????????????????
    
-  **??? UI** ???????? JavaScript ??????????? UI ?????????????????????????????????
    
????????????????????????

1. ????????????****?????WorldReadyAddIn?****??WorldReadyAddInManifest?****?????WorldReadyAddIn.xml?****?
    
2. ? WorldReadyAddInManifest.xml ????DisplayName?[]??Description?[]???????????
    
    > **??**?????????????????????? [DisplayName] ? [Description] ????????????????????

    ```xml
    <DisplayName DefaultValue="World Ready add-in">
      <Override Locale="es-es" Value="Aplicación de uso internacional"/>
    </DisplayName>
    <Description DefaultValue="An add-in for testing localization">
      <Override Locale="es-es" Value="Una aplicación para la prueba de la localización"/>
    </Description>
    ```

3. ??????? Office 2013 ????????????????????????????????????????????? 
    
??????? UI ????????????

1. ? Visual Studio ????????????****?????Home.html?****?
    
2. ? Home.html ?? HTML ????? HTML?
    
    ```html
    <!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
        <title></title>
        <script src="../../Scripts/jquery-1.8.2.js" type="text/javascript"></script>
    
        <link href="../../Content/Office.css" rel="stylesheet" type="text/css" />
        <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>
    
        <!-- To enable offline debugging using a local reference to Office.js, use:                        -->
        <!-- <script src="../../Scripts/Office/MicrosoftAjax.js" type="text/javascript"></script>          -->
        <!--    <script src="../../Scripts/Office/1.0/office.js" type="text/javascript"></script>          -->
    
        <link href="../App.css" rel="stylesheet" type="text/css" />
        <script src="../App.js" type="text/javascript"></script>
    
        <link href="Home.css" rel="stylesheet" type="text/css" />
        <script src="Home.js" type="text/javascript"></script> <body>
        <!-- Page content -->
        <div id="content-header">
            <div class="padding">
                <h1 id="greeting"></h1>
            </div>
        </div>
        <div id="content-main">
            <div class="padding">
                <div>
                    <p id="about"></p>
                </div>            
            </div>
        </div>
    </head>
    </html>
    ```

3. ? Visual Studio ??????????****???? AddIn\Home\Home.html?****?
    
?????????????????????? heading (h1) ??? paragraph (p) ???

*? 1???? UI*

![???????????????](../images/office15-app-how-to-localize-fig03.png)

### <a name="add-the-resource-file-that-contains-the-localized-strings"></a>???????????????

JavaScript ??????????? UI ?????????? UI ??????????? h1 ?????????????????? p ??? 

?????????????????????????????????????????????? JavaScript ???????????????????????? JavaScript ????? (JSON) ????????????????????? JSON ?????? 

????????????????????????

1. ? Visual Studio ????????????****????????? Web ?????????****?????????????**** > ?JavaScript ???****?
    
2. ????????****????????UIStrings.js??
    
3. ???????? UIStrings.js ???

    ```js
    /* Store the locale-specific strings */
    
    var UIStrings = (function ()
    {
        "use strict";
    
        var UIStrings = {};
    
        // JSON object for English strings
        UIStrings.EN =
        {        
            "Greeting": "Welcome",
            "Introduction": "This is my localized add-in."        
        };
    
        // JSON object for Spanish strings
        UIStrings.ES =
        {        
            "Greeting": "Bienvenido",
            "Introduction": "Esta es mi aplicación localizada."
        };
    
        UIStrings.getLocaleStrings = function (locale)
        {
            var text;
            
            // Get the resource strings that match the language.
            switch (locale)
            {
                case 'en-US':
                    text = UIStrings.EN;
                    break;
                case 'es-ES':
                    text = UIStrings.ES;
                    break;
                default:
                    text = UIStrings.EN;
                    break;
            }
    
            return text;
        };
    
        return UIStrings;
    })();
    ```

UIStrings.js ???????? **UIStrings**???????? UI ???????? 

### <a name="localize-the-text-used-for-the-add-in-ui"></a>?????? UI ??

????????????????? Home.html ??????????? Home.html ????UIStrings.js ??????????????? **UIStrings** ??????????? Home.html ????????? HTML?? **UIStrings** ???????

```html
<!-- Resource file for localized strings:                                                          -->
<script src="../UIStrings.js" type="text/javascript"></script>
```

??????? **UIStrings** ??????? UI ???????

??????????????????????????????????? **Office.context.displayLanguage** ?????????????????????????????????????????? **Office.context.displayLanguage** ???????? es-ES?

?????????????????????????????????  **Office.context.contentLanguage** ??????????????????????????????????????? **Office.context.contentLanguage** ????????? es-ES?

????????????????? **UIStrings**?????????????????????

??????? Home.js ????????????????????????????????????????????? Home.html ? UI ??????????

> **??**???????????????????????????? `var myLanguage = Office.context.contentLanguage;`???????? `var myLanguage = Office.context.displayLanguage;`

```js
/// <reference path="../App.js" />
/// <reference path="../UIStrings.js" />


(function () {
    "use strict";

    // The initialize function must be run each time a new page is loaded.
    Office.initialize = function (reason)
    {
       
        $(document).ready(function () {
            app.initialize();

            // Get the language setting for editing document content.
            // To test this, uncomment the following line and then comment out the
            // line that uses Office.context.displayLanguage.
            // var myLanguage = Office.context.contentLanguage;

            // Get the language setting for UI display in the host application.
            var myLanguage = Office.context.displayLanguage;            
            var UIText;

            // Get the resource strings that match the language.
            // Use the UIStrings object from the UIStrings.js file
            // to get the JSON object with the correct localized strings.
            UIText = UIStrings.getLocaleStrings(myLanguage);            

            // Set localized text for UI elements.
            $("#greeting").text(UIText.Greeting);
            $("#about").text(UIText.Instruction);
        });
    };    
})();
```

### <a name="test-your-localized-add-in"></a>????????

????????????????????????????????????????? 

?????????????????????????

1. ? Word 2013 ??????????**** > ????**** > ????****??????????????????Word ???****????
    
    *? 2??Word 2013 ??????????????*

    ![?Word 2013 ??????](../images/office15-app-how-to-localize-fig04.png)

2. ??????????????****?????????????????????????????????????????????????????????????????****?????????????????????????????????****?
    
3. ??????****???????? Word?
    
??????????????????? Word 2013 ????????? UI ?????????????????????????


*? 3???????????? UI*

![????? UI ?????](../images/office15-app-how-to-localize-fig05.png)

## <a name="see-also"></a>????

- [Office ????????](../design/add-in-design.md)    
- [Office 2013 ???????? OptionState Id ?](http://technet.microsoft.com/en-us/library/cc179219%28Office.15%29.aspx)

[DefaultLocale]:        https://dev.office.com/reference/add-ins/manifest/defaultlocale
[??]:          https://dev.office.com/reference/add-ins/manifest/description
[DisplayName]:          https://dev.office.com/reference/add-ins/manifest/displayname
[IconUrl]:              https://dev.office.com/reference/add-ins/manifest/iconurl
[HighResolutionIconUrl]:https://dev.office.com/reference/add-ins/manifest/highresolutioniconurl
[??]:            https://dev.office.com/reference/add-ins/manifest/resources
[SourceLocation]:       https://dev.office.com/reference/add-ins/manifest/sourcelocation
[??]:             https://dev.office.com/reference/add-ins/manifest/override
[DesktopSettings]:      https://dev.office.com/reference/add-ins/manifest/desktopsettings
[TabletSettings]:       https://dev.office.com/reference/add-ins/manifest/tabletsettings
[PhoneSettings]:        https://dev.office.com/reference/add-ins/manifest/phonesettings
[displayLanguage]:  https://dev.office.com/reference/add-ins/shared/office.context.displaylanguage 
[contentLanguage]:  https://dev.office.com/reference/add-ins/shared/office.context.contentlanguage 
[RFC 3066]: https://www.rfc-editor.org/info/rfc3066
