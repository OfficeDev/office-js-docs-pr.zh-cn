---
title: 常见 JavaScript API 对象模型
description: 了解 Office JavaScript 通用 API 对象模型
ms.date: 04/30/2020
localization_priority: Normal
ms.openlocfilehash: 44c5258ad164c19df53ebe2fcbb00f420018a710
ms.sourcegitcommit: be23b68eb661015508797333915b44381dd29bdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/08/2020
ms.locfileid: "44609732"
---
# <a name="common-javascript-api-object-model"></a><span data-ttu-id="2b18d-103">常见 JavaScript API 对象模型</span><span class="sxs-lookup"><span data-stu-id="2b18d-103">Common JavaScript API object model</span></span>

[!include[information about the common API](../includes/alert-common-api-info.md)]

<span data-ttu-id="2b18d-104">Office JavaScript 加载项可提供对主机的基础功能的访问权限。</span><span class="sxs-lookup"><span data-stu-id="2b18d-104">Office JavaScript add-ins give access to the host's underlying functionality.</span></span> <span data-ttu-id="2b18d-105">大多数此类访问权限可以访问一些重要的对象。</span><span class="sxs-lookup"><span data-stu-id="2b18d-105">Most of this access goes through a few important objects.</span></span> <span data-ttu-id="2b18d-106">[Context](#context-object) 对象提供在初始化之后对运行时环境的访问权限。</span><span class="sxs-lookup"><span data-stu-id="2b18d-106">The [Context](#context-object) object gives access to the runtime environment after initialization.</span></span> <span data-ttu-id="2b18d-107">[Document](#document-object) 对象使用户能够控制 Excel、PowerPoint 或 Word 文档。</span><span class="sxs-lookup"><span data-stu-id="2b18d-107">The [Document](#document-object) object gives the user control over an Excel, PowerPoint, or Word document.</span></span> <span data-ttu-id="2b18d-108">[Mailbox](#mailbox-object) 对象使 Outlook 加载项能够访问邮件和用户配置文件。</span><span class="sxs-lookup"><span data-stu-id="2b18d-108">The [Mailbox](#mailbox-object) object gives an Outlook add-in access to messages and user profiles.</span></span> <span data-ttu-id="2b18d-109">理解这些高级对象之间的关系是 JavaScript 加载项的基础。</span><span class="sxs-lookup"><span data-stu-id="2b18d-109">Understanding the relationships between these high-level objects is the foundation of a JavaScript add-in.</span></span>

## <a name="context-object"></a><span data-ttu-id="2b18d-110">Context 对象</span><span class="sxs-lookup"><span data-stu-id="2b18d-110">Context object</span></span>

<span data-ttu-id="2b18d-111">**适用于：** 所有加载项类型</span><span class="sxs-lookup"><span data-stu-id="2b18d-111">**Applies to:** All add-in types</span></span>

<span data-ttu-id="2b18d-112">如果加载项[已初始化](initialize-add-in.md)，则它具有许多可在运行时环境中交互的不同对象。</span><span class="sxs-lookup"><span data-stu-id="2b18d-112">When an add-in is [initialized](initialize-add-in.md), it has many different objects that it can interact with in the runtime environment.</span></span> <span data-ttu-id="2b18d-113">加载项的运行时上下文通过 [Context](/javascript/api/office/office.context) 对象反应在 API 中。</span><span class="sxs-lookup"><span data-stu-id="2b18d-113">The add-in's runtime context is reflected in the API by the [Context](/javascript/api/office/office.context) object.</span></span> <span data-ttu-id="2b18d-114">**Context** 是主要对象，它提供对大部分 API 最重要对象的访问权限，例如 [Document](/javascript/api/office/office.document) 和 [Mailbox](/javascript/api/outlook/office.mailbox) 对象，二者反过来又提供对文档和邮箱内容的访问权限。</span><span class="sxs-lookup"><span data-stu-id="2b18d-114">The **Context** is the main object that provides access to the most important objects of the API, such as the [Document](/javascript/api/office/office.document) and [Mailbox](/javascript/api/outlook/office.mailbox) objects, which in turn provide access to document and mailbox content.</span></span>

<span data-ttu-id="2b18d-p103">例如，在任务窗格或内容外接程序中，可以使用 **Context** 对象的 [document](/javascript/api/office/office.context#document) 属性访问 **Document** 对象的属性和方法，以便与 Word 文档、Excel 工作表或 Project 计划的内容交互。类似地，在 Outlook 外接程序中，可以使用 **Context** 对象的 [mailbox](/javascript/api/office/office.context#mailbox) 属性访问 **Mailbox** 对象的属性和方法，以便与邮件、会议请求或约会内容交互。</span><span class="sxs-lookup"><span data-stu-id="2b18d-p103">For example, in task pane or content add-ins, you can use the [document](/javascript/api/office/office.context#document) property of the **Context** object to access the properties and methods of the **Document** object to interact with the content of Word documents, Excel worksheets, or Project schedules. Similarly, in Outlook add-ins, you can use the [mailbox](/javascript/api/office/office.context#mailbox) property of the **Context** object to access the properties and methods of the **Mailbox** object to interact with the message, meeting request, or appointment content.</span></span>

<span data-ttu-id="2b18d-117">**Context** 对象还提供对 [contentLanguage](/javascript/api/office/office.context#contentlanguage) 和 [displayLanguage](/javascript/api/office/office.context#displaylanguage) 属性的访问权限，这些属性允许你确定文档或项目中或由宿主应用程序使用的区域设置（语言）。</span><span class="sxs-lookup"><span data-stu-id="2b18d-117">The **Context** object also provides access to the [contentLanguage](/javascript/api/office/office.context#contentlanguage) and [displayLanguage](/javascript/api/office/office.context#displaylanguage) properties that let you determine the locale (language) used in the document or item, or by the host application.</span></span> <span data-ttu-id="2b18d-118">[roamingSettings](/javascript/api/office/office.context#roamingsettings) 属性使你能够访问 [RoamingSettings](/javascript/api/office/office.context#roamingsettings) 对象的成员，该对象用于存储各用户邮箱的加载项特定的设置。</span><span class="sxs-lookup"><span data-stu-id="2b18d-118">The [roamingSettings](/javascript/api/office/office.context#roamingsettings) property lets you access the members of the [RoamingSettings](/javascript/api/office/office.context#roamingsettings) object, which stores settings specific to your add-in for individual users' mailboxes.</span></span> <span data-ttu-id="2b18d-119">最后，**Context** 对象提供一个允许你的加载项启动弹出对话框的 [ui](/javascript/api/office/office.context#ui) 属性。</span><span class="sxs-lookup"><span data-stu-id="2b18d-119">Finally, the **Context** object provides a [ui](/javascript/api/office/office.context#ui) property that enables your add-in to launch pop-up dialogs.</span></span>


## <a name="document-object"></a><span data-ttu-id="2b18d-120">Document 对象</span><span class="sxs-lookup"><span data-stu-id="2b18d-120">Document object</span></span>

<span data-ttu-id="2b18d-121">**适用于：** 内容和任务窗格加载项类型</span><span class="sxs-lookup"><span data-stu-id="2b18d-121">**Applies to:** Content and task pane add-in types</span></span>

<span data-ttu-id="2b18d-122">为了与 Excel、PowerPoint 和 Word 中的文档数据交互，API 提供 [Document](/javascript/api/office/office.document) 对象。</span><span class="sxs-lookup"><span data-stu-id="2b18d-122">To interact with document data in Excel, PowerPoint, and Word, the API provides the [Document](/javascript/api/office/office.document) object.</span></span> <span data-ttu-id="2b18d-123">您可以使用 `Document` 对象成员从以下几个方面访问数据：</span><span class="sxs-lookup"><span data-stu-id="2b18d-123">You can use `Document` object members to access data from the following ways:</span></span>

- <span data-ttu-id="2b18d-124">读取和写入文本形式、连续单元格（矩阵）或表格中的活动选区。</span><span class="sxs-lookup"><span data-stu-id="2b18d-124">Read and write to active selections in the form of text, contiguous cells (matrices), or tables.</span></span>

- <span data-ttu-id="2b18d-125">表格数据（矩阵或表格）。</span><span class="sxs-lookup"><span data-stu-id="2b18d-125">Tabular data (matrices or tables).</span></span>

- <span data-ttu-id="2b18d-126">绑定（使用对象的 "add" 方法创建 `Bindings` ）。</span><span class="sxs-lookup"><span data-stu-id="2b18d-126">Bindings (created with the "add" methods of the `Bindings` object).</span></span>

- <span data-ttu-id="2b18d-127">自定义 XML 部件（仅适用于 Word）。</span><span class="sxs-lookup"><span data-stu-id="2b18d-127">Custom XML parts (only for Word).</span></span>

- <span data-ttu-id="2b18d-128">文档上按加载项保留的设置或加载项状态。</span><span class="sxs-lookup"><span data-stu-id="2b18d-128">Settings or add-in state persisted per add-in on the document.</span></span>

<span data-ttu-id="2b18d-129">您还可以使用 `Document` 对象与项目文档中的数据进行交互。</span><span class="sxs-lookup"><span data-stu-id="2b18d-129">You can also use the `Document` object to interact with data in Project documents.</span></span> <span data-ttu-id="2b18d-130">特定于 Project 的 API 功能记录在成员 [ProjectDocument](/javascript/api/office/office.document) 抽象类中。</span><span class="sxs-lookup"><span data-stu-id="2b18d-130">The Project-specific functionality of the API is documented in the members [ProjectDocument](/javascript/api/office/office.document) abstract class.</span></span> <span data-ttu-id="2b18d-131">有关为 Project 创建任务窗格加载项的详细信息，请参阅[适用于 Project 的任务窗格加载项](../project/project-add-ins.md)。</span><span class="sxs-lookup"><span data-stu-id="2b18d-131">For more information about creating task pane add-ins for Project, see [Task pane add-ins for Project](../project/project-add-ins.md).</span></span>

<span data-ttu-id="2b18d-132">所有这些形式的数据访问都是从抽象对象的实例开始的 `Document` 。</span><span class="sxs-lookup"><span data-stu-id="2b18d-132">All these forms of data access start from an instance of the abstract `Document` object.</span></span>

<span data-ttu-id="2b18d-133">`Document`使用对象的[document](/javascript/api/office/office.context#document)属性初始化任务窗格或内容加载项时，可以访问对象的实例 `Context` 。</span><span class="sxs-lookup"><span data-stu-id="2b18d-133">You can access an instance of the `Document` object when the task pane or content add-in is initialized by using the [document](/javascript/api/office/office.context#document) property of the `Context` object.</span></span> <span data-ttu-id="2b18d-134">该 `Document` 对象定义在 word 和 Excel 文档中共享的常见数据访问函数，还提供对 word 文档的对象的访问权限 `CustomXmlParts` 。</span><span class="sxs-lookup"><span data-stu-id="2b18d-134">The `Document` object defines common data access functions shared across Word and Excel documents, and also provides access to the `CustomXmlParts` object for Word documents.</span></span>

<span data-ttu-id="2b18d-135">`Document`对象支持四种方式以供开发人员访问文档内容：</span><span class="sxs-lookup"><span data-stu-id="2b18d-135">The `Document` object supports four ways for developers to access document contents:</span></span>


- <span data-ttu-id="2b18d-136">基于选区的访问</span><span class="sxs-lookup"><span data-stu-id="2b18d-136">Selection-based access</span></span>

- <span data-ttu-id="2b18d-137">基于绑定的访问</span><span class="sxs-lookup"><span data-stu-id="2b18d-137">Binding-based access</span></span>

- <span data-ttu-id="2b18d-138">基于自定义 XML 部件的访问（仅适用于 Word）</span><span class="sxs-lookup"><span data-stu-id="2b18d-138">Custom XML part-based access (Word only)</span></span>

- <span data-ttu-id="2b18d-139">基于整个文档的访问（仅适用于 PowerPoint 和 Word）</span><span class="sxs-lookup"><span data-stu-id="2b18d-139">Entire document-based access (PowerPoint and Word only)</span></span>

<span data-ttu-id="2b18d-140">为了帮助您理解基于选区和绑定的数据访问方法的工作方式，我们将首先解释数据访问 API 如何跨不同的 Office 应用程序提供一致的数据访问。</span><span class="sxs-lookup"><span data-stu-id="2b18d-140">To help you understand how selection- and binding-based data access methods work, we will first explain how the data-access APIs provide consistent data access across different Office applications.</span></span>


### <a name="consistent-data-access-across-office-applications"></a><span data-ttu-id="2b18d-141">跨 Office 应用程序的一致数据访问</span><span class="sxs-lookup"><span data-stu-id="2b18d-141">Consistent data access across Office applications</span></span>

 <span data-ttu-id="2b18d-142">**适用于：** 内容和任务窗格加载项类型</span><span class="sxs-lookup"><span data-stu-id="2b18d-142">**Applies to:** Content and task pane add-in types</span></span>

<span data-ttu-id="2b18d-143">为了创建跨不同 Office 文档无缝工作的扩展功能，Office JavaScript API 通过常见的数据类型将每个 Office 应用程序的 particularities 抽象化，并能够将不同的文档内容强制转换为三种常见的数据类型。</span><span class="sxs-lookup"><span data-stu-id="2b18d-143">To create extensions that seamlessly work across different Office documents, the Office JavaScript API abstracts away the particularities of each Office application through common data types and the ability to coerce different document contents into three common data types.</span></span>


#### <a name="common-data-types"></a><span data-ttu-id="2b18d-144">通用数据类型</span><span class="sxs-lookup"><span data-stu-id="2b18d-144">Common data types</span></span>

<span data-ttu-id="2b18d-p108">在基于选区和基于绑定的数据访问中，文档内容通过跨所有受支持的 Office 应用程序通用的数据类型来公开。在 Office 2013 中，支持三种主要的数据类型：</span><span class="sxs-lookup"><span data-stu-id="2b18d-p108">In both selection-based and binding-based data access, document contents are exposed through data types that are common across all the supported Office applications. In Office 2013, three main data types are supported:</span></span>



|<span data-ttu-id="2b18d-147">**数据类型**</span><span class="sxs-lookup"><span data-stu-id="2b18d-147">**Data type**</span></span>|<span data-ttu-id="2b18d-148">**说明**</span><span class="sxs-lookup"><span data-stu-id="2b18d-148">**Description**</span></span>|<span data-ttu-id="2b18d-149">**主机应用程序支持**</span><span class="sxs-lookup"><span data-stu-id="2b18d-149">**Host application support**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="2b18d-150">文本</span><span class="sxs-lookup"><span data-stu-id="2b18d-150">Text</span></span>|<span data-ttu-id="2b18d-151">提供选定范围或绑定中数据的字符串表示形式。</span><span class="sxs-lookup"><span data-stu-id="2b18d-151">Provides a string representation of the data in the selection or binding.</span></span>|<span data-ttu-id="2b18d-p109">在 Excel 2013、Project 2013 和 PowerPoint 2013 中，仅支持纯文本。在 Word 2013 中，支持三种文本格式：纯文本、HTML 和 Office Open XML (OOXML)。如果选中的是 Excel 单元格中的文本，基于选定范围的方法会对单元格的全部内容执行读取和写入操作，即使仅选中了单元格中的部分文本，也不例外。如果选中的是 Word 和 PowerPoint 中的文本，基于选定范围的方法只会对选中的一系列字符执行读取和写入操作。Project 2013 和 PowerPoint 2013 仅支持基于选定范围的数据访问。</span><span class="sxs-lookup"><span data-stu-id="2b18d-p109">In Excel 2013, Project 2013, and PowerPoint 2013, only plain text is supported. In Word 2013, three text formats are supported: plain text, HTML, and Office Open XML (OOXML). When text is selected in a cell in Excel, selection-based methods read and write to the entire contents of the cell, even if only a portion of the text is selected in the cell. When text is selected in Word and PowerPoint, selection-based methods read and write only to the run of characters that are selected. Project 2013 and PowerPoint 2013 support only selection-based data access.</span></span>|
|<span data-ttu-id="2b18d-157">矩阵</span><span class="sxs-lookup"><span data-stu-id="2b18d-157">Matrix</span></span>|<span data-ttu-id="2b18d-p110">将选定范围或绑定中的数据作为二维 **Array** 提供，这在 JavaScript 中实现为一组数组。例如，两行两列 **string** 值为 ` [['a', 'b'], ['c', 'd']]`，而三行一列则为 `[['a'], ['b'], ['c']]`。</span><span class="sxs-lookup"><span data-stu-id="2b18d-p110">Provides the data in the selection or binding as a two dimensional **Array**, which in JavaScript is implemented as an array of arrays. For example, two rows of **string** values in two columns would be ` [['a', 'b'], ['c', 'd']]`, and a single column of three rows would be `[['a'], ['b'], ['c']]`.</span></span>|<span data-ttu-id="2b18d-160">仅 Excel 2013 和 Word 2013 支持矩阵数据访问。</span><span class="sxs-lookup"><span data-stu-id="2b18d-160">Matrix data access is supported only in Excel 2013 and Word 2013.</span></span>|
|<span data-ttu-id="2b18d-161">Table</span><span class="sxs-lookup"><span data-stu-id="2b18d-161">Table</span></span>|<span data-ttu-id="2b18d-162">将选区或绑定中的数据作为 [TableData](/javascript/api/office/office.tabledata) 对象提供。</span><span class="sxs-lookup"><span data-stu-id="2b18d-162">Provides the data in the selection or binding as a [TableData](/javascript/api/office/office.tabledata) object.</span></span> <span data-ttu-id="2b18d-163">`TableData`对象通过 `headers` 和属性公开数据 `rows` 。</span><span class="sxs-lookup"><span data-stu-id="2b18d-163">The `TableData` object exposes the data through the `headers` and `rows` properties.</span></span>|<span data-ttu-id="2b18d-164">表格数据访问仅在 Excel 2013 和 Word 2013 中受支持。</span><span class="sxs-lookup"><span data-stu-id="2b18d-164">Table data access is supported only in Excel 2013 and Word 2013.</span></span>|

#### <a name="data-type-coercion"></a><span data-ttu-id="2b18d-165">数据类型强制转换</span><span class="sxs-lookup"><span data-stu-id="2b18d-165">Data type coercion</span></span>

<span data-ttu-id="2b18d-166">和 Binding 对象上的数据访问方法 `Document` 支持使用这些方法的_coercionType_参数以及相应的[coercionType](/javascript/api/office/office.coerciontype)枚举值指定所需的数据类型。 [Binding](/javascript/api/office/office.binding)</span><span class="sxs-lookup"><span data-stu-id="2b18d-166">The data access methods on the `Document` and [Binding](/javascript/api/office/office.binding) objects support specifying the desired data type using the _coercionType_ parameter of these methods, and corresponding [CoercionType](/javascript/api/office/office.coerciontype) enumeration values.</span></span> <span data-ttu-id="2b18d-167">不管绑定的实际形状如何，不同的 Office 应用程序都通过尝试将数据强制转换为请求的数据类型来支持通用的数据类型。</span><span class="sxs-lookup"><span data-stu-id="2b18d-167">Regardless of the actual shape of the binding, the different Office applications support the common data types by trying to coerce the data into the requested data type.</span></span> <span data-ttu-id="2b18d-168">例如，如果选中了某个 Word 表格或段落，开发人员可以指定以纯文本、HTML、Office Open XML 或表格的形式读取它，而 API 实现则负责处理必要的转换和数据转换。</span><span class="sxs-lookup"><span data-stu-id="2b18d-168">For example, if a Word table or paragraph is selected, the developer can specify to read it as plain text, HTML, Office Open XML, or a table, and the API implementation handles the necessary transformations and data conversions.</span></span>


> [!TIP]
> <span data-ttu-id="2b18d-169">**何时应使用矩阵与表格 coercionType 数据访问？**</span><span class="sxs-lookup"><span data-stu-id="2b18d-169">**When should you use the matrix versus table coercionType for data access?**</span></span> <span data-ttu-id="2b18d-170">如果需要在添加行和列时动态增大表格数据，并且必须使用表格标题，则应使用 table 数据类型（通过将_coercionType_参数指定为或的 `Document` `Binding` 对象数据访问方法 `"table"` `Office.CoercionType.Table` ）。</span><span class="sxs-lookup"><span data-stu-id="2b18d-170">If you need your tabular data to grow dynamically when rows and columns are added, and you must work with table headers, you should use the table data type (by specifying the _coercionType_ parameter of a `Document` or `Binding` object data access method as `"table"` or `Office.CoercionType.Table`).</span></span> <span data-ttu-id="2b18d-171">表格数据和矩阵数据中都支持在数据结构内添加行和列，但仅支持对表格数据追加行和列。</span><span class="sxs-lookup"><span data-stu-id="2b18d-171">Adding rows and columns within the data structure is supported in both table and matrix data, but appending rows and columns is supported only for table data.</span></span> <span data-ttu-id="2b18d-172">如果您不打算添加行和列，并且您的数据不需要标头功能，则应使用矩阵数据类型（通过将 data access 方法的_coercionType_参数指定为 `"matrix"` 或 `Office.CoercionType.Matrix` ），这提供了与数据交互的更简单的模型。</span><span class="sxs-lookup"><span data-stu-id="2b18d-172">If you aren't planning on adding rows and columns, and your data doesn't require header functionality, then you should use the matrix data type (by specifying the  _coercionType_ parameter of the data access method as `"matrix"` or `Office.CoercionType.Matrix`), which provides a simpler model of interacting with the data.</span></span>

<span data-ttu-id="2b18d-173">如果无法将数据强制转换为指定的类型，那么回调中的 [AsyncResult.status](/javascript/api/office/office.asyncresult#status) 属性返回 `"failed"`，并且你可以使用 [AsyncResult.error](/javascript/api/office/office.asyncresult#error) 属性访问 [Error](/javascript/api/office/office.error) 对象，其中包括方法调用失败原因的信息。</span><span class="sxs-lookup"><span data-stu-id="2b18d-173">If the data can't be coerced to the specified type, the [AsyncResult.status](/javascript/api/office/office.asyncresult#status) property in the callback returns `"failed"`, and you can use the [AsyncResult.error](/javascript/api/office/office.asyncresult#error) property to access an [Error](/javascript/api/office/office.error) object with information about why the method call failed.</span></span>


## <a name="working-with-selections-using-the-document-object"></a><span data-ttu-id="2b18d-174">使用 Document 对象处理选择内容</span><span class="sxs-lookup"><span data-stu-id="2b18d-174">Working with selections using the Document object</span></span>


<span data-ttu-id="2b18d-175">该 `Document` 对象公开的方法允许您以 "获取和设置" 方式读取和写入用户当前所选内容。</span><span class="sxs-lookup"><span data-stu-id="2b18d-175">The `Document` object exposes methods that let you to read and write to the user's current selection in a "get and set" fashion.</span></span> <span data-ttu-id="2b18d-176">若要执行此操作， `Document` 对象将提供 `getSelectedDataAsync` 和 `setSelectedDataAsync` 方法。</span><span class="sxs-lookup"><span data-stu-id="2b18d-176">To do that, the `Document` object provides the `getSelectedDataAsync` and `setSelectedDataAsync` methods.</span></span>

<span data-ttu-id="2b18d-177">有关演示如何使用选区执行任务的代码示例，请参阅[在文档或电子表格的活动选区中读取和写入数据](read-and-write-data-to-the-active-selection-in-a-document-or-spreadsheet.md)。</span><span class="sxs-lookup"><span data-stu-id="2b18d-177">For code examples that demonstrate how to perform tasks with selections, see [Read and write data to the active selection in a document or spreadsheet](read-and-write-data-to-the-active-selection-in-a-document-or-spreadsheet.md).</span></span>


## <a name="working-with-bindings-using-the-bindings-and-binding-objects"></a><span data-ttu-id="2b18d-178">使用 Bindings 和 Binding 对象处理绑定</span><span class="sxs-lookup"><span data-stu-id="2b18d-178">Working with bindings using the Bindings and Binding objects</span></span>


<span data-ttu-id="2b18d-p115">基于绑定的数据访问使内容和任务窗格加载项能够通过与绑定相关联的标识符一致地访问文档或电子表格的特定区域。加载项首先需要通过调用将文档的某一部分与唯一标识符相关联的以下某个方法来建立绑定：[addFromPromptAsync](/javascript/api/office/office.bindings#addfrompromptasync-bindingtype--options--callback-)、[addFromSelectionAsync](/javascript/api/office/office.bindings#addfromselectionasync-bindingtype--options--callback-) 或 [addFromNamedItemAsync](/javascript/api/office/office.bindings#addfromnameditemasync-itemname--bindingtype--options--callback-)。建立绑定后，加载项可以使用提供的标识符访问文档或电子表格的关联区域中包含的数据。创建绑定可为加载项提供以下值：</span><span class="sxs-lookup"><span data-stu-id="2b18d-p115">Binding-based data access enables content and task pane add-ins to consistently access a particular region of a document or spreadsheet through an identifier associated with a binding. The add-in first needs to establish the binding by calling one of the methods that associates a portion of the document with a unique identifier: [addFromPromptAsync](/javascript/api/office/office.bindings#addfrompromptasync-bindingtype--options--callback-), [addFromSelectionAsync](/javascript/api/office/office.bindings#addfromselectionasync-bindingtype--options--callback-), or [addFromNamedItemAsync](/javascript/api/office/office.bindings#addfromnameditemasync-itemname--bindingtype--options--callback-). After the binding is established, the add-in can use the provided identifier to access the data contained in the associated region of the document or spreadsheet. Creating bindings provides the following value to your add-in:</span></span>


- <span data-ttu-id="2b18d-183">允许访问跨支持的 Office 应用程序的通用数据结构，例如：表、区域或文本（一系列连续字符）。</span><span class="sxs-lookup"><span data-stu-id="2b18d-183">Permits access to common data structures across supported Office applications, such as: tables, ranges, or text (a contiguous run of characters).</span></span>

- <span data-ttu-id="2b18d-184">允许读/写操作，而不需要用户做出选择。</span><span class="sxs-lookup"><span data-stu-id="2b18d-184">Enables read/write operations without requiring the user to make a selection.</span></span>

- <span data-ttu-id="2b18d-p116">在加载项和文档中的数据之间建立关系。绑定会保留在文档中，以后可以进行访问。</span><span class="sxs-lookup"><span data-stu-id="2b18d-p116">Establishes a relationship between the add-in and the data in the document. Bindings are persisted in the document, and can be accessed at a later time.</span></span>

<span data-ttu-id="2b18d-p117">建立绑定还允许您订阅仅限文档或电子表格的特定区域的数据和选择更改事件。这意味着，加载项只会收到绑定区域内发生的更改的通知，而不是收到整个文档或电子表格内的常规更改的通知。</span><span class="sxs-lookup"><span data-stu-id="2b18d-p117">Establishing a binding also allows you to subscribe to data and selection change events that are scoped to that particular region of the document or spreadsheet. This means that the add-in is only notified of changes that happen within the bound region as opposed to general changes across the whole document or spreadsheet.</span></span>

<span data-ttu-id="2b18d-189">[Bindings](/javascript/api/office/office.bindings) 对象公开 [getAllAsync](/javascript/api/office/office.bindings#getallasync-options--callback-) 方法，通过该方法可以访问在文档或电子表格中建立的所有绑定的集合。</span><span class="sxs-lookup"><span data-stu-id="2b18d-189">The [Bindings](/javascript/api/office/office.bindings) object exposes a [getAllAsync](/javascript/api/office/office.bindings#getallasync-options--callback-) method that gives access to the set of all bindings established on the document or spreadsheet.</span></span> <span data-ttu-id="2b18d-190">可使用 [Bindings.getBindingByIdAsync](/javascript/api/office/office.bindings#getbyidasync-id--options--callback-) 或 [Office.select](/javascript/api/office) 方法按 ID 访问单个绑定。</span><span class="sxs-lookup"><span data-stu-id="2b18d-190">An individual binding can be accessed by its ID using either the [Bindings.getBindingByIdAsync](/javascript/api/office/office.bindings#getbyidasync-id--options--callback-) or [Office.select](/javascript/api/office) methods.</span></span> <span data-ttu-id="2b18d-191">您可以使用以下对象的方法之一来建立新绑定，并删除现有绑定 `Bindings` ： [addFromSelectionAsync](/javascript/api/office/office.bindings#addfromselectionasync-bindingtype--options--callback-)、 [AddFromPromptAsync](/javascript/api/office/office.bindings#addfrompromptasync-bindingtype--options--callback-)、 [addFromNamedItemAsync](/javascript/api/office/office.bindings#addfromnameditemasync-itemname--bindingtype--options--callback-)或[releaseByIdAsync](/javascript/api/office/office.bindings#releasebyidasync-id--options--callback-)。</span><span class="sxs-lookup"><span data-stu-id="2b18d-191">You can establish new bindings as well as remove existing ones by using one of the following methods of the `Bindings` object: [addFromSelectionAsync](/javascript/api/office/office.bindings#addfromselectionasync-bindingtype--options--callback-), [addFromPromptAsync](/javascript/api/office/office.bindings#addfrompromptasync-bindingtype--options--callback-), [addFromNamedItemAsync](/javascript/api/office/office.bindings#addfromnameditemasync-itemname--bindingtype--options--callback-), or [releaseByIdAsync](/javascript/api/office/office.bindings#releasebyidasync-id--options--callback-).</span></span>

<span data-ttu-id="2b18d-192">在使用或方法创建绑定时，可以使用_bindingType_参数指定三种不同类型的绑定 `addFromSelectionAsync` `addFromPromptAsync` `addFromNamedItemAsync` ：</span><span class="sxs-lookup"><span data-stu-id="2b18d-192">There are three different types of bindings that you specify with the  _bindingType_ parameter when you create a binding with the `addFromSelectionAsync`, `addFromPromptAsync` or `addFromNamedItemAsync` methods:</span></span>



|<span data-ttu-id="2b18d-193">**绑定类型**</span><span class="sxs-lookup"><span data-stu-id="2b18d-193">**Binding type**</span></span>|<span data-ttu-id="2b18d-194">**说明**</span><span class="sxs-lookup"><span data-stu-id="2b18d-194">**Description**</span></span>|<span data-ttu-id="2b18d-195">**主机应用程序支持**</span><span class="sxs-lookup"><span data-stu-id="2b18d-195">**Host application support**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="2b18d-196">文本绑定</span><span class="sxs-lookup"><span data-stu-id="2b18d-196">Text binding</span></span>|<span data-ttu-id="2b18d-197">绑定到可以文本形式表示的文档区域。</span><span class="sxs-lookup"><span data-stu-id="2b18d-197">Binds to a region of the document that can be represented as text.</span></span>|<span data-ttu-id="2b18d-p119">在 Word 中，大多数连续选区都是有效的，而在 Excel 中，只有单个单元格选区才能作为文本绑定的目标。在 Excel 中，只支持纯文本。在 Word 中，支持以下三种格式：纯文本、HTML 和 Open XML for Office。</span><span class="sxs-lookup"><span data-stu-id="2b18d-p119">In Word, most contiguous selections are valid, while in Excel only single cell selections can be the target of a text binding. In Excel, only plain text is supported. In Word, three formats are supported: plain text, HTML, and Open XML for Office.</span></span>|
|<span data-ttu-id="2b18d-201">矩阵绑定</span><span class="sxs-lookup"><span data-stu-id="2b18d-201">Matrix binding</span></span>|<span data-ttu-id="2b18d-p120">绑定到包含表格数据（不带标题）的文档的固定区域。矩阵绑定中的数据以二维 **Array**（在 JavaScript 中实现为一组数组）的形式进行写入或读取。例如，两行两列 **string** 值可以写入或读取为 ` [['a', 'b'], ['c', 'd']]`，而三行单列则可以写入或读取为 `[['a'], ['b'], ['c']]`。</span><span class="sxs-lookup"><span data-stu-id="2b18d-p120">Binds to a fixed region of a document that contains tabular data without headers. Data in a matrix binding is written or read as a two dimensional **Array**, which in JavaScript is implemented as an array of arrays. For example, two rows of **string** values in two columns can be written or read as ` [['a', 'b'], ['c', 'd']]`, and a single column of three rows can be written or read as `[['a'], ['b'], ['c']]`.</span></span>|<span data-ttu-id="2b18d-p121">在 Excel 中，任何连续选择的单元格都可用于建立矩阵绑定。在 Word 中，只有表格支持矩阵绑定。</span><span class="sxs-lookup"><span data-stu-id="2b18d-p121">In Excel, any contiguous selection of cells can be used to establish a matrix binding. In Word, only tables support matrix binding.</span></span>|
|<span data-ttu-id="2b18d-207">表格绑定</span><span class="sxs-lookup"><span data-stu-id="2b18d-207">Table binding</span></span>|<span data-ttu-id="2b18d-208">绑定到包含带标题的表格的文档区域。</span><span class="sxs-lookup"><span data-stu-id="2b18d-208">Binds to a region of a document that contains a table with headers.</span></span> <span data-ttu-id="2b18d-209">表格绑定中的数据作为 [TableData](/javascript/api/office/office.tabledata) 对象写入或读取。</span><span class="sxs-lookup"><span data-stu-id="2b18d-209">Data in a table binding is written or read as a [TableData](/javascript/api/office/office.tabledata) object.</span></span> <span data-ttu-id="2b18d-210">`TableData`对象通过**标头**和**行**属性公开数据。</span><span class="sxs-lookup"><span data-stu-id="2b18d-210">The `TableData` object exposes the data through the **headers** and **rows** properties.</span></span>|<span data-ttu-id="2b18d-p123">任何 Excel 或 Word 表格均可作为表格绑定的基础。建立表格绑定后，用户添加到表格中的每个新行或新列都自动包含在绑定中。</span><span class="sxs-lookup"><span data-stu-id="2b18d-p123">Any Excel or Word table can be the basis for a table binding. After you establish a table binding, each new row or column a user adds to the table is automatically included in the binding.</span></span> |

<br/>

<span data-ttu-id="2b18d-213">使用该对象的三个 "添加" 方法之一创建绑定之后 `Bindings` ，可以使用相应对象的方法来处理绑定的数据和属性： [MatrixBinding](/javascript/api/office/office.matrixbinding)、 [TableBinding](/javascript/api/office/office.tablebinding)或[textbinding 添加](/javascript/api/office/office.textbinding)。</span><span class="sxs-lookup"><span data-stu-id="2b18d-213">After a binding is created by using one of the three "add" methods of the `Bindings` object, you can work with the binding's data and properties by using the methods of the corresponding object: [MatrixBinding](/javascript/api/office/office.matrixbinding), [TableBinding](/javascript/api/office/office.tablebinding), or [TextBinding](/javascript/api/office/office.textbinding).</span></span> <span data-ttu-id="2b18d-214">所有这三个对象都继承对象的[binding.getdataasync](/javascript/api/office/office.binding#getdataasync-options--callback-)和[binding.setdataasync](/javascript/api/office/office.binding#setdataasync-data--options--callback-)方法 `Binding` ，您可以使用这些方法与绑定的数据进行交互。</span><span class="sxs-lookup"><span data-stu-id="2b18d-214">All three of these objects inherit the [getDataAsync](/javascript/api/office/office.binding#getdataasync-options--callback-) and [setDataAsync](/javascript/api/office/office.binding#setdataasync-data--options--callback-) methods of the `Binding` object that enable to you interact with the bound data.</span></span>

<span data-ttu-id="2b18d-215">有关演示如何使用绑定执行任务的代码示例，请参阅[绑定到文档或电子表格中的区域](bind-to-regions-in-a-document-or-spreadsheet.md)。</span><span class="sxs-lookup"><span data-stu-id="2b18d-215">For code examples that demonstrate how to perform tasks with bindings, see [Bind to regions in a document or spreadsheet](bind-to-regions-in-a-document-or-spreadsheet.md).</span></span>


## <a name="working-with-custom-xml-parts-using-the-customxmlparts-and-customxmlpart-objects"></a><span data-ttu-id="2b18d-216">使用 CustomXmlParts 和 CustomXmlPart 对象处理自定义 XML 部件</span><span class="sxs-lookup"><span data-stu-id="2b18d-216">Working with custom XML parts using the CustomXmlParts and CustomXmlPart objects</span></span>


 <span data-ttu-id="2b18d-217">**适用于：** Word 的任务窗格加载项</span><span class="sxs-lookup"><span data-stu-id="2b18d-217">**Applies to:** Task pane add-ins for Word</span></span>

<span data-ttu-id="2b18d-218">API 的 [CustomXmlParts](/javascript/api/office/office.customxmlparts) 和 [CustomXmlPart](/javascript/api/office/office.customxmlpart) 对象提供访问 Word 文档中自定义 XML 部件的权限，从而启用文档内容的 XML 驱动操作。</span><span class="sxs-lookup"><span data-stu-id="2b18d-218">The [CustomXmlParts](/javascript/api/office/office.customxmlparts) and [CustomXmlPart](/javascript/api/office/office.customxmlpart) objects of the API provide access to custom XML parts in Word documents, which enable XML-driven manipulation of the contents of the document.</span></span> <span data-ttu-id="2b18d-219">有关使用和对象的演示 `CustomXmlParts` `CustomXmlPart` ，请参阅[Word 加载项-与工作的自定义 XML 部分](https://github.com/OfficeDev/Word-Add-in-Work-with-custom-XML-parts)的代码示例。</span><span class="sxs-lookup"><span data-stu-id="2b18d-219">For demonstrations of working with the `CustomXmlParts` and `CustomXmlPart` objects, see the [Word-add-in-Work-with-custom-XML-parts](https://github.com/OfficeDev/Word-Add-in-Work-with-custom-XML-parts) code sample.</span></span>


## <a name="working-with-the-entire-document-using-the-getfileasync-method"></a><span data-ttu-id="2b18d-220">使用 getFileAsync 方法处理整个文档</span><span class="sxs-lookup"><span data-stu-id="2b18d-220">Working with the entire document using the getFileAsync method</span></span>


 <span data-ttu-id="2b18d-221">**适用于：** Word 和 PowerPoint 任务窗格加载项</span><span class="sxs-lookup"><span data-stu-id="2b18d-221">**Applies to:** Task pane add-ins for Word and PowerPoint</span></span>

<span data-ttu-id="2b18d-p126">[Document.getFileAsync](/javascript/api/office/office.document#getfileasync-filetype--options--callback-) 方法以及 [File](/javascript/api/office/office.file) 和 [Slice](/javascript/api/office/office.slice) 对象的成员可用于一次性获取整个 Word 和 PowerPoint 文档文件，所有切片（区块）的总大小上限为 4MB。有关详细信息，请参阅[通过 PowerPoint 或 Word 加载项获取整个文档](../word/get-the-whole-document-from-an-add-in-for-word.md)。</span><span class="sxs-lookup"><span data-stu-id="2b18d-p126">The [Document.getFileAsync](/javascript/api/office/office.document#getfileasync-filetype--options--callback-) method and members of the [File](/javascript/api/office/office.file) and [Slice](/javascript/api/office/office.slice) objects to provide functionality for getting entire Word and PowerPoint document files in slices (chunks) of up to 4 MB at a time. For more information, see [Get the whole document from an add-in for PowerPoint or Word](../word/get-the-whole-document-from-an-add-in-for-word.md).</span></span>


## <a name="mailbox-object"></a><span data-ttu-id="2b18d-224">Mailbox 对象</span><span class="sxs-lookup"><span data-stu-id="2b18d-224">Mailbox object</span></span>

<span data-ttu-id="2b18d-225">**适用于：** Outlook 外接程序</span><span class="sxs-lookup"><span data-stu-id="2b18d-225">**Applies to:** Outlook add-ins</span></span>

<span data-ttu-id="2b18d-p127">Outlook 外接程序主要使用通过 [Mailbox](/javascript/api/outlook/office.mailbox) 对象公开的 API 的子集。要访问专用于 Outlook 外接程序的对象和成员（例如 [Item](/javascript/api/outlook/office.item) 对象），可以使用 [Context](/javascript/api/office/office.context#mailbox) 对象的 **mailbox** 属性访问 **Mailbox** 对象，如下面的代码行所示。</span><span class="sxs-lookup"><span data-stu-id="2b18d-p127">Outlook add-ins primarily use a subset of the API exposed through the [Mailbox](/javascript/api/outlook/office.mailbox) object. To access the objects and members specifically for use in Outlook add-ins, such as the [Item](/javascript/api/outlook/office.item) object, you use the [mailbox](/javascript/api/office/office.context#mailbox) property of the **Context** object to access the **Mailbox** object, as shown in the following line of code.</span></span>

```js
// Access the Item object.
var item = Office.context.mailbox.item;

```

<span data-ttu-id="2b18d-228">另外，Outlook 外接程序可以使用以下对象：</span><span class="sxs-lookup"><span data-stu-id="2b18d-228">Additionally, Outlook add-ins can use the following objects:</span></span>

- <span data-ttu-id="2b18d-229">`Office`对象：用于初始化。</span><span class="sxs-lookup"><span data-stu-id="2b18d-229">`Office` object: for initialization.</span></span>

- <span data-ttu-id="2b18d-230">`Context`对象：用于访问内容和显示语言属性。</span><span class="sxs-lookup"><span data-stu-id="2b18d-230">`Context` object: for access to content and display language properties.</span></span>

- <span data-ttu-id="2b18d-231">`RoamingSettings`对象：用于将特定于 Outlook 外接程序的自定义设置保存到安装外接程序的用户邮箱中。</span><span class="sxs-lookup"><span data-stu-id="2b18d-231">`RoamingSettings` object: for saving Outlook add-in-specific custom settings to the user's mailbox where the add-in is installed.</span></span>

<span data-ttu-id="2b18d-232">有关在 Outlook 加载项中使用 JavaScript 的信息，请参阅 [Outlook 加载项](../outlook/outlook-add-ins-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="2b18d-232">For information about using JavaScript in Outlook add-ins, see [Outlook add-ins](../outlook/outlook-add-ins-overview.md).</span></span>

