---
title: '? Office 2013 ??????????? Office JavaScript API ??'
description: ''
ms.date: 12/04/2017
ms.openlocfilehash: 2aab577e3536ed11c8f2e9810f6f200bdf5d1768
ms.sourcegitcommit: c72c35e8389c47a795afbac1b2bcf98c8e216d82
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/23/2018
---
# <a name="office-javascript-api-support-for-content-and-task-pane-add-ins-in-office-2013"></a>? Office 2013 ??????????? Office JavaScript API ??


????? [Office JavaScript API](https://dev.office.com/reference/add-ins/javascript-api-for-office) ?? Office 2013 ???????????????????????????????????????????????


1. **??? Office ????????????** ?????? [Office](https://dev.office.com/reference/add-ins/shared/office)?[Context](https://dev.office.com/reference/add-ins/shared/office.context) ? [AsyncResult](https://dev.office.com/reference/add-ins/shared/asyncresult)?**Office** ??? Office JavaScript API ?????**Context** ???????????????**Office** ? **Context** ??????? Office ??????????**AsyncResult** ????????????????? **getSelectedDataAsync** ???????????????????????????
    
2.  **Document ???** ?????????????????? API ?? [Document](https://dev.office.com/reference/add-ins/shared/document) ?????????????? ??????????????? [Office.context.document](https://dev.office.com/reference/add-ins/shared/office.context.document) ???? **Document** ????????? API ????????????????? [Bindings](https://dev.office.com/reference/add-ins/shared/bindings.bindings) ? [CustomXmlParts](https://dev.office.com/reference/add-ins/shared/customxmlparts.customxmlparts) ????? [getSelectedDataAsync](https://dev.office.com/reference/add-ins/shared/document.getselecteddataasync)?[setSelectedDataAsync](https://dev.office.com/reference/add-ins/shared/document.setselecteddataasync) ? [getFileAsync](https://dev.office.com/reference/add-ins/shared/document.getfileasync) ??? **Document** ???????????????????????? [mode](https://dev.office.com/reference/add-ins/shared/document.mode) ????????? URL ? [url](https://dev.office.com/reference/add-ins/shared/document.url) ?????? [Settings](https://dev.office.com/reference/add-ins/shared/settings) ?????? **Document<** ??????? [SelectionChanged](https://dev.office.com/reference/add-ins/shared/document.selectionchanged.event) ????????????????????????????????
    
   ???????????????? DOM ????????? **Document** ??????? [Office.initialize](https://dev.office.com/reference/add-ins/shared/office.initialize) ????????????????????????????????? DOM ?????????????????[?? DOM ??????](loading-the-dom-and-runtime-environment.md)?
    
3.  **???????????**???? API ??????????????????
    
    - ???????? [Bindings](https://dev.office.com/reference/add-ins/shared/bindings.bindings) ????????????? [Binding](https://dev.office.com/reference/add-ins/shared/binding) ?????????
    
    - [CustomXmlParts](https://dev.office.com/reference/add-ins/shared/customxmlparts.customxmlparts)?[CustomXmlPart](https://dev.office.com/reference/add-ins/shared/customxmlpart.customxmlpart) ????????????? Word ??????? XML ???
    
    - ??????????????????????????????????????? [File](https://dev.office.com/reference/add-ins/shared/file) ? [Slice](https://dev.office.com/reference/add-ins/shared/slice) ???
    
    - [Settings](https://dev.office.com/reference/add-ins/shared/settings) ????????????????????????????
    

> [!IMPORTANT]
> ???????????????????? Office ????????? API ???????????????????????

????? Office ??????? Office JavaScript API ??????[????? Office ? JavaScript API](understanding-the-javascript-api-for-office.md)?


## <a name="reading-and-writing-to-an-active-selection"></a>??????????????

????????????????????????????????????????????????? [Document](https://dev.office.com/reference/add-ins/shared/document.getselecteddataasync) ??? [getSelectedDataAsync](https://dev.office.com/reference/add-ins/shared/document.setselecteddataasync) ? [setSelectedDataAsync](https://dev.office.com/reference/add-ins/shared/document) ???????????????????????????????????? Word ?????????HTML?????? Office Open XML???? Excel ????????????? PowerPoint ? Project ???????????????????????????????????? **getSelectedDataAsync** ??????????????????


```js
Office.context.document.getSelectedDataAsync(
    Office.CoercionType.Text, function (asyncResult) {
        if (asyncResult.status == Office.AsyncResultStatus.Failed) {
            write('Action failed. Error: ' + asyncResult.error.message);
        }
        else {
            write('Selected data: ' + asyncResult.value);
        }
    });

// Function that writes to a div with id='message' on the page.
function write(message){
    document.getElementById('message').innerText += message; 
}

```

?????????????[?????????????????????????](read-and-write-data-to-the-active-selection-in-a-document-or-spreadsheet.md)?


## <a name="binding-to-a-region-in-a-document-or-spreadsheet"></a>??????????????

????? **getSelectedDataAsync** ? **setSelectedDataAsync** ???????????????????*??*?????????????????????????????????????????????????????????????????????????????????????????????

???? [Bindings](https://dev.office.com/reference/add-ins/shared/bindings.addfromnameditemasync) ??? [addFromNamedItemAsync](https://dev.office.com/reference/add-ins/shared/bindings.addfrompromptasync)?[addFromPromptAsync](https://dev.office.com/reference/add-ins/shared/bindings.addfromselectionasync) ? [addFromSelectionAsync](https://dev.office.com/reference/add-ins/shared/bindings.bindings) ??????????????????????????????????????????????????

????? **Bindings.addFromSelectionAsync** ????????????????????



```js
Office.context.document.bindings.addFromSelectionAsync(
    Office.BindingType.Text, { id: 'myBinding' }, function (asyncResult) {
    if (asyncResult.status == Office.AsyncResultStatus.Failed) {
        write('Action failed. Error: ' + asyncResult.error.message);
    } else {
        write('Added new binding with type: ' +
            asyncResult.value.type + ' and id: ' + asyncResult.value.id);
    }
});

// Function that writes to a div with id='message' on the page.
function write(message){
    document.getElementById('message').innerText += message; 
}
```

?????????????[??????????????](bind-to-regions-in-a-document-or-spreadsheet.md)?


## <a name="getting-entire-documents"></a>??????

??????????? PowerPoint ? Word ????????? [Document.getFileAsync](https://dev.office.com/reference/add-ins/shared/document.getfileasync)?[File.getSliceAsync](https://dev.office.com/reference/add-ins/shared/file.getsliceasync) ? [File.closeAsync](https://dev.office.com/reference/add-ins/shared/file.closeasync) ??????????????

???? **Document.getFileAsync** ????? [File](https://dev.office.com/reference/add-ins/shared/file) ?????????**File** ???????? [Slice](https://dev.office.com/reference/add-ins/shared/document) ???????????????? **getFileAsync** ?????????????????? Open Office XML ???????????? 4MB?????? **File** ???????????? **Slice.data** ?????????? [File.getSliceAsync](https://dev.office.com/reference/add-ins/shared/slice.data)????????????????????????????????????? Web ????????????????????? base64 ??????????????????????? **File.closeAsync** ???????

????????????[?? PowerPoint ? Word ?????????](../word/get-the-whole-document-from-an-add-in-for-word.md)? 


## <a name="reading-and-writing-custom-xml-parts-of-a-word-document"></a>????? Word ?????? XML ??

???? Open Office XML ????????????????? XML ????? Word ????? XML ???????????????????????Word ?????????? XML ??????????????????????????????????????????????????????? XML ?????? Word ????????????? [Document.customXmlParts](https://dev.office.com/reference/add-ins/shared/document.customxmlparts) ???[CustomXmlParts](https://dev.office.com/reference/add-ins/shared/customxmlparts.customxmlparts)?[CustomXmlPart](https://dev.office.com/reference/add-ins/shared/customxmlpart.customxmlpart) ? [CustomXmlNode](https://dev.office.com/reference/add-ins/shared/customxmlnode.customxmlnode) ???????????????????????

??? XML ????????????????????????? XML ?????????? [CustomXmlParts.getByNamespaceAsync](https://dev.office.com/reference/add-ins/shared/customxmlparts.getbynamespaceasync) ???

?????? [CustomXmlParts.getByIdAsync](https://dev.office.com/reference/add-ins/shared/customxmlparts.getbyidasync) ????? GUID ????? XML ????????? XML ?????? [CustomXmlPart.getXmlAsync](https://dev.office.com/reference/add-ins/shared/customxmlpart.getxmlasync) ???? XML ???

???????? XML ??????????? **Document.customXmlParts** ??????????? XML ?????? [CustomXmlParts.addAsync](https://dev.office.com/reference/add-ins/shared/customxmlparts.addasync) ???

???????????????????? XML ???????????[?? Office Open XML ????? Word ????](../word/create-better-add-ins-for-word-with-office-open-xml.md)?


## <a name="persisting-add-in-settings"></a>???????


??????????????????????????????????????????????????????????? Web ??????????????? cookie ? HTML 5 Web ??????????????? Excel?PowerPoint ? Word ????????? [??](https://dev.office.com/reference/add-ins/shared/settings) ????????**??**?????????????????????????????????????????????????

?????????????????? **Settings** ???????????????????????????????????????????????? [Settings.saveAsync](https://dev.office.com/reference/add-ins/shared/settings.saveasync) ??????????????????????????????/????????? JSON ???????? [Settings](https://dev.office.com/reference/add-ins/shared/settings.get) ??? [get](https://dev.office.com/reference/add-ins/shared/settings.set)?[set](https://dev.office.com/reference/add-ins/shared/settings.removehandlerasync) ? **remove** ??????????????????????????????????? `themeColor` ?????????????green??




```js
Office.context.document.settings.set('themeColor', 'green');
```

???? **set** ? **remove** ????????????????????????????? **saveAsync** ??????????????????????

?????????? **Settings** ????????????????[??????????](persisting-add-in-state-and-settings.md)?


## <a name="reading-properties-of-a-project-document"></a>?????????

????????????? Project ?????????????????????????????????????????? [Document](https://dev.office.com/reference/add-ins/shared/projectdocument.projectdocument) ???????????? Project ??? **ProjectDocument** ?????????

???? Project ?????????[??????????? Project 2013 ???????](../project/create-your-first-task-pane-add-in-for-project-by-using-a-text-editor.md)?


## <a name="permissions-model-and-governance"></a>???????

????????????? **Permissions** ????? Office JavaScript API ??????????????????????????????/?????????????? `ReadWriteDocument` ???? **Permissions** ???????????????????????????????????????????????????????????????????????? **ReadDocument** ???


```XML
<?xml version="1.0" encoding="utf-8"?>
<OfficeApp xmlns="http://schemas.microsoft.com/office/appforoffice/1.0"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
 xsi:type="TaskPaneApp">
???<!-- Other manifest elements omitted. -->
  <Permissions>ReadDocument</Permissions>
???
</OfficeApp>

```

??????????[???????????????? API ????](requesting-permissions-for-api-use-in-content-and-task-pane-add-ins.md)?


## <a name="see-also"></a>????

- [Office JavaScript API](https://dev.office.com/reference/add-ins/javascript-api-for-office)
- [Office ??????????](../develop/add-in-manifests.md)
- [?? Office ?????????](../testing/testing-and-troubleshooting.md)
    
