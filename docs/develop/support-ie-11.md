---
title: 支持 Internet Explorer 11
description: 了解如何在外接程序Internet Explorer 11 和 ES5 Javascript。
ms.date: 06/18/2021
localization_priority: Normal
ms.openlocfilehash: 3677b12d265cb70d2c048e91fc32ff5f9619908b
ms.sourcegitcommit: ee9e92a968e4ad23f1e371f00d4888e4203ab772
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/23/2021
ms.locfileid: "53075906"
---
# <a name="support-internet-explorer-11"></a><span data-ttu-id="07487-103">支持 Internet Explorer 11</span><span class="sxs-lookup"><span data-stu-id="07487-103">Support Internet Explorer 11</span></span>

> [!IMPORTANT]
> <span data-ttu-id="07487-104">**Internet Explorer外接程序Office中使用的内容**</span><span class="sxs-lookup"><span data-stu-id="07487-104">**Internet Explorer still used in Office Add-ins**</span></span>
>
> <span data-ttu-id="07487-105">Microsoft 将终止对Internet Explorer的支持，但这不会显著Office外接程序。平台和 Office 版本（包括 Office 2019 的所有一次购买版本）的一些组合将继续使用 Internet Explorer 11 随附的 Webview 控件来托管外接程序，如[Office](../concepts/browsers-used-by-office-web-add-ins.md)外接程序使用的浏览器所说明。此外，提交到[AppSource](/office/dev/store/submit-to-appsource-via-partner-center)的加载项Internet Explorer支持这些组合，因此也支持这些组合。</span><span class="sxs-lookup"><span data-stu-id="07487-105">Microsoft is ending support for Internet Explorer, but this doesn't significantly affect Office Add-ins. Some combinations of platforms and Office versions, including all one-time-purchase versions through Office 2019, will continue to use the webview control that comes with Internet Explorer 11 to host add-ins, as explained in [Browsers used by Office Add-ins](../concepts/browsers-used-by-office-web-add-ins.md). Moreover, support for these combinations, and hence for Internet Explorer, is still required for add-ins submitted to [AppSource](/office/dev/store/submit-to-appsource-via-partner-center).</span></span> <span data-ttu-id="07487-106">有两 *个变化* ：</span><span class="sxs-lookup"><span data-stu-id="07487-106">Two things *are* changing:</span></span>
>
> - <span data-ttu-id="07487-107">AppSource 不再使用作为浏览器Office web 版Internet Explorer加载项。</span><span class="sxs-lookup"><span data-stu-id="07487-107">AppSource no longer tests add-ins in Office on the web using Internet Explorer as the browser.</span></span> <span data-ttu-id="07487-108">但 AppSource 仍测试使用 Office *版本的平台* 和桌面Internet Explorer。</span><span class="sxs-lookup"><span data-stu-id="07487-108">But AppSource still tests for combinations of platform and Office *desktop* versions that use Internet Explorer.</span></span>
> - <span data-ttu-id="07487-109">2021 Script Lab，Internet Explorer工具将停止工作。 [](../overview/explore-with-script-lab.md)</span><span class="sxs-lookup"><span data-stu-id="07487-109">The [Script Lab tool](../overview/explore-with-script-lab.md) will stop working in Internet Explorer sometime in 2021.</span></span>

<span data-ttu-id="07487-110">Office外接程序是 Web 应用程序，当在 IFrame 上运行时，这些应用程序Office web 版。</span><span class="sxs-lookup"><span data-stu-id="07487-110">Office Add-ins are web applications that are displayed inside IFrames when running on Office on the web.</span></span> <span data-ttu-id="07487-111">Office加载项在 Mac 上的 Office 或 Windows Office内运行时，使用嵌入式浏览器控件显示。</span><span class="sxs-lookup"><span data-stu-id="07487-111">Office Add-ins are displayed using embedded browser controls when running in Office on Windows or Office on the Mac.</span></span> <span data-ttu-id="07487-112">嵌入式浏览器控件由操作系统或用户计算机上安装的浏览器提供。</span><span class="sxs-lookup"><span data-stu-id="07487-112">The embedded browser controls are supplied by the operating system or by a browser installed on the user's computer.</span></span>

<span data-ttu-id="07487-113">如果计划通过 AppSource 销售加载项或计划支持较旧版本的 Windows 和 Office，加载项必须在基于 Internet Explorer 11 (IE11) 的可嵌入浏览器控件中运行。</span><span class="sxs-lookup"><span data-stu-id="07487-113">If you plan to market your add-in through AppSource or you plan to support older versions of Windows and Office, your add-in must work in the embeddable browser control that is based on Internet Explorer 11 (IE11).</span></span> <span data-ttu-id="07487-114">有关使用基于 IE11 Windows和Office的浏览器控件的信息，请参阅浏览器[Office外接程序。](../concepts/browsers-used-by-office-web-add-ins.md)</span><span class="sxs-lookup"><span data-stu-id="07487-114">For information about which combinations of Windows and Office use the IE11-based browser control, see [Browsers used by Office Add-ins](../concepts/browsers-used-by-office-web-add-ins.md).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="07487-115">Internet Explorer 11 不支持某些 HTML5 功能，如媒体、录制和位置。</span><span class="sxs-lookup"><span data-stu-id="07487-115">Internet Explorer 11 doesn't support some HTML5 features such as media, recording, and location.</span></span> <span data-ttu-id="07487-116">如果外接程序必须支持 Internet Explorer 11，则你无法使用这些功能。</span><span class="sxs-lookup"><span data-stu-id="07487-116">If your add-in must support Internet Explorer 11, then you can't use these features.</span></span>

<span data-ttu-id="07487-117">Internet Explorer 11 不支持低于 ES5 的 JavaScript 版本。</span><span class="sxs-lookup"><span data-stu-id="07487-117">Internet Explorer 11 doesn't support JavaScript versions later than ES5.</span></span> <span data-ttu-id="07487-118">如果要使用 ECMAScript 2015 或更高版本或 TypeScript 的语法和功能，有两个选项，如本文所述。</span><span class="sxs-lookup"><span data-stu-id="07487-118">If you want to use the syntax and features of ECMAScript 2015 or later, or TypeScript, you have two options as described in this article.</span></span> <span data-ttu-id="07487-119">还可以结合这两种技术。</span><span class="sxs-lookup"><span data-stu-id="07487-119">You can also combine these two techniques.</span></span>

## <a name="use-a-transpiler"></a><span data-ttu-id="07487-120">使用转译器</span><span class="sxs-lookup"><span data-stu-id="07487-120">Use a transpiler</span></span>

<span data-ttu-id="07487-121">可以使用 TypeScript 或新式 JavaScript 编写代码，然后在生成时将代码转换为 ES5 JavaScript。</span><span class="sxs-lookup"><span data-stu-id="07487-121">You can write your code in either TypeScript or modern JavaScript and then transpile it at build-time into ES5 JavaScript.</span></span> <span data-ttu-id="07487-122">生成的 ES5 文件是上传到加载项 Web 应用程序的文件。</span><span class="sxs-lookup"><span data-stu-id="07487-122">The resulting ES5 files are what you upload to your add-in's web application.</span></span>

<span data-ttu-id="07487-123">有两种常用转译器。</span><span class="sxs-lookup"><span data-stu-id="07487-123">There are two popular transpilers.</span></span> <span data-ttu-id="07487-124">两者都可以使用 TypeScript 或 ES5 后 JavaScript 的源文件。</span><span class="sxs-lookup"><span data-stu-id="07487-124">Both of them can work with source files that are TypeScript or post-ES5 JavaScript.</span></span> <span data-ttu-id="07487-125">它们还使用 React.jsx ( .tsx) 。</span><span class="sxs-lookup"><span data-stu-id="07487-125">They also work with React files (.jsx and .tsx).</span></span>

- [<span data-ttu-id="07487-126">一些</span><span class="sxs-lookup"><span data-stu-id="07487-126">babel</span></span>](https://babeljs.io/)
- [<span data-ttu-id="07487-127">tsc</span><span class="sxs-lookup"><span data-stu-id="07487-127">tsc</span></span>](https://www.typescriptlang.org/index.html)

<span data-ttu-id="07487-128">有关在加载项项目中安装和配置转译器的信息，请参阅任一文档。</span><span class="sxs-lookup"><span data-stu-id="07487-128">See the documentation for either of them for information about installing and configuring the transpiler in your add-in project.</span></span> <span data-ttu-id="07487-129">建议您使用任务运行程序（如 [Grunt](https://gruntjs.com/) 或 [WebPack）](https://webpack.js.org/) 来自动进行转换。</span><span class="sxs-lookup"><span data-stu-id="07487-129">We recommend that you use a task runner, such as [Grunt](https://gruntjs.com/) or [WebPack](https://webpack.js.org/) to automate the transpilation.</span></span> <span data-ttu-id="07487-130">有关使用 tsc 的示例外接程序，请参阅 Office Microsoft 外接程序[Graph React。](https://github.com/OfficeDev/PnP-OfficeAddins/tree/3ce0e1b74152dbbe8306a091696bc4455c04c0a1/Samples/auth/Office-Add-in-Microsoft-Graph-React)</span><span class="sxs-lookup"><span data-stu-id="07487-130">For a sample add-in that uses tsc, see [Office Add-in Microsoft Graph React](https://github.com/OfficeDev/PnP-OfficeAddins/tree/3ce0e1b74152dbbe8306a091696bc4455c04c0a1/Samples/auth/Office-Add-in-Microsoft-Graph-React).</span></span> <span data-ttu-id="07487-131">有关使用分贝的示例，请参阅脱机[存储外接程序。](https://github.com/OfficeDev/PnP-OfficeAddins/tree/3ce0e1b74152dbbe8306a091696bc4455c04c0a1/Samples/Excel.OfflineStorageAddin)</span><span class="sxs-lookup"><span data-stu-id="07487-131">For a sample that uses babel, see [Offline Storage Add-in](https://github.com/OfficeDev/PnP-OfficeAddins/tree/3ce0e1b74152dbbe8306a091696bc4455c04c0a1/Samples/Excel.OfflineStorageAddin).</span></span>

> [!NOTE]
> <span data-ttu-id="07487-132">如果使用的不是Visual Studio (，Visual Studio Code) tsc 可能最易于使用。</span><span class="sxs-lookup"><span data-stu-id="07487-132">If you are using Visual Studio (not Visual Studio Code), tsc is probably easiest to use.</span></span> <span data-ttu-id="07487-133">可以使用 nuget 程序包安装对它的支持。</span><span class="sxs-lookup"><span data-stu-id="07487-133">You can install support for it with a nuget package.</span></span> <span data-ttu-id="07487-134">有关详细信息，请参阅[JavaScript and TypeScript in Visual Studio 2019](/visualstudio/javascript/javascript-in-vs-2019)。</span><span class="sxs-lookup"><span data-stu-id="07487-134">For more information, see [JavaScript and TypeScript in Visual Studio 2019](/visualstudio/javascript/javascript-in-vs-2019).</span></span> <span data-ttu-id="07487-135">若要对任务Visual Studio，请创建生成脚本或使用 Visual Studio 中的任务运行程序资源管理器以及[WebPack](https://marketplace.visualstudio.com/items?itemName=MadsKristensen.WebPackTaskRunner)任务运行程序或[NPM 任务运行程序等工具](https://marketplace.visualstudio.com/items?itemName=MadsKristensen.NPMTaskRunner)。</span><span class="sxs-lookup"><span data-stu-id="07487-135">To use babel with Visual Studio, create a build script or use the Task Runner Explorer in Visual Studio with tools like the [WebPack Task Runner](https://marketplace.visualstudio.com/items?itemName=MadsKristensen.WebPackTaskRunner) or [NPM Task Runner](https://marketplace.visualstudio.com/items?itemName=MadsKristensen.NPMTaskRunner).</span></span>

## <a name="use-a-polyfill"></a><span data-ttu-id="07487-136">使用填充</span><span class="sxs-lookup"><span data-stu-id="07487-136">Use a polyfill</span></span>

<span data-ttu-id="07487-137">[填充是](https://en.wikipedia.org/wiki/Polyfill_(programming))早期版本的 JavaScript，与 JavaScript 的较新版本重复功能。</span><span class="sxs-lookup"><span data-stu-id="07487-137">A [polyfill](https://en.wikipedia.org/wiki/Polyfill_(programming)) is earlier-version JavaScript that duplicates functionality from more recent versions of JavaScript.</span></span> <span data-ttu-id="07487-138">填充适用于不支持更高版本 JavaScript 的浏览器。</span><span class="sxs-lookup"><span data-stu-id="07487-138">The polyfill works with in browsers that don't support the later JavaScript versions.</span></span> <span data-ttu-id="07487-139">例如，字符串方法不是 JavaScript 的 ES5 版本的一部分，因此它不会在 `startsWith` 11 Internet Explorer中运行。</span><span class="sxs-lookup"><span data-stu-id="07487-139">For example, the string method `startsWith` wasn't part of the ES5 version of JavaScript, and so it won't run in Internet Explorer 11.</span></span> <span data-ttu-id="07487-140">有一些用 ES5 编写的填充库定义了和实现 `startsWith` 一个方法。</span><span class="sxs-lookup"><span data-stu-id="07487-140">There are polyfill libraries, written in ES5, that define and implement a `startsWith` method.</span></span> <span data-ttu-id="07487-141">我们建议使用 [core-js](https://github.com/zloirock/core-js) 填充库。</span><span class="sxs-lookup"><span data-stu-id="07487-141">We recommend the [core-js](https://github.com/zloirock/core-js) polyfill library.</span></span>

<span data-ttu-id="07487-142">若要使用填充库，请像加载任何其他 JavaScript 文件或模块一样加载它。</span><span class="sxs-lookup"><span data-stu-id="07487-142">To use a polyfill library, load it like any other JavaScript file or module.</span></span> <span data-ttu-id="07487-143">例如，您可以使用外接程序主页 HTML 文件 (例如) 中的 标记，或者可以使用 JavaScript 文件 (例如) 中的 `<script>` `<script src="/js/core-js.js"></script>` `import` `import 'core-js';` 语句。</span><span class="sxs-lookup"><span data-stu-id="07487-143">For example, you can use a `<script>` tag in the add-in's home page HTML file (for example `<script src="/js/core-js.js"></script>`), or you can use an `import` statement in a JavaScript file (for example, `import 'core-js';`).</span></span> <span data-ttu-id="07487-144">当 JavaScript 引擎看到类似 的方法时，它将首先查看语言中是否内置了该 `startsWith` 名称的方法。</span><span class="sxs-lookup"><span data-stu-id="07487-144">When the JavaScript engine sees a method like `startsWith`, it will first look to see if there is a method of that name built into the language.</span></span> <span data-ttu-id="07487-145">如果存在，它将调用本机方法。</span><span class="sxs-lookup"><span data-stu-id="07487-145">If there is, it will call the native method.</span></span> <span data-ttu-id="07487-146">如果且仅在该方法未内置时，引擎将查找它的所有加载文件。</span><span class="sxs-lookup"><span data-stu-id="07487-146">If, and only if, the method isn't built-in, the engine will look in all loaded files for it.</span></span> <span data-ttu-id="07487-147">因此，填充版本不会在支持本机版本的浏览器中使用。</span><span class="sxs-lookup"><span data-stu-id="07487-147">So, the polyfilled version isn't used in browsers that support the native version.</span></span>

<span data-ttu-id="07487-148">导入整个 core-js 库将导入所有 core-js 功能。</span><span class="sxs-lookup"><span data-stu-id="07487-148">Importing the entire core-js library will import all core-js features.</span></span> <span data-ttu-id="07487-149">还可以仅导入加载项Office填充。</span><span class="sxs-lookup"><span data-stu-id="07487-149">You can also import only the polyfills that your Office Add-in requires.</span></span> <span data-ttu-id="07487-150">有关如何执行此操作的说明，请参阅[CommonJS API。](https://github.com/zloirock/core-js#commonjs-api)</span><span class="sxs-lookup"><span data-stu-id="07487-150">For instructions about how to do this, see [CommonJS APIs](https://github.com/zloirock/core-js#commonjs-api).</span></span> <span data-ttu-id="07487-151">core-js 库具有所需的大部分填充。</span><span class="sxs-lookup"><span data-stu-id="07487-151">The core-js library has most of the polyfills that you need.</span></span> <span data-ttu-id="07487-152">core-js 文档的"缺少 [填充](https://github.com/zloirock/core-js#missing-polyfills) "部分详细介绍了一些例外情况。</span><span class="sxs-lookup"><span data-stu-id="07487-152">There are a few exceptions detailed in the [Missing Polyfills](https://github.com/zloirock/core-js#missing-polyfills) section of the core-js documentation.</span></span> <span data-ttu-id="07487-153">例如，它不支持 `fetch` ，但可以使用 [fetch](https://github.com/github/fetch) 填充。</span><span class="sxs-lookup"><span data-stu-id="07487-153">For example, it doesn't support `fetch`, but you can use the [fetch](https://github.com/github/fetch) polyfill.</span></span>

<span data-ttu-id="07487-154">有关使用加载项示例core.js，请参阅 [Word 加载项 Angular2 StyleChecker](https://github.com/OfficeDev/Word-Add-in-Angular2-StyleChecker)。</span><span class="sxs-lookup"><span data-stu-id="07487-154">For a sample add-in that uses core.js, see [Word Add-in Angular2 StyleChecker](https://github.com/OfficeDev/Word-Add-in-Angular2-StyleChecker).</span></span>

## <a name="testing-an-add-in-on-internet-explorer"></a><span data-ttu-id="07487-155">在加载项上测试Internet Explorer</span><span class="sxs-lookup"><span data-stu-id="07487-155">Testing an add-in on Internet Explorer</span></span>

<span data-ttu-id="07487-156">请参阅 [Internet Explorer 11 测试](../testing/ie-11-testing.md)。</span><span class="sxs-lookup"><span data-stu-id="07487-156">See [Internet Explorer 11 testing](../testing/ie-11-testing.md).</span></span>

## <a name="additional-resources"></a><span data-ttu-id="07487-157">其他资源</span><span class="sxs-lookup"><span data-stu-id="07487-157">Additional resources</span></span>

- [<span data-ttu-id="07487-158">ECMAScript 6 兼容性表</span><span class="sxs-lookup"><span data-stu-id="07487-158">ECMAScript 6 compatibility table</span></span>](https://kangax.github.io/compat-table/es6/)
- [<span data-ttu-id="07487-159">我可以使用...HTML5、CSS3 等的支持表</span><span class="sxs-lookup"><span data-stu-id="07487-159">Can I use... Support tables for HTML5, CSS3, etc</span></span>](https://caniuse.com/)
