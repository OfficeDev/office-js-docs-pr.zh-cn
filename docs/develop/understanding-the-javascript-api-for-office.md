---
title: 了解适用于 Office 的 JavaScript API
description: ''
ms.date: 01/23/2018
ms.openlocfilehash: 1ff65e8cf081330c0ce5fe8d048f703b259a5ef3
ms.sourcegitcommit: c72c35e8389c47a795afbac1b2bcf98c8e216d82
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/23/2018
ms.locfileid: "19437680"
---
# <a name="understanding-the-javascript-api-for-office"></a><span data-ttu-id="06c26-102">了解适用于 Office 的 JavaScript API</span><span class="sxs-lookup"><span data-stu-id="06c26-102">Understanding the JavaScript API for Office</span></span>

<span data-ttu-id="06c26-p101">本文提供了有关适用于 Office 的 JavaScript API 的信息以及使用方法。有关参考信息，请参阅 [适用于 Office 的 JavaScript API](https://dev.office.com/reference/add-ins/javascript-api-for-office)。有关将 Visual Studio 项目文件更新到适用于 Office 的 JavaScript API 的最新当前版本的信息，请参阅 [更新适用于 Office 的 JavaScript API 版本和清单架构文件](update-your-javascript-api-for-office-and-manifest-schema-version.md)。</span><span class="sxs-lookup"><span data-stu-id="06c26-p101">This article provides information about the JavaScript API for Office and how to use it. For reference information, see [JavaScript API for Office](https://dev.office.com/reference/add-ins/javascript-api-for-office). For information about updating Visual Studio project files to the most current version of the JavaScript API for Office, see [Update the version of your JavaScript API for Office and manifest schema files](update-your-javascript-api-for-office-and-manifest-schema-version.md).</span></span>

> [!NOTE]
> <span data-ttu-id="06c26-p102">如果计划将加载项[发布](../publish/publish.md)到 AppSource 并适用于 Office 体验，请务必遵循 [AppSource 验证策略](https://docs.microsoft.com/en-us/office/dev/store/validation-policies)。例如，加载项必须适用于支持已定义方法的所有平台，才能通过验证（有关详细信息，请参阅[第 4.12 部分](https://docs.microsoft.com/en-us/office/dev/store/validation-policies#4-apps-and-add-ins-behave-predictably)以及 [Office 加载项主机和可用性](../overview/office-add-in-availability.md)页面）。</span><span class="sxs-lookup"><span data-stu-id="06c26-p102">If you plan to [publish](../publish/publish.md) your add-in to AppSource and make it available within the Office experience, make sure that you conform to the [AppSource validation policies](https://docs.microsoft.com/en-us/office/dev/store/validation-policies). For example, to pass validation, your add-in must work across all platforms that support the methods that you define (for more information, see [section 4.12](https://docs.microsoft.com/en-us/office/dev/store/validation-policies#4-apps-and-add-ins-behave-predictably) and the [Office Add-in host and availability page](../overview/office-add-in-availability.md)).</span></span> 

## <a name="referencing-the-javascript-api-for-office-library-in-your-add-in"></a><span data-ttu-id="06c26-108">在加载项中引用适用于 Office 的 JavaScript API 库</span><span class="sxs-lookup"><span data-stu-id="06c26-108">Referencing the JavaScript API for Office library in your add-in</span></span>

<span data-ttu-id="06c26-p103">[适用于 Office 的 JavaScript](https://dev.office.com/reference/add-ins/javascript-api-for-office) 库包含 Office.js 文件和关联的特定于主机应用程序的 .js 文件，例如 Excel-15.js 和 Outlook-15.js。引用该 API 最简单的方法是通过添加以下 `<script>` 到你的页面的 `<head>` 标记来使用我们的 CDN：</span><span class="sxs-lookup"><span data-stu-id="06c26-p103">The [JavaScript API for Office](https://dev.office.com/reference/add-ins/javascript-api-for-office) library consists of the Office.js file and associated host application-specific .js files, such as Excel-15.js and Outlook-15.js. The simplest method of referencing the API is using our CDN by adding the following `<script>` to your page's `<head>` tag:</span></span>  

```html
<script src="https://appsforoffice.microsoft.com/lib/1/hosted/Office.js" type="text/javascript"></script>
```

<span data-ttu-id="06c26-111">这将在加载项首次加载时下载并缓存适用于 Office 的 JavaScript API 文件，以确保对特定版本使用 Office.js 及其关联文件的最新实现。</span><span class="sxs-lookup"><span data-stu-id="06c26-111">This will download and cache the JavaScript API for Office files the first time your add-in loads to make sure that it is using the most up-to-date implementation of Office.js and its associated files for the specified version.</span></span>

<span data-ttu-id="06c26-112">有关 Office.js CDN 的更多详细信息（包括如何处理版本控制和向后兼容性），请参阅[从适用于 Office 的 JavaScript API 库的内容交付网络 (CDN) 对其引用](referencing-the-javascript-api-for-office-library-from-its-cdn.md)。</span><span class="sxs-lookup"><span data-stu-id="06c26-112">For more details around the Office.js CDN, including how versioning and backward compatability is handled, see [Referencing the JavaScript API for Office library from its content delivery network (CDN)](referencing-the-javascript-api-for-office-library-from-its-cdn.md).</span></span>

## <a name="initializing-your-add-in"></a><span data-ttu-id="06c26-113">初始化加载项</span><span class="sxs-lookup"><span data-stu-id="06c26-113">Initializing your add-in</span></span>

<span data-ttu-id="06c26-114">**适用于：** 所有加载项类型</span><span class="sxs-lookup"><span data-stu-id="06c26-114">**Applies to:** All add-in types</span></span>

<span data-ttu-id="06c26-p104">Office.js 提供初始化事件，API 完全加载并准备与用户开始交互时会触发该事件。你可以使用 **initialize** 事件处理程序实现常见的外接程序初始化方案，例如，可以提示用户选择 Excel 中的一些单元格，然后插入使用选定值初始化的图表。还可以使用 initialize 事件处理程序初始化外接程序的其他自定义逻辑，例如建立绑定、提示默认外接程序设置值等。</span><span class="sxs-lookup"><span data-stu-id="06c26-p104">Office.js provides an initialization event which gets fired when the API is fully loaded and ready to begin interacting with the user. You can use the **initialize** event handler to implement common add-in initialization scenarios, such as prompting the user to select some cells in Excel, and then inserting a chart initialized with those selected values. You can also use the initialize event handler to initialize other custom logic for your add-in, such as establishing bindings, prompting for default add-in settings values, and so on.</span></span>

<span data-ttu-id="06c26-118">至少，initialize 事件应类似下面的示例：</span><span class="sxs-lookup"><span data-stu-id="06c26-118">At a minimum, the initialize event would look like the follow example:</span></span>     

```js
Office.initialize = function () { };
```
<span data-ttu-id="06c26-p105">如果你使用其他 JavaScript 框架，其中包括它们自己的初始化处理程序或测试，那么它们应放置在 Office.initialize 事件内。例如，会对 [JQuery](https://jquery.com) `$(document).ready()` 函数进行以下引用：</span><span class="sxs-lookup"><span data-stu-id="06c26-p105">If you are using additional JavaScript frameworks that include their own initialization handler or tests, these should be placed within the Office.initialize event. For example, [JQuery's](https://jquery.com) `$(document).ready()` function would be referenced as follows:</span></span>

```js
Office.initialize = function () {
    // Office is ready
    $(document).ready(function () {        
        // The document is ready
    });
  };
```

<span data-ttu-id="06c26-p106">Office 外接程序中的所有页面需要向 initialize 事件 (**Office.initialize**) 分配一个事件处理程序。如果未能分配一个事件处理程序，则外接程序可能会在启动时出现错误。而且，如果某个用户尝试通过 Office Online Web 客户端（例如 Excel Online、PowerPoint Online 或 Outlook Web App）使用你的外接程序，则外接程序会无法运行。如果无需任何初始化代码，则向 **Office.initialize** 分配的函数的正文可以如同上述第一个示例中一样为空。</span><span class="sxs-lookup"><span data-stu-id="06c26-p106">All pages within an Office Add-ins are required to assign an event handler to the initialize event, **Office.initialize**. If you fail to assign an event handler, your add-in may raise an error when it starts. Also, if a user attempts to use your add-in with an Office Online web client, such as Excel Online, PowerPoint Online, or Outlook Web App, it will fail to run. If you don't need any initialization code, then the body of the function you assign to **Office.initialize** can be empty, as it is in the first example above.</span></span>

<span data-ttu-id="06c26-125">若要详细了解加载项初始化时的事件发生顺序，请参阅[加载 DOM 和运行时环境](loading-the-dom-and-runtime-environment.md)。</span><span class="sxs-lookup"><span data-stu-id="06c26-125">For more detail about the sequence of events when an add-in is initialized, see [Loading the DOM and runtime environment](loading-the-dom-and-runtime-environment.md).</span></span>

#### <a name="initialization-reason"></a><span data-ttu-id="06c26-126">初始化原因</span><span class="sxs-lookup"><span data-stu-id="06c26-126">Initialization reason</span></span>
<span data-ttu-id="06c26-p107">Office.initialize 为任务窗格和内容外接程序提供其他“_reason_”参数。此参数可用于确定如何将外接程序添加到当前文档。你可以使用此参数针对首次插入加载项时和加载项已存在于文档中时实施不同的逻辑。</span><span class="sxs-lookup"><span data-stu-id="06c26-p107">For task pane and content add-ins, Office.initialize provides an additional _reason_ parameter. This parameter can be used to determine how an add-in was added to the current document. You can use this to provide different logic for when an add-in is first inserted versus when it already existed within the document.</span></span> 

```js
Office.initialize = function (reason) {
    $(document).ready(function () {
        switch (reason) {
            case 'inserted': console.log('The add-in was just inserted.');
            case 'documentOpened': console.log('The add-in is already part of the document.');
        }
    });
 };
```
<span data-ttu-id="06c26-130">有关详细信息，请参阅 [Office.initialize 事件](https://dev.office.com/reference/add-ins/shared/office.initialize)和 [InitializationReason 枚举](https://dev.office.com/reference/add-ins/shared/initializationreason-enumeration)。</span><span class="sxs-lookup"><span data-stu-id="06c26-130">For more information, see [Office.initialize Event](https://dev.office.com/reference/add-ins/shared/office.initialize) and [InitializationReason Enumeration](https://dev.office.com/reference/add-ins/shared/initializationreason-enumeration).</span></span> 

## <a name="context-object"></a><span data-ttu-id="06c26-131">Context 对象</span><span class="sxs-lookup"><span data-stu-id="06c26-131">Context object</span></span>

<span data-ttu-id="06c26-132">**适用于：** 所有加载项类型</span><span class="sxs-lookup"><span data-stu-id="06c26-132">**Applies to:** All add-in types</span></span>

<span data-ttu-id="06c26-p108">加载项初始化时，它有许多可以在运行时环境中交互的不同对象。加载项运行时上下文通过 [Context](https://dev.office.com/reference/add-ins/shared/office.context) 对象反映在 API 中。**Context** 是提供对于最重要 API 对象（例如 [Document](https://dev.office.com/reference/add-ins/shared/document) 和 [Mailbox](https://dev.office.com/reference/add-ins/outlook/Office.context.mailbox) 对象）的访问权限的主对象，这些对象继而提供对文档和邮箱内容的访问权限。</span><span class="sxs-lookup"><span data-stu-id="06c26-p108">When an add-in is initialized, it has many different objects that it can interact with in the runtime environment. The add-in's runtime context is reflected in the API by the [Context](https://dev.office.com/reference/add-ins/shared/office.context) object. The **Context** is the main object that provides access to the most important objects of the API, such as the [Document](https://dev.office.com/reference/add-ins/shared/document) and [Mailbox](https://dev.office.com/reference/add-ins/outlook/Office.context.mailbox) objects, which in turn provide access to document and mailbox content.</span></span>

<span data-ttu-id="06c26-p109">例如，在任务窗格或内容外接程序中，可以使用 [Context](https://dev.office.com/reference/add-ins/shared/office.context.document) 对象的 **document** 属性访问 **Document** 对象的属性和方法，以便与 Word 文档、Excel 工作表或 Project 计划的内容交互。类似地，在 Outlook 外接程序中，可以使用 [Context](https://dev.office.com/reference/add-ins/outlook/Office.context.mailbox) 对象的 **mailbox** 属性访问 **Mailbox** 对象的属性和方法，以便与邮件、会议请求或约会内容交互。</span><span class="sxs-lookup"><span data-stu-id="06c26-p109">For example, in task pane or content add-ins, you can use the [document](https://dev.office.com/reference/add-ins/shared/office.context.document) property of the **Context** object to access the properties and methods of the **Document** object to interact with the content of Word documents, Excel worksheets, or Project schedules. Similarly, in Outlook add-ins, you can use the [mailbox](https://dev.office.com/reference/add-ins/outlook/Office.context.mailbox) property of the **Context** object to access the properties and methods of the **Mailbox** object to interact with the message, meeting request, or appointment content.</span></span>

<span data-ttu-id="06c26-p110">**Context** 对象还提供对 [contentLanguage](https://dev.office.com/reference/add-ins/shared/office.context.contentlanguage) 和 [displayLanguage](https://dev.office.com/reference/add-ins/shared/office.context.displaylanguage) 属性的访问权限，以便于确定文档或项中使用的或由主机应用使用的区域设置（语言）。另外，使用 [roamingSettings](https://dev.office.com/reference/add-ins/outlook/Office.context) 属性，还可以访问 [RoamingSettings](https://dev.office.com/reference/add-ins/outlook/RoamingSettings) 对象的成员。最后，**Context** 对象提供 [ui](https://dev.office.com/reference/add-ins/shared/officeui) 属性，以便于加载项启动弹出对话框。</span><span class="sxs-lookup"><span data-stu-id="06c26-p110">The **Context** object also provides access to the [contentLanguage](https://dev.office.com/reference/add-ins/shared/office.context.contentlanguage) and [displayLanguage](https://dev.office.com/reference/add-ins/shared/office.context.displaylanguage) properties that let you determine the locale (language) used in the document or item, or by the host application. And, the [roamingSettings](https://dev.office.com/reference/add-ins/outlook/Office.context) property that lets you access the members of the [RoamingSettings](https://dev.office.com/reference/add-ins/outlook/RoamingSettings) object. Finally, the **Context** object provides a [ui](https://dev.office.com/reference/add-ins/shared/officeui) property that enables your add-in to launch pop-up dialogs.</span></span>


## <a name="document-object"></a><span data-ttu-id="06c26-141">Document 对象</span><span class="sxs-lookup"><span data-stu-id="06c26-141">Document object</span></span>

<span data-ttu-id="06c26-142">**适用于：** 内容和任务窗格加载项类型</span><span class="sxs-lookup"><span data-stu-id="06c26-142">**Applies to:** Content and task pane add-in types</span></span>

<span data-ttu-id="06c26-p111">为了与 Excel、PowerPoint 和 Word 中的文档数据交互，API 提供 [Document](https://dev.office.com/reference/add-ins/shared/document) 对象。您可以使用 **Document** 对象成员通过以下方法访问数据：</span><span class="sxs-lookup"><span data-stu-id="06c26-p111">To interact with document data in Excel, PowerPoint, and Word, the API provides the [Document](https://dev.office.com/reference/add-ins/shared/document) object. You can use **Document** object members to access data from the following ways:</span></span>

- <span data-ttu-id="06c26-145">读取和写入文本形式、连续单元格（矩阵）或表格中的活动选区。</span><span class="sxs-lookup"><span data-stu-id="06c26-145">Read and write to active selections in the form of text, contiguous cells (matrices), or tables.</span></span>
    
- <span data-ttu-id="06c26-146">表格数据（矩阵或表格）。</span><span class="sxs-lookup"><span data-stu-id="06c26-146">Tabular data (matrices or tables).</span></span>
    
- <span data-ttu-id="06c26-147">绑定（通过 **Bindings** 对象的“add”方法创建）。</span><span class="sxs-lookup"><span data-stu-id="06c26-147">Bindings (created with the "add" methods of the  **Bindings** object).</span></span>
    
- <span data-ttu-id="06c26-148">自定义 XML 部件（仅适用于 Word）。</span><span class="sxs-lookup"><span data-stu-id="06c26-148">Custom XML parts (only for Word).</span></span>
    
- <span data-ttu-id="06c26-149">文档上按加载项保留的设置或加载项状态。</span><span class="sxs-lookup"><span data-stu-id="06c26-149">Settings or add-in state persisted per add-in on the document.</span></span>
    
<span data-ttu-id="06c26-p112">也可以使用 **Document** 对象与 Project 文档中的数据交互。特定于 Project 的 API 功能记录在成员 [ProjectDocument](https://dev.office.com/reference/add-ins/shared/projectdocument.projectdocument) 抽象类中。有关为 Project 创建任务窗格加载项的详细信息，请参阅[适用于 Project 的任务窗格加载项](../project/project-add-ins.md)。</span><span class="sxs-lookup"><span data-stu-id="06c26-p112">You can also use the  **Document** object to interact with data in Project documents. The Project-specific functionality of the API is documented in the members [ProjectDocument](https://dev.office.com/reference/add-ins/shared/projectdocument.projectdocument) abstract class. For more information about creating task pane add-ins for Project, see [Task pane add-ins for Project](../project/project-add-ins.md).</span></span>

<span data-ttu-id="06c26-153">所有这些形式的数据访问都起始于抽象 **Document** 对象的实例。</span><span class="sxs-lookup"><span data-stu-id="06c26-153">All these forms of data access start from an instance of the abstract  **Document** object.</span></span>

<span data-ttu-id="06c26-p113">可以在使用 **Context** 对象的 [document](https://dev.office.com/reference/add-ins/shared/office.context.document) 属性初始化任务窗格或内容加载项时访问 **Document** 对象的实例。**Document** 对象定义跨 Word 和 Excel 文档共享的通用数据访问函数，还提供对 Word 文档的 **CustomXmlParts** 对象的访问权限。</span><span class="sxs-lookup"><span data-stu-id="06c26-p113">You can access an instance of the  **Document** object when the task pane or content add-in is initialized by using the [document](https://dev.office.com/reference/add-ins/shared/office.context.document) property of the **Context** object. The **Document** object defines common data access functions shared across Word and Excel documents, and also provides access to the **CustomXmlParts** object for Word documents.</span></span>

<span data-ttu-id="06c26-156">**Document** 对象支持四种方式以供开发人员访问文档内容：</span><span class="sxs-lookup"><span data-stu-id="06c26-156">The  **Document** object supports four ways for developers to access document contents:</span></span>


- <span data-ttu-id="06c26-157">基于选区的访问</span><span class="sxs-lookup"><span data-stu-id="06c26-157">Selection-based access</span></span>
    
- <span data-ttu-id="06c26-158">基于绑定的访问</span><span class="sxs-lookup"><span data-stu-id="06c26-158">Binding-based access</span></span>
    
- <span data-ttu-id="06c26-159">基于自定义 XML 部件的访问（仅适用于 Word）</span><span class="sxs-lookup"><span data-stu-id="06c26-159">Custom XML part-based access (Word only)</span></span>
    
- <span data-ttu-id="06c26-160">基于整个文档的访问（仅适用于 PowerPoint 和 Word）</span><span class="sxs-lookup"><span data-stu-id="06c26-160">Entire document-based access (PowerPoint and Word only)</span></span>
    
<span data-ttu-id="06c26-161">为了帮助您理解基于选区和绑定的数据访问方法的工作方式，我们将首先解释数据访问 API 如何跨不同的 Office 应用程序提供一致的数据访问。</span><span class="sxs-lookup"><span data-stu-id="06c26-161">To help you understand how selection- and binding-based data access methods work, we will first explain how the data-access APIs provide consistent data access across different Office applications.</span></span>


### <a name="consistent-data-access-across-office-applications"></a><span data-ttu-id="06c26-162">跨 Office 应用程序的一致数据访问</span><span class="sxs-lookup"><span data-stu-id="06c26-162">Consistent data access across Office applications</span></span>

 <span data-ttu-id="06c26-163">**适用于：** 内容和任务窗格加载项类型</span><span class="sxs-lookup"><span data-stu-id="06c26-163">**Applies to:** Content and task pane add-in types</span></span>

<span data-ttu-id="06c26-164">为了创建跨不同 Office 文档无缝工作的扩展，适用于 Office 的 JavaScript API 通过通用数据类型和强制将不同文档内容划分为三种通用数据类型的功能抽象出每个 Office 应用程序的细节。</span><span class="sxs-lookup"><span data-stu-id="06c26-164">To create extensions that seamlessly work across different Office documents, the JavaScript API for Office abstracts away the particularities of each Office application through common data types and the ability to coerce different document contents into three common data types.</span></span>


#### <a name="common-data-types"></a><span data-ttu-id="06c26-165">通用数据类型</span><span class="sxs-lookup"><span data-stu-id="06c26-165">Common data types</span></span>

<span data-ttu-id="06c26-p114">在基于选区和基于绑定的数据访问中，文档内容通过跨所有受支持的 Office 应用程序通用的数据类型来公开。在 Office 2013 中，支持三种主要的数据类型：</span><span class="sxs-lookup"><span data-stu-id="06c26-p114">In both selection-based and binding-based data access, document contents are exposed through data types that are common across all the supported Office applications. In Office 2013, three main data types are supported:</span></span>



|<span data-ttu-id="06c26-168">**数据类型**</span><span class="sxs-lookup"><span data-stu-id="06c26-168">**Data type**</span></span>|<span data-ttu-id="06c26-169">**说明**</span><span class="sxs-lookup"><span data-stu-id="06c26-169">**Description**</span></span>|<span data-ttu-id="06c26-170">**主机应用程序支持**</span><span class="sxs-lookup"><span data-stu-id="06c26-170">**Host application support**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="06c26-171">文本</span><span class="sxs-lookup"><span data-stu-id="06c26-171">Text</span></span>|<span data-ttu-id="06c26-172">提供选定范围或绑定中数据的字符串表示形式。</span><span class="sxs-lookup"><span data-stu-id="06c26-172">Provides a string representation of the data in the selection or binding.</span></span>|<span data-ttu-id="06c26-p115">在 Excel 2013、Project 2013 和 PowerPoint 2013 中，仅支持纯文本。在 Word 2013 中，支持三种文本格式：纯文本、HTML 和 Office Open XML (OOXML)。如果选中的是 Excel 单元格中的文本，基于选定范围的方法会对单元格的全部内容执行读取和写入操作，即使仅选中了单元格中的部分文本，也不例外。如果选中的是 Word 和 PowerPoint 中的文本，基于选定范围的方法只会对选中的一系列字符执行读取和写入操作。Project 2013 和 PowerPoint 2013 仅支持基于选定范围的数据访问。</span><span class="sxs-lookup"><span data-stu-id="06c26-p115">In Excel 2013, Project 2013, and PowerPoint 2013, only plain text is supported. In Word 2013, three text formats are supported: plain text, HTML, and Office Open XML (OOXML). When text is selected in a cell in Excel, selection-based methods read and write to the entire contents of the cell, even if only a portion of the text is selected in the cell. When text is selected in Word and PowerPoint, selection-based methods read and write only to the run of characters that are selected. Project 2013 and PowerPoint 2013 support only selection-based data access.</span></span>|
|<span data-ttu-id="06c26-178">矩阵</span><span class="sxs-lookup"><span data-stu-id="06c26-178">Matrix</span></span>|<span data-ttu-id="06c26-p116">将选定范围或绑定中的数据作为二维 **Array** 提供，这在 JavaScript 中实现为一组数组。例如，两行两列 **string** 值为 ` [['a', 'b'], ['c', 'd']]`，而三行一列则为 `[['a'], ['b'], ['c']]`。</span><span class="sxs-lookup"><span data-stu-id="06c26-p116">Provides the data in the selection or binding as a two dimensional **Array**, which in JavaScript is implemented as an array of arrays. For example, two rows of **string** values in two columns would be ` [['a', 'b'], ['c', 'd']]`, and a single column of three rows would be `[['a'], ['b'], ['c']]`.</span></span>|<span data-ttu-id="06c26-181">仅 Excel 2013 和 Word 2013 支持矩阵数据访问。</span><span class="sxs-lookup"><span data-stu-id="06c26-181">Matrix data access is supported only in Excel 2013 and Word 2013.</span></span>|
|<span data-ttu-id="06c26-182">表格</span><span class="sxs-lookup"><span data-stu-id="06c26-182">Table</span></span>|<span data-ttu-id="06c26-p117">将选区或绑定中的数据作为 [TableData](https://dev.office.com/reference/add-ins/shared/tabledata) 对象提供。**TableData** 对象通过 **headers** 和 **rows** 属性公开数据。</span><span class="sxs-lookup"><span data-stu-id="06c26-p117">Provides the data in the selection or binding as a [TableData](https://dev.office.com/reference/add-ins/shared/tabledata) object. The **TableData** object exposes the data through the **headers** and **rows** properties.</span></span>|<span data-ttu-id="06c26-185">表格数据访问仅在 Excel 2013 和 Word 2013 中受支持。</span><span class="sxs-lookup"><span data-stu-id="06c26-185">Table data access is supported only in Excel 2013 and Word 2013.</span></span>|

#### <a name="data-type-coercion"></a><span data-ttu-id="06c26-186">数据类型强制转换</span><span class="sxs-lookup"><span data-stu-id="06c26-186">Data type coercion</span></span>

<span data-ttu-id="06c26-p118">适用于 **Document** 和 [Binding](https://dev.office.com/reference/add-ins/shared/binding) 对象的数据访问方法支持使用这些方法的 _coercionType_ 参数以及相应的 [CoercionType](https://dev.office.com/reference/add-ins/shared/coerciontype-enumeration) 枚举值，指定所需的数据类型。不管绑定的实际形状如何，不同的 Office 应用都支持常见数据类型，具体是通过尝试将数据强制转换为请求的数据类型。例如，如果选中了某个 Word 表格或段落，开发人员可以指定以纯文本、HTML、Office Open XML 或表格的形式读取它，而 API 实现则负责处理必要的转换和数据转换。</span><span class="sxs-lookup"><span data-stu-id="06c26-p118">The data access methods on the **Document** and [Binding](https://dev.office.com/reference/add-ins/shared/binding) objects support specifying the desired data type using the _coercionType_ parameter of these methods, and corresponding [CoercionType](https://dev.office.com/reference/add-ins/shared/coerciontype-enumeration) enumeration values. Regardless of the actual shape of the binding, the different Office applications support the common data types by trying to coerce the data into the requested data type. For example, if a Word table or paragraph is selected, the developer can specify to read it as plain text, HTML, Office Open XML, or a table, and the API implementation handles the necessary transformations and data conversions.</span></span>


> [!TIP]
> <span data-ttu-id="06c26-p119">**何时应使用矩阵与表格 coercionType 数据访问？** 如果需要表格数据在添加行和列时动态增长，且必须处理表格标题，应使用表格数据类型（具体操作是将 **Document** 或 **Binding** 对象数据访问方法的 _coercionType_ 参数指定为 `"table"` 或 **Office.CoercionType.Table**）。虽然表格数据和矩阵数据都支持在数据结构内添加行和列，但只有表格数据支持追加行和列。如果不打算添加行和列，且数据不需要使用标题功能，应使用矩阵数据类型（具体操作是将数据访问方法的 _coercionType_ 参数指定为 `"matrix"` 或 **Office.CoercionType.Matrix**），它提供了更简单的数据交互模型。</span><span class="sxs-lookup"><span data-stu-id="06c26-p119">**When should you use the matrix versus table coercionType for data access?** If you need your tabular data to grow dynamically when rows and columns are added, and you must work with table headers, you should use the table data type (by specifying the _coercionType_ parameter of a **Document** or **Binding** object data access method as `"table"` or **Office.CoercionType.Table**). Adding rows and columns within the data structure is supported in both table and matrix data, but appending rows and columns is supported only for table data. If you aren't planning on adding rows and columns, and your data doesn't require header functionality, then you should use the matrix data type (by specifying the  _coercionType_ parameter of the data access method as `"matrix"` or **Office.CoercionType.Matrix**), which provides a simpler model of interacting with the data.</span></span>

<span data-ttu-id="06c26-194">如果无法将数据强制转换为指定的类型，那么回调中的 [AsyncResult.status](https://dev.office.com/reference/add-ins/shared/asyncresult.error) 属性返回 `"failed"`，并且你可以使用 [AsyncResult.error](https://dev.office.com/reference/add-ins/shared/asyncresult.context) 属性访问 [Error](https://dev.office.com/reference/add-ins/shared/error) 对象，其中包括方法调用失败原因的信息。</span><span class="sxs-lookup"><span data-stu-id="06c26-194">If the data can't be coerced to the specified type, the [AsyncResult.status](https://dev.office.com/reference/add-ins/shared/asyncresult.error) property in the callback returns `"failed"`, and you can use the [AsyncResult.error](https://dev.office.com/reference/add-ins/shared/asyncresult.context) property to access an [Error](https://dev.office.com/reference/add-ins/shared/error) object with information about why the method call failed.</span></span>


## <a name="working-with-selections-using-the-document-object"></a><span data-ttu-id="06c26-195">使用 Document 对象处理选择内容</span><span class="sxs-lookup"><span data-stu-id="06c26-195">Working with selections using the Document object</span></span>


<span data-ttu-id="06c26-p120">**Document** 对象显示方法，使用户可以采用“获取和设置”方式读取和写入用户的当前选择内容。要执行此操作，**Document** 对象提供 **getSelectedDataAsync** 和 **setSelectedDataAsync** 方法。</span><span class="sxs-lookup"><span data-stu-id="06c26-p120">The  **Document** object exposes methods that let you to read and write to the user's current selection in a "get and set" fashion. To do that, the **Document** object provides the **getSelectedDataAsync** and **setSelectedDataAsync** methods.</span></span>

<span data-ttu-id="06c26-198">有关演示如何使用选区执行任务的代码示例，请参阅[在文档或电子表格的活动选区中读取和写入数据](read-and-write-data-to-the-active-selection-in-a-document-or-spreadsheet.md)。</span><span class="sxs-lookup"><span data-stu-id="06c26-198">For code examples that demonstrate how to perform tasks with selections, see [Read and write data to the active selection in a document or spreadsheet](read-and-write-data-to-the-active-selection-in-a-document-or-spreadsheet.md).</span></span>


## <a name="working-with-bindings-using-the-bindings-and-binding-objects"></a><span data-ttu-id="06c26-199">使用 Bindings 和 Binding 对象处理绑定</span><span class="sxs-lookup"><span data-stu-id="06c26-199">Working with bindings using the Bindings and Binding objects</span></span>


<span data-ttu-id="06c26-p121">基于绑定的数据访问使内容和任务窗格加载项能够通过与绑定相关联的标识符一致地访问文档或电子表格的特定区域。加载项首先需要通过调用将文档的某一部分与唯一标识符相关联的以下某个方法来建立绑定：[addFromPromptAsync](https://dev.office.com/reference/add-ins/shared/bindings.addfrompromptasync)、[addFromSelectionAsync](https://dev.office.com/reference/add-ins/shared/bindings.addfromselectionasync) 或 [addFromNamedItemAsync](https://dev.office.com/reference/add-ins/shared/bindings.addfromnameditemasync)。建立绑定后，加载项可以使用提供的标识符访问文档或电子表格的关联区域中包含的数据。创建绑定可为加载项提供以下值：</span><span class="sxs-lookup"><span data-stu-id="06c26-p121">Binding-based data access enables content and task pane add-ins to consistently access a particular region of a document or spreadsheet through an identifier associated with a binding. The add-in first needs to establish the binding by calling one of the methods that associates a portion of the document with a unique identifier: [addFromPromptAsync](https://dev.office.com/reference/add-ins/shared/bindings.addfrompromptasync), [addFromSelectionAsync](https://dev.office.com/reference/add-ins/shared/bindings.addfromselectionasync), or [addFromNamedItemAsync](https://dev.office.com/reference/add-ins/shared/bindings.addfromnameditemasync). After the binding is established, the add-in can use the provided identifier to access the data contained in the associated region of the document or spreadsheet. Creating bindings provides the following value to your add-in:</span></span>


- <span data-ttu-id="06c26-204">允许访问跨支持的 Office 应用程序的通用数据结构，例如：表、区域或文本（一系列连续字符）。</span><span class="sxs-lookup"><span data-stu-id="06c26-204">Permits access to common data structures across supported Office applications, such as: tables, ranges, or text (a contiguous run of characters).</span></span>
    
- <span data-ttu-id="06c26-205">允许读/写操作，而不需要用户做出选择。</span><span class="sxs-lookup"><span data-stu-id="06c26-205">Enables read/write operations without requiring the user to make a selection.</span></span>
    
- <span data-ttu-id="06c26-p122">在加载项和文档中的数据之间建立关系。绑定会保留在文档中，以后可以进行访问。</span><span class="sxs-lookup"><span data-stu-id="06c26-p122">Establishes a relationship between the add-in and the data in the document. Bindings are persisted in the document, and can be accessed at a later time.</span></span>
    
<span data-ttu-id="06c26-p123">建立绑定还允许您订阅仅限文档或电子表格的特定区域的数据和选择更改事件。这意味着，加载项只会收到绑定区域内发生的更改的通知，而不是收到整个文档或电子表格内的常规更改的通知。</span><span class="sxs-lookup"><span data-stu-id="06c26-p123">Establishing a binding also allows you to subscribe to data and selection change events that are scoped to that particular region of the document or spreadsheet. This means that the add-in is only notified of changes that happen within the bound region as opposed to general changes across the whole document or spreadsheet.</span></span>

<span data-ttu-id="06c26-p124">[Bindings](https://dev.office.com/reference/add-ins/shared/bindings.bindings) 对象公开 [getAllAsync](https://dev.office.com/reference/add-ins/shared/bindings.getallasync) 方法，通过该方法可以访问在文档或电子表格中建立的所有绑定的集合。可使用 [Bindings.getBindingByIdAsync](https://dev.office.com/reference/add-ins/shared/bindings.getbyidasync) 或 [Office.select](https://dev.office.com/reference/add-ins/shared/office.select) 方法按 ID 访问单个绑定。可使用 **Bindings** 对象的以下方法之一建立新绑定和删除现有绑定：[addFromSelectionAsync](https://dev.office.com/reference/add-ins/shared/bindings.addfromselectionasync)、[addFromPromptAsync](https://dev.office.com/reference/add-ins/shared/bindings.addfrompromptasync)、[addFromNamedItemAsync](https://dev.office.com/reference/add-ins/shared/bindings.addfromnameditemasync) 或 [releaseByIdAsync](https://dev.office.com/reference/add-ins/shared/bindings.releasebyidasync)。</span><span class="sxs-lookup"><span data-stu-id="06c26-p124">The [Bindings](https://dev.office.com/reference/add-ins/shared/bindings.bindings) object exposes a [getAllAsync](https://dev.office.com/reference/add-ins/shared/bindings.getallasync) method that gives access to the set of all bindings established on the document or spreadsheet. An individual binding can be accessed by its ID using either the [Bindings.getBindingByIdAsync](https://dev.office.com/reference/add-ins/shared/bindings.getbyidasync) or [Office.select](https://dev.office.com/reference/add-ins/shared/office.select) methods. You can establish new bindings as well as remove existing ones by using one of the following methods of the **Bindings** object: [addFromSelectionAsync](https://dev.office.com/reference/add-ins/shared/bindings.addfromselectionasync), [addFromPromptAsync](https://dev.office.com/reference/add-ins/shared/bindings.addfrompromptasync), [addFromNamedItemAsync](https://dev.office.com/reference/add-ins/shared/bindings.addfromnameditemasync), or [releaseByIdAsync](https://dev.office.com/reference/add-ins/shared/bindings.releasebyidasync).</span></span>

<span data-ttu-id="06c26-213">在使用  _addFromSelectionAsync_ 、 **addFromPromptAsync** 或 **addFromNamedItemAsync** 方法创建绑定时，可通过 **bindingType** 参数指定三种不同的绑定类型：</span><span class="sxs-lookup"><span data-stu-id="06c26-213">There are three different types of bindings that you specify with the  _bindingType_ parameter when you create a binding with the **addFromSelectionAsync**, **addFromPromptAsync** or **addFromNamedItemAsync** methods:</span></span>



|<span data-ttu-id="06c26-214">**绑定类型**</span><span class="sxs-lookup"><span data-stu-id="06c26-214">**Binding type**</span></span>|<span data-ttu-id="06c26-215">**说明**</span><span class="sxs-lookup"><span data-stu-id="06c26-215">**Description**</span></span>|<span data-ttu-id="06c26-216">**主机应用程序支持**</span><span class="sxs-lookup"><span data-stu-id="06c26-216">**Host application support**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="06c26-217">文本绑定</span><span class="sxs-lookup"><span data-stu-id="06c26-217">Text binding</span></span>|<span data-ttu-id="06c26-218">绑定到可以文本形式表示的文档区域。</span><span class="sxs-lookup"><span data-stu-id="06c26-218">Binds to a region of the document that can be represented as text.</span></span>|<span data-ttu-id="06c26-p125">在 Word 中，大多数连续选区都是有效的，而在 Excel 中，只有单个单元格选区才能作为文本绑定的目标。在 Excel 中，只支持纯文本。在 Word 中，支持以下三种格式：纯文本、HTML 和 Open XML for Office。</span><span class="sxs-lookup"><span data-stu-id="06c26-p125">In Word, most contiguous selections are valid, while in Excel only single cell selections can be the target of a text binding. In Excel, only plain text is supported. In Word, three formats are supported: plain text, HTML, and Open XML for Office.</span></span>|
|<span data-ttu-id="06c26-222">矩阵绑定</span><span class="sxs-lookup"><span data-stu-id="06c26-222">Matrix binding</span></span>|<span data-ttu-id="06c26-p126">绑定到包含表格数据（不带标题）的文档的固定区域。矩阵绑定中的数据以二维 **Array**（在 JavaScript 中实现为一组数组）的形式进行写入或读取。例如，两行两列 **string** 值可以写入或读取为 ` [['a', 'b'], ['c', 'd']]`，而三行单列则可以写入或读取为 `[['a'], ['b'], ['c']]`。</span><span class="sxs-lookup"><span data-stu-id="06c26-p126">Binds to a fixed region of a document that contains tabular data without headers. Data in a matrix binding is written or read as a two dimensional **Array**, which in JavaScript is implemented as an array of arrays. For example, two rows of **string** values in two columns can be written or read as ` [['a', 'b'], ['c', 'd']]`, and a single column of three rows can be written or read as `[['a'], ['b'], ['c']]`.</span></span>|<span data-ttu-id="06c26-p127">在 Excel 中，任何连续选择的单元格都可用于建立矩阵绑定。在 Word 中，只有表格支持矩阵绑定。</span><span class="sxs-lookup"><span data-stu-id="06c26-p127">In Excel, any contiguous selection of cells can be used to establish a matrix binding. In Word, only tables support matrix binding.</span></span>|
|<span data-ttu-id="06c26-228">表格绑定</span><span class="sxs-lookup"><span data-stu-id="06c26-228">Table binding</span></span>|<span data-ttu-id="06c26-p128">绑定到包含表格（带标题）的文档的区域。表格绑定中的数据以 [TableData](https://dev.office.com/reference/add-ins/shared/tabledata) 对象的形式进行写入或读取。**TableData** 对象通过 **headers** 和 **rows** 属性公开数据。</span><span class="sxs-lookup"><span data-stu-id="06c26-p128">Binds to a region of a document that contains a table with headers. Data in a table binding is written or read as a [TableData](https://dev.office.com/reference/add-ins/shared/tabledata) object. The **TableData** object exposes the data through the **headers** and **rows** properties.</span></span>|<span data-ttu-id="06c26-p129">任何 Excel 或 Word 表格均可作为表格绑定的基础。建立表格绑定后，用户添加到表格中的每个新行或新列都自动包含在绑定中。</span><span class="sxs-lookup"><span data-stu-id="06c26-p129">Any Excel or Word table can be the basis for a table binding. After you establish a table binding, each new row or column a user adds to the table is automatically included in the binding.</span></span> |

<br/>

<span data-ttu-id="06c26-p130">使用 **Bindings** 对象的三个“add”方法之一创建绑定后，可以通过相应对象的方法处理绑定的数据和属性：[MatrixBinding](https://dev.office.com/reference/add-ins/shared/binding.matrixbinding)、[TableBinding](https://dev.office.com/reference/add-ins/shared/binding.tablebinding) 或 [TextBinding](https://dev.office.com/reference/add-ins/shared/binding.textbinding)。这三个对象全部继承 [Binding](https://dev.office.com/reference/add-ins/shared/binding.getdataasync) 对象的 [getDataAsync](https://dev.office.com/reference/add-ins/shared/binding.setdataasync) 和 **setDataAsync** 方法，使你能够与绑定的数据交互。</span><span class="sxs-lookup"><span data-stu-id="06c26-p130">After a binding is created by using one of the three "add" methods of the  **Bindings** object, you can work with the binding's data and properties by using the methods of the corresponding object: [MatrixBinding](https://dev.office.com/reference/add-ins/shared/binding.matrixbinding), [TableBinding](https://dev.office.com/reference/add-ins/shared/binding.tablebinding), or [TextBinding](https://dev.office.com/reference/add-ins/shared/binding.textbinding). All three of these objects inherit the [getDataAsync](https://dev.office.com/reference/add-ins/shared/binding.getdataasync) and [setDataAsync](https://dev.office.com/reference/add-ins/shared/binding.setdataasync) methods of the **Binding** object that enable to you interact with the bound data.</span></span>

<span data-ttu-id="06c26-236">有关演示如何使用绑定执行任务的代码示例，请参阅[绑定到文档或电子表格中的区域](bind-to-regions-in-a-document-or-spreadsheet.md)。</span><span class="sxs-lookup"><span data-stu-id="06c26-236">For code examples that demonstrate how to perform tasks with bindings, see [Bind to regions in a document or spreadsheet](bind-to-regions-in-a-document-or-spreadsheet.md).</span></span>


## <a name="working-with-custom-xml-parts-using-the-customxmlparts-and-customxmlpart-objects"></a><span data-ttu-id="06c26-237">使用 CustomXmlParts 和 CustomXmlPart 对象处理自定义 XML 部件</span><span class="sxs-lookup"><span data-stu-id="06c26-237">Working with custom XML parts using the CustomXmlParts and CustomXmlPart objects</span></span>


 <span data-ttu-id="06c26-238">**适用于：** Word 的任务窗格加载项</span><span class="sxs-lookup"><span data-stu-id="06c26-238">**Applies to:** Task pane add-ins for Word</span></span>

<span data-ttu-id="06c26-p131">API 的 [CustomXmlParts](https://dev.office.com/reference/add-ins/shared/customxmlparts.customxmlparts) 和 [CustomXmlPart](https://dev.office.com/reference/add-ins/shared/customxmlpart.customxmlpart) 对象提供访问 Word 文档中自定义 XML 部件的权限，从而启用文档内容的 XML 驱动操作。有关使用 **CustomXmlParts** 和 **CustomXmlPart** 对象的演示，请参阅 [Word-Add-in-Work-with-custom-XML-parts](https://github.com/OfficeDev/Word-Add-in-Work-with-custom-XML-parts) 代码示例。</span><span class="sxs-lookup"><span data-stu-id="06c26-p131">The [CustomXmlParts](https://dev.office.com/reference/add-ins/shared/customxmlparts.customxmlparts) and [CustomXmlPart](https://dev.office.com/reference/add-ins/shared/customxmlpart.customxmlpart) objects of the API provide access to custom XML parts in Word documents, which enable XML-driven manipulation of the contents of the document. For demonstrations of working with the **CustomXmlParts** and **CustomXmlPart** objects, see the [Word-Add-in-Work-with-custom-XML-parts](https://github.com/OfficeDev/Word-Add-in-Work-with-custom-XML-parts) code sample.</span></span>


## <a name="working-with-the-entire-document-using-the-getfileasync-method"></a><span data-ttu-id="06c26-241">使用 getFileAsync 方法处理整个文档</span><span class="sxs-lookup"><span data-stu-id="06c26-241">Working with the entire document using the getFileAsync method</span></span>


 <span data-ttu-id="06c26-242">**适用于：** Word 和 PowerPoint 任务窗格加载项</span><span class="sxs-lookup"><span data-stu-id="06c26-242">**Applies to:** Task pane add-ins for Word and PowerPoint</span></span>

<span data-ttu-id="06c26-p132">[Document.getFileAsync](https://dev.office.com/reference/add-ins/shared/document.getfileasync) 方法以及 [File](https://dev.office.com/reference/add-ins/shared/file) 和 [Slice](https://dev.office.com/reference/add-ins/shared/slice) 对象的成员可用于一次性获取整个 Word 和 PowerPoint 文档文件，所有切片（区块）的总大小上限为 4MB。有关详细信息，请参阅[通过 PowerPoint 或 Word 加载项获取整个文档](../word/get-the-whole-document-from-an-add-in-for-word.md)。</span><span class="sxs-lookup"><span data-stu-id="06c26-p132">The [Document.getFileAsync](https://dev.office.com/reference/add-ins/shared/document.getfileasync) method and members of the [File](https://dev.office.com/reference/add-ins/shared/file) and [Slice](https://dev.office.com/reference/add-ins/shared/slice) objects to provide functionality for getting entire Word and PowerPoint document files in slices (chunks) of up to 4 MB at a time. For more information, see [Get the whole document from an add-in for PowerPoint or Word](../word/get-the-whole-document-from-an-add-in-for-word.md).</span></span>


## <a name="mailbox-object"></a><span data-ttu-id="06c26-245">Mailbox 对象</span><span class="sxs-lookup"><span data-stu-id="06c26-245">Mailbox object</span></span>


 <span data-ttu-id="06c26-246">**适用于：** Outlook 外接程序</span><span class="sxs-lookup"><span data-stu-id="06c26-246">**Applies to:** Outlook add-ins</span></span>

<span data-ttu-id="06c26-p133">Outlook 外接程序主要使用通过 [Mailbox](https://dev.office.com/reference/add-ins/outlook/Office.context.mailbox) 对象公开的 API 的子集。要访问专用于 Outlook 外接程序的对象和成员（例如 [Item](https://dev.office.com/reference/add-ins/outlook/Office.context.mailbox.item) 对象），可以使用 [Context](https://dev.office.com/reference/add-ins/outlook/Office.context.mailbox) 对象的 **mailbox** 属性访问 **Mailbox** 对象，如下面的代码行所示。</span><span class="sxs-lookup"><span data-stu-id="06c26-p133">Outlook add-ins primarily use a subset of the API exposed through the [Mailbox](https://dev.office.com/reference/add-ins/outlook/Office.context.mailbox) object. To access the objects and members specifically for use in Outlook add-ins, such as the [Item](https://dev.office.com/reference/add-ins/outlook/Office.context.mailbox.item) object, you use the [mailbox](https://dev.office.com/reference/add-ins/outlook/Office.context.mailbox) property of the **Context** object to access the **Mailbox** object, as shown in the following line of code.</span></span>




```js
// Access the Item object.
var item = Office.context.mailbox.item;

```

<span data-ttu-id="06c26-249">另外，Outlook 外接程序可以使用以下对象：</span><span class="sxs-lookup"><span data-stu-id="06c26-249">Additionally, Outlook add-ins can use the following objects:</span></span>


-  <span data-ttu-id="06c26-250">**Office** 对象：用于初始化。</span><span class="sxs-lookup"><span data-stu-id="06c26-250">**Office** object: for initialization.</span></span>
    
-  <span data-ttu-id="06c26-251">**Context** 对象：用于访问内容和显示语言属性。</span><span class="sxs-lookup"><span data-stu-id="06c26-251">**Context** object: for access to content and display language properties.</span></span>
    
-  <span data-ttu-id="06c26-252">**RoamingSettings** 对象：用于将 Outlook 加载项专用自定义设置保存到安装了加载项的用户邮箱。</span><span class="sxs-lookup"><span data-stu-id="06c26-252">**RoamingSettings** object: for saving Outlook add-in-specific custom settings to the user's mailbox where the add-in is installed.</span></span>
    
<span data-ttu-id="06c26-253">若要了解如何在 Outlook 加载项中使用 JavaScript，请参阅 [Outlook 加载项](https://docs.microsoft.com/en-us/outlook/add-ins/)。</span><span class="sxs-lookup"><span data-stu-id="06c26-253">For information about using JavaScript in Outlook add-ins, see [Outlook add-ins](https://docs.microsoft.com/en-us/outlook/add-ins/).</span></span>


## <a name="api-support-matrix"></a><span data-ttu-id="06c26-254">API 支持矩阵</span><span class="sxs-lookup"><span data-stu-id="06c26-254">API support matrix</span></span>


<span data-ttu-id="06c26-255">下表总结了各种类型的加载项（内容、任务窗格和 Outlook）支持的 API 和功能，以及使用[适用于 Office 的 JavaScript API v1.1 支持的 1.1 加载项清单架构和功能](update-your-javascript-api-for-office-and-manifest-schema-version.md)指定加载项支持的 Office 主机应用时，可以托管它们的 Office 应用。</span><span class="sxs-lookup"><span data-stu-id="06c26-255">This table summarizes the API and features supported across add-in types (content, task pane, and Outlook) and the Office applications that can host them when you specify the Office host applications your add-in supports by using the [1.1 add-in manifest schema and features supported by v1.1 JavaScript API for Office](update-your-javascript-api-for-office-and-manifest-schema-version.md).</span></span>


|||||||||
|:-----|:-----|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|
||<span data-ttu-id="06c26-256">**主机名**</span><span class="sxs-lookup"><span data-stu-id="06c26-256">**Host name**</span></span>|<span data-ttu-id="06c26-257">数据库</span><span class="sxs-lookup"><span data-stu-id="06c26-257">Database</span></span>|<span data-ttu-id="06c26-258">工作簿</span><span class="sxs-lookup"><span data-stu-id="06c26-258">Workbook</span></span>|<span data-ttu-id="06c26-259">邮箱</span><span class="sxs-lookup"><span data-stu-id="06c26-259">Mailbox</span></span>|<span data-ttu-id="06c26-260">演示文稿</span><span class="sxs-lookup"><span data-stu-id="06c26-260">Presentation</span></span>|<span data-ttu-id="06c26-261">文档</span><span class="sxs-lookup"><span data-stu-id="06c26-261">Document</span></span>|<span data-ttu-id="06c26-262">项目</span><span class="sxs-lookup"><span data-stu-id="06c26-262">Project</span></span>|
||<span data-ttu-id="06c26-263">**支持的****主机应用程序**</span><span class="sxs-lookup"><span data-stu-id="06c26-263">**Supported** **Host applications**</span></span>|<span data-ttu-id="06c26-264">Access Web App</span><span class="sxs-lookup"><span data-stu-id="06c26-264">Access web apps</span></span>|<span data-ttu-id="06c26-265">Excel、</span><span class="sxs-lookup"><span data-stu-id="06c26-265">Excel,</span></span><br/><span data-ttu-id="06c26-266">Excel 在线</span><span class="sxs-lookup"><span data-stu-id="06c26-266">Excel Online</span></span>|<span data-ttu-id="06c26-267">Outlook、</span><span class="sxs-lookup"><span data-stu-id="06c26-267">Outlook,</span></span><br/><span data-ttu-id="06c26-268">Outlook Web App、</span><span class="sxs-lookup"><span data-stu-id="06c26-268">Outlook Web App,</span></span><br/><span data-ttu-id="06c26-269">适用于设备的 OWA</span><span class="sxs-lookup"><span data-stu-id="06c26-269">OWA for Devices</span></span>|<span data-ttu-id="06c26-270">PowerPoint、</span><span class="sxs-lookup"><span data-stu-id="06c26-270">PowerPoint,</span></span><br/><span data-ttu-id="06c26-271">PowerPoint 联机</span><span class="sxs-lookup"><span data-stu-id="06c26-271">PowerPoint Online</span></span>|<span data-ttu-id="06c26-272">Word</span><span class="sxs-lookup"><span data-stu-id="06c26-272">Word</span></span>|<span data-ttu-id="06c26-273">项目</span><span class="sxs-lookup"><span data-stu-id="06c26-273">Project</span></span>|
|<span data-ttu-id="06c26-274">**支持的外接程序类型**</span><span class="sxs-lookup"><span data-stu-id="06c26-274">**Supported add-in types**</span></span>|<span data-ttu-id="06c26-275">内容</span><span class="sxs-lookup"><span data-stu-id="06c26-275">Content</span></span>|<span data-ttu-id="06c26-276">是</span><span class="sxs-lookup"><span data-stu-id="06c26-276">Y</span></span>|<span data-ttu-id="06c26-277">是</span><span class="sxs-lookup"><span data-stu-id="06c26-277">Y</span></span>||<span data-ttu-id="06c26-278">是</span><span class="sxs-lookup"><span data-stu-id="06c26-278">Y</span></span>|||
||<span data-ttu-id="06c26-279">任务窗格</span><span class="sxs-lookup"><span data-stu-id="06c26-279">Task pane</span></span>||<span data-ttu-id="06c26-280">是</span><span class="sxs-lookup"><span data-stu-id="06c26-280">Y</span></span>||<span data-ttu-id="06c26-281">是</span><span class="sxs-lookup"><span data-stu-id="06c26-281">Y</span></span>|<span data-ttu-id="06c26-282">是</span><span class="sxs-lookup"><span data-stu-id="06c26-282">Y</span></span>|<span data-ttu-id="06c26-283">是</span><span class="sxs-lookup"><span data-stu-id="06c26-283">Y</span></span>|
||<span data-ttu-id="06c26-284">Outlook</span><span class="sxs-lookup"><span data-stu-id="06c26-284">Outlook</span></span>|||<span data-ttu-id="06c26-285">是</span><span class="sxs-lookup"><span data-stu-id="06c26-285">Y</span></span>||||
|<span data-ttu-id="06c26-286">**支持的 API 功能**</span><span class="sxs-lookup"><span data-stu-id="06c26-286">**Supported API features**</span></span>|<span data-ttu-id="06c26-287">读/写文本</span><span class="sxs-lookup"><span data-stu-id="06c26-287">Read/Write Text</span></span>||<span data-ttu-id="06c26-288">是</span><span class="sxs-lookup"><span data-stu-id="06c26-288">Y</span></span>||<span data-ttu-id="06c26-289">是</span><span class="sxs-lookup"><span data-stu-id="06c26-289">Y</span></span>|<span data-ttu-id="06c26-290">是</span><span class="sxs-lookup"><span data-stu-id="06c26-290">Y</span></span>|<span data-ttu-id="06c26-291">是</span><span class="sxs-lookup"><span data-stu-id="06c26-291">Y</span></span><br/><span data-ttu-id="06c26-292">（只读）</span><span class="sxs-lookup"><span data-stu-id="06c26-292">(Read only)</span></span>|
||<span data-ttu-id="06c26-293">读/写矩阵</span><span class="sxs-lookup"><span data-stu-id="06c26-293">Read/Write Matrix</span></span>||<span data-ttu-id="06c26-294">是</span><span class="sxs-lookup"><span data-stu-id="06c26-294">Y</span></span>|||<span data-ttu-id="06c26-295">是</span><span class="sxs-lookup"><span data-stu-id="06c26-295">Y</span></span>||
||<span data-ttu-id="06c26-296">读/写表</span><span class="sxs-lookup"><span data-stu-id="06c26-296">Read/Write Table</span></span>||<span data-ttu-id="06c26-297">是</span><span class="sxs-lookup"><span data-stu-id="06c26-297">Y</span></span>|||<span data-ttu-id="06c26-298">是</span><span class="sxs-lookup"><span data-stu-id="06c26-298">Y</span></span>||
||<span data-ttu-id="06c26-299">读/写 HTML</span><span class="sxs-lookup"><span data-stu-id="06c26-299">Read/Write HTML</span></span>|||||<span data-ttu-id="06c26-300">是</span><span class="sxs-lookup"><span data-stu-id="06c26-300">Y</span></span>||
||<span data-ttu-id="06c26-301">读/写</span><span class="sxs-lookup"><span data-stu-id="06c26-301">Read/Write</span></span><br/><span data-ttu-id="06c26-302">Office Open XML</span><span class="sxs-lookup"><span data-stu-id="06c26-302">Office Open XML</span></span>|||||<span data-ttu-id="06c26-303">是</span><span class="sxs-lookup"><span data-stu-id="06c26-303">Y</span></span>||
||<span data-ttu-id="06c26-304">读取任务、资源、视图和字段属性</span><span class="sxs-lookup"><span data-stu-id="06c26-304">Read task, resource, view, and field properties</span></span>||||||<span data-ttu-id="06c26-305">是</span><span class="sxs-lookup"><span data-stu-id="06c26-305">Y</span></span>|
||<span data-ttu-id="06c26-306">选择已更改事件</span><span class="sxs-lookup"><span data-stu-id="06c26-306">Selection changed events</span></span>||<span data-ttu-id="06c26-307">是</span><span class="sxs-lookup"><span data-stu-id="06c26-307">Y</span></span>|||<span data-ttu-id="06c26-308">是</span><span class="sxs-lookup"><span data-stu-id="06c26-308">Y</span></span>||
||<span data-ttu-id="06c26-309">获取整个文档</span><span class="sxs-lookup"><span data-stu-id="06c26-309">Get whole document</span></span>||||<span data-ttu-id="06c26-310">是</span><span class="sxs-lookup"><span data-stu-id="06c26-310">Y</span></span>|<span data-ttu-id="06c26-311">是</span><span class="sxs-lookup"><span data-stu-id="06c26-311">Y</span></span>||
||<span data-ttu-id="06c26-312">绑定和绑定事件</span><span class="sxs-lookup"><span data-stu-id="06c26-312">Bindings and binding events</span></span>|<span data-ttu-id="06c26-313">是</span><span class="sxs-lookup"><span data-stu-id="06c26-313">Y</span></span><br/><span data-ttu-id="06c26-314">（仅限完全和部分表格绑定）</span><span class="sxs-lookup"><span data-stu-id="06c26-314">(Only full and partial table bindings)</span></span>|<span data-ttu-id="06c26-315">是</span><span class="sxs-lookup"><span data-stu-id="06c26-315">Y</span></span>|||<span data-ttu-id="06c26-316">是</span><span class="sxs-lookup"><span data-stu-id="06c26-316">Y</span></span>||
||<span data-ttu-id="06c26-317">读/写自定义 XML 部分</span><span class="sxs-lookup"><span data-stu-id="06c26-317">Read/Write Custom XML Parts</span></span>|||||<span data-ttu-id="06c26-318">是</span><span class="sxs-lookup"><span data-stu-id="06c26-318">Y</span></span>||
||<span data-ttu-id="06c26-319">暂留加载项状态数据（设置）</span><span class="sxs-lookup"><span data-stu-id="06c26-319">Persist add-in state data (settings)</span></span>|<span data-ttu-id="06c26-320">是</span><span class="sxs-lookup"><span data-stu-id="06c26-320">Y</span></span><br/><span data-ttu-id="06c26-321">（每主机加载项）</span><span class="sxs-lookup"><span data-stu-id="06c26-321">(Per host add-in)</span></span>|<span data-ttu-id="06c26-322">是</span><span class="sxs-lookup"><span data-stu-id="06c26-322">Y</span></span><br/><span data-ttu-id="06c26-323">（每文档）</span><span class="sxs-lookup"><span data-stu-id="06c26-323">(Per document)</span></span>|<span data-ttu-id="06c26-324">是</span><span class="sxs-lookup"><span data-stu-id="06c26-324">Y</span></span><br/><span data-ttu-id="06c26-325">（每邮箱）</span><span class="sxs-lookup"><span data-stu-id="06c26-325">(Per mailbox)</span></span>|<span data-ttu-id="06c26-326">是</span><span class="sxs-lookup"><span data-stu-id="06c26-326">Y</span></span><br/><span data-ttu-id="06c26-327">（每文档）</span><span class="sxs-lookup"><span data-stu-id="06c26-327">(Per document)</span></span>|<span data-ttu-id="06c26-328">是</span><span class="sxs-lookup"><span data-stu-id="06c26-328">Y</span></span><br/><span data-ttu-id="06c26-329">（每文档）</span><span class="sxs-lookup"><span data-stu-id="06c26-329">(Per document)</span></span>||
||<span data-ttu-id="06c26-330">设置更改事件</span><span class="sxs-lookup"><span data-stu-id="06c26-330">Settings changed events</span></span>|<span data-ttu-id="06c26-331">是</span><span class="sxs-lookup"><span data-stu-id="06c26-331">Y</span></span>|<span data-ttu-id="06c26-332">是</span><span class="sxs-lookup"><span data-stu-id="06c26-332">Y</span></span>||<span data-ttu-id="06c26-333">是</span><span class="sxs-lookup"><span data-stu-id="06c26-333">Y</span></span>|<span data-ttu-id="06c26-334">是</span><span class="sxs-lookup"><span data-stu-id="06c26-334">Y</span></span>||
||<span data-ttu-id="06c26-335">获取活动视图模式</span><span class="sxs-lookup"><span data-stu-id="06c26-335">Get active view mode</span></span><br/><span data-ttu-id="06c26-336">和视图更改事件</span><span class="sxs-lookup"><span data-stu-id="06c26-336">and view changed events</span></span>||||<span data-ttu-id="06c26-337">是</span><span class="sxs-lookup"><span data-stu-id="06c26-337">Y</span></span>|||
||<span data-ttu-id="06c26-338">转到文档中</span><span class="sxs-lookup"><span data-stu-id="06c26-338">Navigate to locations</span></span><br/><span data-ttu-id="06c26-339">的相应位置</span><span class="sxs-lookup"><span data-stu-id="06c26-339">in the document</span></span>||<span data-ttu-id="06c26-340">是</span><span class="sxs-lookup"><span data-stu-id="06c26-340">Y</span></span>||<span data-ttu-id="06c26-341">是</span><span class="sxs-lookup"><span data-stu-id="06c26-341">Y</span></span>|<span data-ttu-id="06c26-342">是</span><span class="sxs-lookup"><span data-stu-id="06c26-342">Y</span></span>||
||<span data-ttu-id="06c26-343">使用规则和 RegEx</span><span class="sxs-lookup"><span data-stu-id="06c26-343">Activate contextually</span></span><br/><span data-ttu-id="06c26-344">执行上下文式激活</span><span class="sxs-lookup"><span data-stu-id="06c26-344">using rules and RegEx</span></span>|||<span data-ttu-id="06c26-345">是</span><span class="sxs-lookup"><span data-stu-id="06c26-345">Y</span></span>||||
||<span data-ttu-id="06c26-346">读取项目属性</span><span class="sxs-lookup"><span data-stu-id="06c26-346">Read Item properties</span></span>|||<span data-ttu-id="06c26-347">是</span><span class="sxs-lookup"><span data-stu-id="06c26-347">Y</span></span>||||
||<span data-ttu-id="06c26-348">读取用户配置文件</span><span class="sxs-lookup"><span data-stu-id="06c26-348">Read User profile</span></span>|||<span data-ttu-id="06c26-349">是</span><span class="sxs-lookup"><span data-stu-id="06c26-349">Y</span></span>||||
||<span data-ttu-id="06c26-350">获取附件</span><span class="sxs-lookup"><span data-stu-id="06c26-350">Get attachments</span></span>|||<span data-ttu-id="06c26-351">是</span><span class="sxs-lookup"><span data-stu-id="06c26-351">Y</span></span>||||
||<span data-ttu-id="06c26-352">获取用户标识令牌</span><span class="sxs-lookup"><span data-stu-id="06c26-352">Get User identity token</span></span>|||<span data-ttu-id="06c26-353">是</span><span class="sxs-lookup"><span data-stu-id="06c26-353">Y</span></span>||||
||<span data-ttu-id="06c26-354">调用 Exchange Web 服务</span><span class="sxs-lookup"><span data-stu-id="06c26-354">Call Exchange Web Services</span></span>|||<span data-ttu-id="06c26-355">是</span><span class="sxs-lookup"><span data-stu-id="06c26-355">Y</span></span>||||
