---
title: 自定义函数要求集
description: 有关 Excel JavaScript API 的自定义函数要求集的详细信息。
ms.date: 09/14/2020
ms.prod: excel
localization_priority: Normal
ms.openlocfilehash: 0860dd2d1b55376a85eadf04898d288d83b0205d
ms.sourcegitcommit: ed2a98b6fb5b432fa99c6cefa5ce52965dc25759
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/16/2020
ms.locfileid: "47819523"
---
# <a name="custom-functions-requirement-sets"></a><span data-ttu-id="13791-103">自定义函数要求集</span><span class="sxs-lookup"><span data-stu-id="13791-103">Custom Functions requirement sets</span></span>

<span data-ttu-id="13791-104">[自定义函数](custom-functions-overview.md)使用独立于核心 Excel JavaScript API 的要求集。</span><span class="sxs-lookup"><span data-stu-id="13791-104">[Custom Functions](custom-functions-overview.md) use separate requirement sets from the core Excel JavaScript APIs.</span></span> <span data-ttu-id="13791-105">下表列出了自定义函数要求集、受支持的 Office 客户端应用程序，以及这些应用程序的内部版本或编号。</span><span class="sxs-lookup"><span data-stu-id="13791-105">The following table lists the Custom Functions requirement sets, the supported Office client applications, and the build versions or number for those applications.</span></span>

|  <span data-ttu-id="13791-106">要求集</span><span class="sxs-lookup"><span data-stu-id="13791-106">Requirement set</span></span>  |  <span data-ttu-id="13791-107">Windows 版 Office</span><span class="sxs-lookup"><span data-stu-id="13791-107">Office on Windows</span></span><br><span data-ttu-id="13791-108">（关联至 Microsoft 365 订阅）</span><span class="sxs-lookup"><span data-stu-id="13791-108">(connected to a Microsoft 365 subscription)</span></span>  |  <span data-ttu-id="13791-109">iPad 版 Office</span><span class="sxs-lookup"><span data-stu-id="13791-109">Office on iPad</span></span><br><span data-ttu-id="13791-110">（关联至 Microsoft 365 订阅）</span><span class="sxs-lookup"><span data-stu-id="13791-110">(connected to a Microsoft 365 subscription)</span></span>  |  <span data-ttu-id="13791-111">Mac 版 Office</span><span class="sxs-lookup"><span data-stu-id="13791-111">Office on Mac</span></span><br><span data-ttu-id="13791-112">（关联至 Microsoft 365 订阅）</span><span class="sxs-lookup"><span data-stu-id="13791-112">(connected to a Microsoft 365 subscription)</span></span>  | <span data-ttu-id="13791-113">Office 网页版</span><span class="sxs-lookup"><span data-stu-id="13791-113">Office on the web</span></span> |
|:-----|-----|:-----|:-----|:-----|:-----|
| <span data-ttu-id="13791-114">CustomFunctionsRuntime 1。3</span><span class="sxs-lookup"><span data-stu-id="13791-114">CustomFunctionsRuntime 1.3</span></span> | <span data-ttu-id="13791-115">16.0.13127.20296 或更高版本</span><span class="sxs-lookup"><span data-stu-id="13791-115">16.0.13127.20296 or later</span></span> | <span data-ttu-id="13791-116">不支持</span><span class="sxs-lookup"><span data-stu-id="13791-116">Not supported</span></span> | <span data-ttu-id="13791-117">16.40.20081000 或更高版本</span><span class="sxs-lookup"><span data-stu-id="13791-117">16.40.20081000 or later</span></span> | <span data-ttu-id="13791-118">2020 年 7 月</span><span class="sxs-lookup"><span data-stu-id="13791-118">July 2020</span></span> |
| <span data-ttu-id="13791-119">CustomFunctionsRuntime 1。2</span><span class="sxs-lookup"><span data-stu-id="13791-119">CustomFunctionsRuntime 1.2</span></span> | <span data-ttu-id="13791-120">16.0.12527.20194 或更高版本</span><span class="sxs-lookup"><span data-stu-id="13791-120">16.0.12527.20194 or later</span></span> | <span data-ttu-id="13791-121">不支持</span><span class="sxs-lookup"><span data-stu-id="13791-121">Not supported</span></span> | <span data-ttu-id="13791-122">16.34.20020900 或更高版本</span><span class="sxs-lookup"><span data-stu-id="13791-122">16.34.20020900 or later</span></span> | <span data-ttu-id="13791-123">2020 年 1 月</span><span class="sxs-lookup"><span data-stu-id="13791-123">January 2020</span></span> |
| <span data-ttu-id="13791-124">CustomFunctionsRuntime 1.1</span><span class="sxs-lookup"><span data-stu-id="13791-124">CustomFunctionsRuntime 1.1</span></span> | <span data-ttu-id="13791-125">16.0.12527.20092 或更高版本</span><span class="sxs-lookup"><span data-stu-id="13791-125">16.0.12527.20092 or later</span></span> | <span data-ttu-id="13791-126">不支持</span><span class="sxs-lookup"><span data-stu-id="13791-126">Not supported</span></span> | <span data-ttu-id="13791-127">16.34 或更高版本</span><span class="sxs-lookup"><span data-stu-id="13791-127">16.34 or later</span></span> | <span data-ttu-id="13791-128">2019 年 5 月</span><span class="sxs-lookup"><span data-stu-id="13791-128">May 2019</span></span> |

> [!NOTE]
> <span data-ttu-id="13791-129">Office 2019 或更早版本 (一次性购买) 不支持 Excel 自定义函数。</span><span class="sxs-lookup"><span data-stu-id="13791-129">Excel custom functions are not supported on Office 2019 or earlier (one-time purchase).</span></span>

## <a name="customfunctionsruntime-11-12-and-13"></a><span data-ttu-id="13791-130">CustomFunctionsRuntime 1.1、1.2 和1。3</span><span class="sxs-lookup"><span data-stu-id="13791-130">CustomFunctionsRuntime 1.1, 1.2, and 1.3</span></span>

<span data-ttu-id="13791-131">CustomFunctionsRuntime 1.1 是 API 的第一个版本。</span><span class="sxs-lookup"><span data-stu-id="13791-131">The CustomFunctionsRuntime 1.1 is the first version of the API.</span></span> <span data-ttu-id="13791-132">要求集1.2 添加了 `CustomFunctions.Error` 支持错误处理的对象。</span><span class="sxs-lookup"><span data-stu-id="13791-132">Requirement set 1.2 adds the `CustomFunctions.Error` object to support error handling.</span></span> <span data-ttu-id="13791-133">要求集1.3 将 [XLL 流](make-custom-functions-compatible-with-xll-udf.md#custom-function-behavior-for-xll-compatible-functions) 支持和新 `ErrorCode` 选项添加到 [customfunctions.js](/javascript/api/custom-functions-runtime/customfunctions.error) 对象。</span><span class="sxs-lookup"><span data-stu-id="13791-133">Requirement set 1.3 adds [XLL streaming](make-custom-functions-compatible-with-xll-udf.md#custom-function-behavior-for-xll-compatible-functions) support and new `ErrorCode` options to the [CustomFunctions.Error](/javascript/api/custom-functions-runtime/customfunctions.error) object.</span></span> 

## <a name="see-also"></a><span data-ttu-id="13791-134">另请参阅</span><span class="sxs-lookup"><span data-stu-id="13791-134">See also</span></span>

- [<span data-ttu-id="13791-135">自定义函数参考文档</span><span class="sxs-lookup"><span data-stu-id="13791-135">Custom Functions Reference Documentation</span></span>](/javascript/api/custom-functions-runtime)
- [<span data-ttu-id="13791-136">Excel JavaScript API 要求集</span><span class="sxs-lookup"><span data-stu-id="13791-136">Excel JavaScript API requirement sets</span></span>](../reference/requirement-sets/excel-api-requirement-sets.md)
