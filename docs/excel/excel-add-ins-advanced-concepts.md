---
title: Excel JavaScript API ????
description: ''
ms.date: 1/18/2018
ms.openlocfilehash: 89db69e124475c882448a2105837787ce2c84753
ms.sourcegitcommit: c72c35e8389c47a795afbac1b2bcf98c8e216d82
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/23/2018
---
# <a name="excel-javascript-api-advanced-concepts"></a>Excel JavaScript API ????

???? [Excel JavaScript API ????](excel-add-ins-core-concepts.md)????????????? Excel 2016 ??????????????????? 

## <a name="officejs-apis-for-excel"></a>??? Excel ? Office.js API

Excel ?????????? Office ? JavaScript API ? Excel ???????????? Office ? JavaScript API???? JavaScript ?????

* **Excel JavaScript API**?[Excel JavaScript API](https://dev.office.com/reference/add-ins/excel/excel-add-ins-reference-overview) ? Office 2016 ?????????????????????????????????? 

* **?? API**??? API????[?? API](https://dev.office.com/reference/add-ins/javascript-api-for-office)?? Office 2013 ???????????? Word?Excel ? PowerPoint ???????????? UI??????????????

???????? Excel JavaScript API ?????? Excel 2016 ??????????????????? API ????????

- [Context](https://dev.office.com/reference/add-ins/shared/context)?**Context** ?????????????????? API ?????????? ????????????? `contentLanguage` ? `officeTheme`???????????????????? `host` ? `platform`????? ???????? `requirements.isSetSupported()` ?????????????? Excel ??????????????? 

- [Document](https://dev.office.com/reference/add-ins/shared/document)?**Document** ???? `getFileAsync()` ????????????? Excel ??? 

## <a name="requirement-sets"></a>???

??????????? API ??? Office ?????????????????????????? Office ???????????? API? ??????????????????????? [Excel JavaScript API ???](https://dev.office.com/reference/add-ins/requirement-sets/excel-api-requirement-sets)?

### <a name="checking-for-requirement-set-support-at-runtime"></a>???????????

??????????????????????????????? API ????

```js
if (Office.context.requirements.isSetSupported('ExcelApi', 1.3) === true) {
  /// perform actions
}
else {
  /// provide alternate flow/logic
}
```

### <a name="defining-requirement-set-support-in-the-manifest"></a>???????????

???????????[????](https://dev.office.com/reference/add-ins/manifest/requirements)????????????????/? API ??? ?? Office ??????????? **Requirements** ?????????? API ??????????????????????????????????****??????????? 

??????????????? **Requirements** ???????????? ExcelApi ????? 1.3 ???????? Office ??????????????

```xml
<Requirements>
   <Sets DefaultMinVersion="1.3">
      <Set Name="ExcelApi" MinVersion="1.3"/>
   </Sets>
</Requirements>
```

> [!NOTE]
> ????????? Office ????????? Excel for Windows?Excel Online ? Excel for iPad?????????????????????????????????

### <a name="requirement-sets-for-the-officejs-common-api"></a>Office.js ?? API ????

???? API ?????????? [Office ?? API ???](https://dev.office.com/reference/add-ins/requirement-sets/office-add-in-requirement-sets)?

## <a name="loading-the-properties-of-an-object"></a>???????

? Excel JavaScript ????? `load()` ???? API ? `sync()` ??????????? JavaScript ???? ???????????????????????????????????????????????`load()` 

> [!NOTE]
> ???????????? `load()` ??????????????????????????????????????????? ???? Excel ????????????????????????????????????????? `load()` ???

### <a name="method-details"></a>??????

#### <a name="loadparam-object"></a>load(param: object)

????????????????? JavaScript ??????????

#### <a name="syntax"></a>??

```js
object.load(param);
```

#### <a name="parameters"></a>??

|**??**|**??**|**??**|
|:------------|:-------|:----------|
|`param`|object|??? ??????????????????????? ????????????????????????????|

#### <a name="returns"></a>??

void

#### <a name="example"></a>??

??????????????????????? Excel ?????? ?????????????????????????????????? ????????????**B2:E2** ? **B7:E7**????????????????????

```js
Excel.run(function (ctx) { 
    var sheet = ctx.workbook.worksheets.getItem("Sample");
    var sourceRange = sheet.getRange("B2:E2");
    sourceRange.load("format/fill/color, format/font/name, format/font/color");

    return ctx.sync()
        .then(function () {
            var targetRange = sheet.getRange("B7:E7");
            targetRange.set(sourceRange); 
            targetRange.format.autofitColumns();

            return ctx.sync();
        });
}).catch(function(error) {
    console.log("Error: " + error);
    if (error instanceof OfficeExtension.Error) {
        console.log("Debug info: " + JSON.stringify(error.debugInfo));
    }
});
```

### <a name="load-option-properties"></a>??????

???? `load()` ?????????????????????????????????????? 

|**??**|**??**|**??**|
|:-----------|:-------|:----------|
|`select`|object|????/??????????????????|
|`expand`|object|????????????????????|
|`top`|int| ????????????????????????????????????????|
|`skip`|int|?????????????????????????? `top`?????????????????????????????????????????|

????????????????????????? `name` ??? `address` ????????? ??????????????????? ????? `top: 10` ? `skip: 5` ?????????????????? 

```js 
myWorksheets.load({
    select: 'name, userRange/address',
    expand: 'tables',
    top: 5,
    skip: 0
});
```

## <a name="scalar-and-navigation-properties"></a>??????? 

? Excel JavaScript API ???????????????????????**??**?**??**? ????????????????????????????????????????????????/??????? ???[Worksheet](https://dev.office.com/reference/add-ins/excel/worksheet) ???? `name` ? `position` ????????? `protection` ? `tables` ?????????? 

### <a name="scalar-properties-and-navigation-properties-with-objectload"></a>?? `object.load()` ?????????? `object.load()`

????????? `object.load()` ??????????????????????????? ?????????????? ?????? `load()` ??????????????????? ???????????????????? **format** ? **font** ?????? **name** ??????

```js
someRange.load("format/font/name")
```

> [!NOTE]
> ?? Excel JavaScript API?????????????????????? ??????? `someRange.format.font.size = 10;` ?????????? ??????????????? 

## <a name="setting-properties-of-an-object"></a>???????

??????????????????????? ???????????????????????????? Excel JavaScript API ????????? `object.set()` ??? ?????????????? Office.js ????????? JavaScript ???????????????????????????????????

> [!NOTE]
> ???????? Office JavaScript API?? Excel JavaScript API????????`set()` ??????API ??????? 

### <a name="set-properties-object-options-object"></a>set (properties: object, options: object)

??????????????????????????????????? `properties` ??? JavaScript ???????????????????????????????????????????????????? `options` ?????

#### <a name="syntax"></a>??

```js
object.set(properties[, options]);
```

#### <a name="parameters"></a>??

|**??**|**??**|**??**|
|:------------|:--------|:----------|
|`properties`|object|?????????????? Office.js ????????????????????????????? JavaScript ???|
|`options`|object|??????????? JavaScript ??????????????????`throwOnReadOnly?: boolean`????? `true`?????? JavaScript ????????????????|

#### <a name="returns"></a>??

void    

#### <a name="example"></a>??

?????????????????????????? `set()` ?????? JavaScript ?????????? **Range** ??????????????????????? **B2:E2** ?????

```js
Excel.run(function (ctx) { 
    var sheet = ctx.workbook.worksheets.getItem("Sample");
    var range = sheet.getRange("B2:E2");
    range.set({
        format: {
            fill: {
                color: '#4472C4'
            },
            font: {
                name: 'Verdana',
                color: 'white'
            }
        }
    });
    range.format.autofitColumns();

    return ctx.sync(); 
}).catch(function(error) {
    console.log("Error: " + error);
    if (error instanceof OfficeExtension.Error) {
        console.log("Debug info: " + JSON.stringify(error.debugInfo));
    }
});
```
## <a name="42ornullobject-methods"></a>*OrNullObject ??

?? Excel JavaScript API ???????? API ???????? ??????????????????????????????`getItem()` ???? `ItemNotFound` ??? 

??????? Excel JavaScript API ??????? `*OrNullObject` ??????????????????????????? ????? null ????? JavaScript `null`?????????????????????`*OrNullObject` ?????????? **Worksheets**???? `getItemOrNullObject()` ??????????????? ?????????????????????? null ???`getItemOrNullObject()` ??? null ???????? `isNullObject`????????????????????

??????????? `getItemOrNullObject()` ???????Data?????? ??????? null ?????????????????????????

```js
var dataSheet = context.workbook.worksheets.getItemOrNullObject("Data"); 

return context.sync()
  .then(function() {
    if (dataSheet.isNullObject) { 
        // Create the sheet
    }

    dataSheet.position = 1;
    //...
  })
```

## <a name="see-also"></a>????
 
* [Excel JavaScript API ????](excel-add-ins-core-concepts.md)
* [Excel ????????](http://dev.office.com/code-samples#?filters=excel,office%20add-ins)
* [Excel JavaScript API ????](https://dev.office.com/reference/add-ins/excel/performance.md)
* [Excel JavaScript API ??](https://dev.office.com/reference/add-ins/excel/excel-add-ins-reference-overview)
