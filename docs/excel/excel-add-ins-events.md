---
title: ?? Excel JavaScript API ????
description: ''
ms.date: 01/29/2018
ms.openlocfilehash: 4e04b31e7a130f21d6a9c94d041dc2a122a5890e
ms.sourcegitcommit: c72c35e8389c47a795afbac1b2bcf98c8e216d82
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/23/2018
---
# <a name="work-with-events-using-the-excel-javascript-api"></a>?? Excel JavaScript API ???? 

???????? Excel ??????????????????????????? Excel JavaScript API ??????????????????????? 

> [!IMPORTANT]
> ?????? API ???????? (beta)?????????? ???????????????????? Office???? Office.js CDN ? beta ??https://appsforoffice.microsoft.com/lib/beta/hosted/office.js?

## <a name="events-in-excel"></a>Excel ????

?? Excel ???????????????????????? ?? Excel JavaScript API????????????????????????????????????? ??????????

| ?? | ?? | ????? |
|:---------------|:-------------|:-----------|
| `onAdded` | ??????????? | [**WorksheetCollection**](https://github.com/OfficeDev/office-js-docs/blob/master/reference/excel/worksheetaddedeventargs.md) |
| `onActivated` | ??????????? | [**WorksheetCollection**](https://github.com/OfficeDev/office-js-docs/blob/master/reference/excel/worksheetactivatedeventargs.md)?[**Worksheet**](https://github.com/OfficeDev/office-js-docs/blob/master/reference/excel/worksheetactivatedeventargs.md) |
| `onDeactivated` | ??????????? | [**WorksheetCollection**](https://github.com/OfficeDev/office-js-docs/blob/master/reference/excel/worksheetdeactivatedeventargs.md)?[**Worksheet**](https://github.com/OfficeDev/office-js-docs/blob/master/reference/excel/worksheetdeactivatedeventargs.md) |
| `onChanged` | ??????????????? | [**Worksheet**](https://github.com/OfficeDev/office-js-docs/blob/master/reference/excel/worksheetchangedeventargs.md)?[**Table**](https://github.com/OfficeDev/office-js-docs/blob/master/reference/excel/tablechangedeventargs.md)?[**TableCollection**](https://github.com/OfficeDev/office-js-docs/blob/master/reference/excel/tablechangedeventargs.md)?[**Binding**](https://github.com/OfficeDev/office-js-docs/blob/master/reference/excel/bindingdatachangedeventargs.md) |
| `onSelectionChanged` | ??????????????????? | [**Worksheet**](https://github.com/OfficeDev/office-js-docs/blob/master/reference/excel/worksheetselectionchangedeventargs.md)?[**Table**](https://github.com/OfficeDev/office-js-docs/blob/master/reference/excel/tableselectionchangedeventargs.md)?[**Binding**](https://github.com/OfficeDev/office-js-docs/blob/master/reference/excel/bindingselectionchangedeventargs.md) |

### <a name="event-triggers"></a>?????

Excel ??????????????????

- ?????? Excel ???? (UI) ????
- ?????? Office ??? (JavaScript) ??
- ?????? VBA ????????

???? Excel ??????????????????????????

### <a name="lifecycle-of-an-event-handler"></a>???????????

???????????????????????????????????????????????????????????? Excel ???????

### <a name="events-and-coauthoring"></a>???????

??[??????](co-authoring-in-excel-add-ins.md)?????????????????? Excel ???????????????????? `onChanged`????? **Event** ????? **source** ??????????????????? (`event.source = Local`)????????????? (`event.source = Remote`)?

## <a name="register-an-event-handler"></a>????????

???????? **Sample** ????? `onChanged` ??????????? ????? `handleDataChange` ??????????????????

```js
Excel.run(function (context) {
    var worksheet = context.workbook.worksheets.getItem("Sample");
    worksheet.onChanged.add(handleChange);

    return context.sync()
        .then(function () {
            console.log("Event handler successfully registered for onChanged event in the worksheet.");
        });
}).catch(errorHandlerFunction);
```

## <a name="handle-an-event"></a>????

?????????????????????????????????? ???????????????????? ????????????????????????????????? 

```js
function handleChange(event)
{ 
    return Excel.run(function(context){
        return context.sync()
            .then(function() {
                console.log("Change type of event: " + event.changeType);
                console.log("Address of event: " + event.address);
                console.log("Source of event: " + event.source);
            });
    }).catch(errorHandlerFunction);
}
```

## <a name="remove-an-event-handler"></a>????????

???????? **Sample** ????? `onSelectionChanged` ????????????? `handleSelectionChange` ?????????????? ???????????? `remove()` ???????????????

```js
var eventResult;

Excel.run(function (context) {
    var worksheet = context.workbook.worksheets.getItem("Sample");
    eventResult = worksheet.onSelectionChanged.add(handleSelectionChange);

    return context.sync()
        .then(function () {
            console.log("Event handler successfully registered for onSelectionChanged event in the worksheet.");
        });
}).catch(errorHandlerFunction);

function handleSelectionChange(event)
{ 
    return Excel.run(function(context){
        return context.sync()
            .then(function() {
                console.log("Address of current selection: " + event.address);
            });
    }).catch(errorHandlerFunction);
}

function remove() {
    return Excel.run(eventResult.context, function (context) {
        eventResult.remove();
        
        return context.sync()
            .then(function() {
                eventResult = null;
                console.log("Event handler successfully removed.");
            });
    }).catch(errorHandlerFunction);
}
```

## <a name="see-also"></a>????

- [Excel JavaScript API ????](excel-add-ins-core-concepts.md)
- [Excel JavaScript API ?????](https://github.com/OfficeDev/office-js-docs/tree/ExcelJs_OpenSpec)
- [Excel ??????????](https://github.com/OfficeDev/office-js-docs/blob/ExcelJs_OpenSpec/Event_README.md)
