# <a name="build-your-first-onenote-add-in"></a>???? OneNote ???

??????????? jQuery ? Office JavaScript API ?? OneNote ????

## <a name="prerequisites"></a>????

- [Node.js](https://nodejs.org)

- ??????? [Yeoman](https://github.com/yeoman/yo) ? [Office ???? Yeoman ???](https://github.com/OfficeDev/generator-office)?

    ```bash
    npm install -g yo generator-office
    ```

## <a name="create-the-add-in-project"></a>???????

1. ????????????????????`my-onenote-addin`?? ?????????????

2. ???????

    ```bash
    cd my-onenote-addin
    ```

3. ?? Yeoman ????? OneNote ?????? ?????????????????????

    ```bash
    yo office
    ```

    - **???????????????:** `No`
    - **??????????????:** `OneNote Add-in`
    - **?????? Office ????????:** `OneNote`
    - **??????????:** `Yes`
    - **????? TypeScript?:** `No`
    - **?????** `Jquery`

    ???????????????resource.html?****???????????????????????????????????????????????????????????

    ![?? Yeoman ?????????????](../images/yo-office-onenote-jquery.png)


## <a name="update-the-code"></a>????

1. ??????????????????index.html?****? ????????????????? HTML?

2. ? `<body>` ???? `<main>` ???????????????? ???? [Office UI Fabric ??](http://dev.office.com/fabric/components)??????????

    ```html
    <main class="ms-welcome__main">
        <br />
        <p class="ms-font-l">Enter content below</p>
        <div class="ms-TextField ms-TextField--placeholder">
            <textarea id="textBox" rows="5"></textarea>
        </div>
        <button id="addOutline" class="ms-welcome__action ms-Button ms-Button--hero ms-u-slideUpIn20">
            <span class="ms-Button-label">Add Outline</span>
            <span class="ms-Button-icon"><i class="ms-Icon"></i></span>
            <span class="ms-Button-description">Adds the content above to the current page.</span>
        </button>
    </main>
    ```

3. ?????app.js?****?????????? ???????????????????

    ```js
    'use strict';

    (function () {

        Office.initialize = function (reason) {
            $(document).ready(function () {
                app.initialize();

                // Set up event handler for the UI.
                $('#addOutline').click(addOutlineToPage);
            });
        };

        // Add the contents of the text area to the page.
        function addOutlineToPage() {        
            OneNote.run(function (context) {
                var html = '<p>' + $('#textBox').val() + '</p>';

                // Get the current page.
                var page = context.application.getActivePage();

                // Queue a command to load the page with the title property.             
                page.load('title'); 

                // Add an outline with the specified HTML to the page.
                var outline = page.addOutline(40, 90, html);

                // Run the queued commands, and return a promise to indicate task completion.
                return context.sync()
                    .then(function() {
                        console.log('Added outline to page ' + page.title);
                    })
                    .catch(function(error) {
                        app.showNotification("Error: " + error); 
                        console.log("Error: " + error); 
                        if (error instanceof OfficeExtension.Error) { 
                            console.log("Debug info: " + JSON.stringify(error.debugInfo)); 
                        } 
                    }); 
            });
        }
    })();
    ```

## <a name="update-the-manifest"></a>????

1. ?????one-note-add-in-manifest.xml?****??????????????

2. ?????????`ProviderName` ??????????

3. ??? `DefaultValue` ???????`Description` ??????A task pane add-in for OneNote?****?

4. ?????

    ```xml
    ...
    <ProviderName>John Doe</ProviderName>
    <DefaultLocale>en-US</DefaultLocale>
    <!-- The display name of your add-in. Used on the store and various places of the Office UI such as the add-ins dialog. -->
    <DisplayName DefaultValue="OneNote Add-in" />
    <Description DefaultValue="A task pane add-in for OneNote"/>
    ...
    ```

## <a name="start-the-dev-server"></a>?????????

[!include[Start server section](../includes/quickstart-yo-start-server.md)]

## <a name="try-it-out"></a>??

1. ? [OneNote Online](https://www.onenote.com/notebooks) ??????????

2. ????????>?Office ????****????Office ????????

    - ????????????????????????****?????????????****?

    - ?????????????????????????****?????????????****? 

    ???????????????????****????

    <img alt="The Office Add-ins dialog showing the MY ADD-INS tab" src="../images/onenote-office-add-ins-dialog.png" width="500">

3. ??????????????????????**?one-note-add-in-manifest.xml?**????**????**? 

4. ??**??**?????????????**??????**???? ?????? OneNote ???? iFrame ????

5. ??????????????????**????**?? ????????????? 

    ![???????? OneNote ???](../images/onenote-first-add-in.png)

## <a name="troubleshooting-and-tips"></a>???????

- ???????????????????????? Internet Explorer ? Chrome ??? Gulp Web ???????????????????????????????? iFrame?

- ?? OneNote ???????????????????????????????**??? `_proto_` ?????????????????????

   ![????????? OneNote ??](../images/onenote-debug.png)

- ???????????? HTTP ??????????????????????????????? HTTPS ???

- ??????????????????????????????????????IFrame ????????????? 

## <a name="next-steps"></a>????

???????? OneNote ???? ???????????? OneNote ???????????

> [!div class="nextstepaction"]
> [OneNote JavaScript API ????](../onenote/onenote-add-ins-programming-overview.md)

## <a name="see-also"></a>????

- [OneNote JavaScript API ????](../onenote/onenote-add-ins-programming-overview.md)
- [OneNote JavaScript API ??](https://dev.office.com/reference/add-ins/onenote/onenote-add-ins-javascript-reference)
- [Rubric Grader ??](https://github.com/OfficeDev/OneNote-Add-in-Rubric-Grader)
- [Office ???????](../overview/office-add-ins.md)
