---
title: 获取或设置 Outlook 加载项中的项目数据
description: 根据加载项是在阅读窗体中激活还是在撰写窗体中激活，项目为加载项提供的属性也有所不同。
ms.date: 12/10/2019
localization_priority: Normal
ms.openlocfilehash: be7d14a6c417d01c0537e3375524da5cc807d749
ms.sourcegitcommit: a3ddfdb8a95477850148c4177e20e56a8673517c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/20/2020
ms.locfileid: "42165922"
---
# <a name="get-and-set-outlook-item-data-in-read-or-compose-forms"></a><span data-ttu-id="415fa-103">在阅读或撰写窗体中获取和设置 Outlook 项目数据</span><span class="sxs-lookup"><span data-stu-id="415fa-103">Get and set Outlook item data in read or compose forms</span></span>

<span data-ttu-id="415fa-104">从 Office 加载项清单架构的版本 1.1 开始，Outlook 可以在用户查看或撰写项目时激活加载项。</span><span class="sxs-lookup"><span data-stu-id="415fa-104">Starting in version 1.1 of the Office Add-ins manifests schema, Outlook can activate add-ins when the user is viewing or composing an item.</span></span> <span data-ttu-id="415fa-105">根据加载项是在阅读窗体中激活还是在撰写窗体中激活，项目为加载项提供的属性也有所不同。</span><span class="sxs-lookup"><span data-stu-id="415fa-105">Depending on whether an add-in is activated in a read or compose form, the properties that are available to the add-in on the item differ as well.</span></span>

<span data-ttu-id="415fa-106">例如，仅针对已发送项目（随后在阅读窗体中查看项目）定义 [dateTimeCreated](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties) 和 [dateTimeModified](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties) 属性，但（在撰写窗体中）创建项目时不定义这两个属性。</span><span class="sxs-lookup"><span data-stu-id="415fa-106">For example, the [dateTimeCreated](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties) and [dateTimeModified](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties) properties are defined only for an item that has already been sent (item is subsequently viewed in a read form) but not when the item is being created (in a compose form).</span></span> <span data-ttu-id="415fa-107">另一个示例是 [bcc](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties) 属性，它仅在（撰写窗体中）撰写邮件时具有意义，并且用户无法在阅读窗体中访问此属性。</span><span class="sxs-lookup"><span data-stu-id="415fa-107">Another example is the [bcc](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties) property, which is only meaningful when a message is being authored (in a compose form), and is not accessible to the user in a read form.</span></span>

## <a name="item-properties-available-in-compose-and-read-forms"></a><span data-ttu-id="415fa-108">撰写和阅读窗体中可用的项目属性</span><span class="sxs-lookup"><span data-stu-id="415fa-108">Item properties available in compose and read forms</span></span>

<span data-ttu-id="415fa-109">表 1 显示了适用于 Office 的 JavaScript API 中可用于邮件加载项的每个阅读和撰写模式的项目级属性。通常，阅读窗体中可用的属性是只读的，撰写窗体中可用的属性是可读取/写入的（[itemId](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)、[conversationId](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties) 和 [itemType](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties) 属性除外，尽管这两个属性也始终是只读的）。</span><span class="sxs-lookup"><span data-stu-id="415fa-109">Table 1 shows the item-level properties in the JavaScript API for Office that are available in each mode (read and compose) of mail add-ins. Typically, those properties available in read forms are read-only, and those available in compose forms are read/write, with the exception of the [itemId](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties), [conversationId](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties), and [itemType](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties) properties, which are always read-only regardless.</span></span>

<span data-ttu-id="415fa-110">对于撰写窗体中的其余项目级属性，由于加载项和用户可以同时读取或写入同一属性，在撰写模式下获取或设置这些属性的方法都是异步的，因此这些属性在撰写窗体中和阅读窗体中返回的对象类型可能也有所不同。</span><span class="sxs-lookup"><span data-stu-id="415fa-110">For the remaining item-level properties available in compose forms, because the add-in and user can possibly be reading or writing the same property at the same time, the methods to get or set them in compose mode are asynchronous, and hence the type of the objects returned by these properties may also be different in compose forms than in read forms.</span></span> <span data-ttu-id="415fa-111">有关在撰写模式下使用异步方法获取或设置项目级属性的详细信息，请参阅[在 Outlook 的撰写窗体中获取和设置项目数据](get-and-set-item-data-in-a-compose-form.md)。</span><span class="sxs-lookup"><span data-stu-id="415fa-111">For more information about using asynchronous methods to get or set item-level properties in compose mode, see [Get and set item data in a compose form in Outlook](get-and-set-item-data-in-a-compose-form.md).</span></span>


<span data-ttu-id="415fa-112">**表 1. 撰写窗体和阅读窗体中可用的项目属性**</span><span class="sxs-lookup"><span data-stu-id="415fa-112">**Table 1. Item properties available in compose and read forms**</span></span>

<br/>

|<span data-ttu-id="415fa-113">**项目类型**</span><span class="sxs-lookup"><span data-stu-id="415fa-113">**Item type**</span></span>|<span data-ttu-id="415fa-114">**属性**</span><span class="sxs-lookup"><span data-stu-id="415fa-114">**Property**</span></span>|<span data-ttu-id="415fa-115">**阅读窗体中的属性类型**</span><span class="sxs-lookup"><span data-stu-id="415fa-115">**Property type in read forms**</span></span>|<span data-ttu-id="415fa-116">**撰写窗体中的属性类型**</span><span class="sxs-lookup"><span data-stu-id="415fa-116">**Property type in compose forms**</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="415fa-117">约会和邮件</span><span class="sxs-lookup"><span data-stu-id="415fa-117">Appointments and messages</span></span>|[<span data-ttu-id="415fa-118">dateTimeCreated</span><span class="sxs-lookup"><span data-stu-id="415fa-118">dateTimeCreated</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)|<span data-ttu-id="415fa-119">JavaScript **Date** 对象</span><span class="sxs-lookup"><span data-stu-id="415fa-119">JavaScript **Date** object</span></span>|<span data-ttu-id="415fa-120">属性不可用</span><span class="sxs-lookup"><span data-stu-id="415fa-120">Property not available</span></span>|
|<span data-ttu-id="415fa-121">约会和邮件</span><span class="sxs-lookup"><span data-stu-id="415fa-121">Appointments and messages</span></span>|[<span data-ttu-id="415fa-122">dateTimeModified</span><span class="sxs-lookup"><span data-stu-id="415fa-122">dateTimeModified</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)|<span data-ttu-id="415fa-123">JavaScript **Date** 对象</span><span class="sxs-lookup"><span data-stu-id="415fa-123">JavaScript **Date** object</span></span>|<span data-ttu-id="415fa-124">属性不可用</span><span class="sxs-lookup"><span data-stu-id="415fa-124">Property not available</span></span>|
|<span data-ttu-id="415fa-125">约会和邮件</span><span class="sxs-lookup"><span data-stu-id="415fa-125">Appointments and messages</span></span>|[<span data-ttu-id="415fa-126">itemClass</span><span class="sxs-lookup"><span data-stu-id="415fa-126">itemClass</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)|<span data-ttu-id="415fa-127">字符串</span><span class="sxs-lookup"><span data-stu-id="415fa-127">String</span></span>|<span data-ttu-id="415fa-128">属性不可用</span><span class="sxs-lookup"><span data-stu-id="415fa-128">Property not available</span></span>|
|<span data-ttu-id="415fa-129">约会和邮件</span><span class="sxs-lookup"><span data-stu-id="415fa-129">Appointments and messages</span></span>|[<span data-ttu-id="415fa-130">itemId</span><span class="sxs-lookup"><span data-stu-id="415fa-130">itemId</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)|<span data-ttu-id="415fa-131">字符串</span><span class="sxs-lookup"><span data-stu-id="415fa-131">String</span></span>|<span data-ttu-id="415fa-132">属性不可用</span><span class="sxs-lookup"><span data-stu-id="415fa-132">Property not available</span></span>|
|<span data-ttu-id="415fa-133">约会和邮件</span><span class="sxs-lookup"><span data-stu-id="415fa-133">Appointments and messages</span></span>|[<span data-ttu-id="415fa-134">itemType</span><span class="sxs-lookup"><span data-stu-id="415fa-134">itemType</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)|<span data-ttu-id="415fa-135">[ItemType](/javascript/api/outlook/office.mailboxenums.itemtype) 枚举中的字符串</span><span class="sxs-lookup"><span data-stu-id="415fa-135">String in [ItemType](/javascript/api/outlook/office.mailboxenums.itemtype) enumeration</span></span>|<span data-ttu-id="415fa-136">[ItemType](/javascript/api/outlook/office.mailboxenums.itemtype) 枚举中的字符串（只读）</span><span class="sxs-lookup"><span data-stu-id="415fa-136">String in [ItemType](/javascript/api/outlook/office.mailboxenums.itemtype) enumeration (read only)</span></span>|
|<span data-ttu-id="415fa-137">约会和邮件</span><span class="sxs-lookup"><span data-stu-id="415fa-137">Appointments and messages</span></span>|[<span data-ttu-id="415fa-138">attachments</span><span class="sxs-lookup"><span data-stu-id="415fa-138">attachments</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)|[<span data-ttu-id="415fa-139">AttachmentDetails</span><span class="sxs-lookup"><span data-stu-id="415fa-139">AttachmentDetails</span></span>](/javascript/api/outlook/office.attachmentdetails)|<span data-ttu-id="415fa-140">属性不可用</span><span class="sxs-lookup"><span data-stu-id="415fa-140">Property not available</span></span>|
|<span data-ttu-id="415fa-141">约会和邮件</span><span class="sxs-lookup"><span data-stu-id="415fa-141">Appointments and messages</span></span>|[<span data-ttu-id="415fa-142">body</span><span class="sxs-lookup"><span data-stu-id="415fa-142">body</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)|[<span data-ttu-id="415fa-143">Body</span><span class="sxs-lookup"><span data-stu-id="415fa-143">Body</span></span>](/javascript/api/outlook/office.body)|[<span data-ttu-id="415fa-144">Body</span><span class="sxs-lookup"><span data-stu-id="415fa-144">Body</span></span>](/javascript/api/outlook/office.body)|
|<span data-ttu-id="415fa-145">约会和邮件</span><span class="sxs-lookup"><span data-stu-id="415fa-145">Appointments and messages</span></span>|[<span data-ttu-id="415fa-146">normalizedSubject</span><span class="sxs-lookup"><span data-stu-id="415fa-146">normalizedSubject</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)|<span data-ttu-id="415fa-147">字符串</span><span class="sxs-lookup"><span data-stu-id="415fa-147">String</span></span>|<span data-ttu-id="415fa-148">属性不可用</span><span class="sxs-lookup"><span data-stu-id="415fa-148">Property not available</span></span>|
|<span data-ttu-id="415fa-149">约会和邮件</span><span class="sxs-lookup"><span data-stu-id="415fa-149">Appointments and messages</span></span>|[<span data-ttu-id="415fa-150">subject</span><span class="sxs-lookup"><span data-stu-id="415fa-150">subject</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)|<span data-ttu-id="415fa-151">字符串</span><span class="sxs-lookup"><span data-stu-id="415fa-151">String</span></span>|[<span data-ttu-id="415fa-152">Subject</span><span class="sxs-lookup"><span data-stu-id="415fa-152">Subject</span></span>](/javascript/api/outlook/office.subject)|
|<span data-ttu-id="415fa-153">约会</span><span class="sxs-lookup"><span data-stu-id="415fa-153">Appointments</span></span>|[<span data-ttu-id="415fa-154">end</span><span class="sxs-lookup"><span data-stu-id="415fa-154">end</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)|<span data-ttu-id="415fa-155">JavaScript **Date** 对象</span><span class="sxs-lookup"><span data-stu-id="415fa-155">JavaScript **Date** object</span></span>|[<span data-ttu-id="415fa-156">Time</span><span class="sxs-lookup"><span data-stu-id="415fa-156">Time</span></span>](/javascript/api/outlook/office.time)|
|<span data-ttu-id="415fa-157">约会</span><span class="sxs-lookup"><span data-stu-id="415fa-157">Appointments</span></span>|[<span data-ttu-id="415fa-158">location</span><span class="sxs-lookup"><span data-stu-id="415fa-158">location</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)|<span data-ttu-id="415fa-159">字符串</span><span class="sxs-lookup"><span data-stu-id="415fa-159">String</span></span>|[<span data-ttu-id="415fa-160">位置</span><span class="sxs-lookup"><span data-stu-id="415fa-160">Location</span></span>](/javascript/api/outlook/office.location)|
|<span data-ttu-id="415fa-161">约会</span><span class="sxs-lookup"><span data-stu-id="415fa-161">Appointments</span></span>|[<span data-ttu-id="415fa-162">optionalAttendees</span><span class="sxs-lookup"><span data-stu-id="415fa-162">optionalAttendees</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)|[<span data-ttu-id="415fa-163">EmailAddressDetails</span><span class="sxs-lookup"><span data-stu-id="415fa-163">EmailAddressDetails</span></span>](/javascript/api/outlook/office.emailaddressdetails)|[<span data-ttu-id="415fa-164">Recipients</span><span class="sxs-lookup"><span data-stu-id="415fa-164">Recipients</span></span>](/javascript/api/outlook/office.recipients)|
|<span data-ttu-id="415fa-165">约会</span><span class="sxs-lookup"><span data-stu-id="415fa-165">Appointments</span></span>|[<span data-ttu-id="415fa-166">organizer</span><span class="sxs-lookup"><span data-stu-id="415fa-166">organizer</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)|[<span data-ttu-id="415fa-167">EmailAddressDetails</span><span class="sxs-lookup"><span data-stu-id="415fa-167">EmailAddressDetails</span></span>](/javascript/api/outlook/office.emailaddressdetails)|[<span data-ttu-id="415fa-168">Organizer</span><span class="sxs-lookup"><span data-stu-id="415fa-168">Organizer</span></span>](/javascript/api/outlook/office.organizer)|
|<span data-ttu-id="415fa-169">约会</span><span class="sxs-lookup"><span data-stu-id="415fa-169">Appointments</span></span>|[<span data-ttu-id="415fa-170">requiredAttendees</span><span class="sxs-lookup"><span data-stu-id="415fa-170">requiredAttendees</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)|[<span data-ttu-id="415fa-171">EmailAddressDetails</span><span class="sxs-lookup"><span data-stu-id="415fa-171">EmailAddressDetails</span></span>](/javascript/api/outlook/office.emailaddressdetails)|[<span data-ttu-id="415fa-172">Recipients</span><span class="sxs-lookup"><span data-stu-id="415fa-172">Recipients</span></span>](/javascript/api/outlook/office.recipients)|
|<span data-ttu-id="415fa-173">约会</span><span class="sxs-lookup"><span data-stu-id="415fa-173">Appointments</span></span>|[<span data-ttu-id="415fa-174">start</span><span class="sxs-lookup"><span data-stu-id="415fa-174">start</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)|<span data-ttu-id="415fa-175">JavaScript **Date** 对象</span><span class="sxs-lookup"><span data-stu-id="415fa-175">JavaScript **Date** object</span></span>|[<span data-ttu-id="415fa-176">Time</span><span class="sxs-lookup"><span data-stu-id="415fa-176">Time</span></span>](/javascript/api/outlook/office.time)|
|<span data-ttu-id="415fa-177">邮件</span><span class="sxs-lookup"><span data-stu-id="415fa-177">Messages</span></span>|[<span data-ttu-id="415fa-178">bcc</span><span class="sxs-lookup"><span data-stu-id="415fa-178">bcc</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)|<span data-ttu-id="415fa-179">属性不可用</span><span class="sxs-lookup"><span data-stu-id="415fa-179">Property not available</span></span>|[<span data-ttu-id="415fa-180">收件人</span><span class="sxs-lookup"><span data-stu-id="415fa-180">Recipients</span></span>](/javascript/api/outlook/office.recipients)|
|<span data-ttu-id="415fa-181">邮件</span><span class="sxs-lookup"><span data-stu-id="415fa-181">Messages</span></span>|[<span data-ttu-id="415fa-182">cc</span><span class="sxs-lookup"><span data-stu-id="415fa-182">cc</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)|[<span data-ttu-id="415fa-183">EmailAddressDetails</span><span class="sxs-lookup"><span data-stu-id="415fa-183">EmailAddressDetails</span></span>](/javascript/api/outlook/office.emailaddressdetails)|[<span data-ttu-id="415fa-184">收件人</span><span class="sxs-lookup"><span data-stu-id="415fa-184">Recipients</span></span>](/javascript/api/outlook/office.recipients)|
|<span data-ttu-id="415fa-185">邮件</span><span class="sxs-lookup"><span data-stu-id="415fa-185">Messages</span></span>|[<span data-ttu-id="415fa-186">conversationId</span><span class="sxs-lookup"><span data-stu-id="415fa-186">conversationId</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)|<span data-ttu-id="415fa-187">字符串</span><span class="sxs-lookup"><span data-stu-id="415fa-187">String</span></span>|<span data-ttu-id="415fa-188">字符串（只读）</span><span class="sxs-lookup"><span data-stu-id="415fa-188">String (read only)</span></span>|
|<span data-ttu-id="415fa-189">邮件</span><span class="sxs-lookup"><span data-stu-id="415fa-189">Messages</span></span>|[<span data-ttu-id="415fa-190">from</span><span class="sxs-lookup"><span data-stu-id="415fa-190">from</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)|[<span data-ttu-id="415fa-191">EmailAddressDetails</span><span class="sxs-lookup"><span data-stu-id="415fa-191">EmailAddressDetails</span></span>](/javascript/api/outlook/office.emailaddressdetails)|[<span data-ttu-id="415fa-192">From</span><span class="sxs-lookup"><span data-stu-id="415fa-192">From</span></span>](/javascript/api/outlook/office.from)|
|<span data-ttu-id="415fa-193">邮件</span><span class="sxs-lookup"><span data-stu-id="415fa-193">Messages</span></span>|[<span data-ttu-id="415fa-194">internetMessageId</span><span class="sxs-lookup"><span data-stu-id="415fa-194">internetMessageId</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)|<span data-ttu-id="415fa-195">整数</span><span class="sxs-lookup"><span data-stu-id="415fa-195">Integer</span></span>|<span data-ttu-id="415fa-196">属性不可用</span><span class="sxs-lookup"><span data-stu-id="415fa-196">Property not available</span></span>|
|<span data-ttu-id="415fa-197">邮件</span><span class="sxs-lookup"><span data-stu-id="415fa-197">Messages</span></span>|[<span data-ttu-id="415fa-198">sender</span><span class="sxs-lookup"><span data-stu-id="415fa-198">sender</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)|[<span data-ttu-id="415fa-199">EmailAddressDetails</span><span class="sxs-lookup"><span data-stu-id="415fa-199">EmailAddressDetails</span></span>](/javascript/api/outlook/office.emailaddressdetails)|<span data-ttu-id="415fa-200">属性不可用</span><span class="sxs-lookup"><span data-stu-id="415fa-200">Property not available</span></span>|
|<span data-ttu-id="415fa-201">邮件</span><span class="sxs-lookup"><span data-stu-id="415fa-201">Messages</span></span>|[<span data-ttu-id="415fa-202">to</span><span class="sxs-lookup"><span data-stu-id="415fa-202">to</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)|[<span data-ttu-id="415fa-203">EmailAddressDetails</span><span class="sxs-lookup"><span data-stu-id="415fa-203">EmailAddressDetails</span></span>](/javascript/api/outlook/office.emailaddressdetails)|[<span data-ttu-id="415fa-204">收件人</span><span class="sxs-lookup"><span data-stu-id="415fa-204">Recipients</span></span>](/javascript/api/outlook/office.recipients)|

## <a name="use-exchange-server-callback-tokens-from-a-read-add-in"></a><span data-ttu-id="415fa-205">从阅读加载项使用 Exchange Server 回调令牌</span><span class="sxs-lookup"><span data-stu-id="415fa-205">Use Exchange Server callback tokens from a read add-in</span></span>

<span data-ttu-id="415fa-206">如果 Outlook 加载项在读取表单中激活，则可以获取 Exchange 回调令牌。</span><span class="sxs-lookup"><span data-stu-id="415fa-206">If your Outlook add-in is activated in read forms, you can get an Exchange callback token.</span></span> <span data-ttu-id="415fa-207">该令牌可用于服务器端代码，以便通过 Exchange Web 服务 (EWS) 访问完整项目。</span><span class="sxs-lookup"><span data-stu-id="415fa-207">This token can be used in server-side code to access the full item via Exchange Web Services (EWS).</span></span>

<span data-ttu-id="415fa-208">通过在加载项清单中指定 **ReadItem** 权限，可以使用 [mailbox.getCallbackTokenAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods) 方法获取 Exchange 回调令牌，使用 [mailbox.ewsUrl](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#properties) 属性获取用户邮箱 EWS 终结点的 URL，以及使用 [item.itemId](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties) 获取所选项目的 EWS ID。</span><span class="sxs-lookup"><span data-stu-id="415fa-208">By specifying the **ReadItem** permission in the add-in manifest, you can use the [mailbox.getCallbackTokenAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods) method to get an Exchange callback token, the [mailbox.ewsUrl](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#properties) property to get the URL of the EWS endpoint for the user's mailbox, and [item.itemId](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties) to get the EWS ID for the selected item.</span></span> <span data-ttu-id="415fa-209">然后，可以将回调令牌、EWS 终结点 URL 和 EWS 项目 ID 传递到服务器端代码，以访问 [GetItem](/exchange/client-developer/web-service-reference/getitem-operation) 操作，从而获取项目的更多属性。</span><span class="sxs-lookup"><span data-stu-id="415fa-209">You can then pass the callback token, EWS endpoint URL, and the EWS item ID to server-side code to access the [GetItem](/exchange/client-developer/web-service-reference/getitem-operation) operation, to get more properties of the item.</span></span>


## <a name="access-ews-from-a-read-or-compose-add-in"></a><span data-ttu-id="415fa-210">从阅读或撰写加载项访问 EWS</span><span class="sxs-lookup"><span data-stu-id="415fa-210">Access EWS from a read or compose add-in</span></span>

<span data-ttu-id="415fa-211">另外，还可以使用 [mailbox.makeEwsRequestAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods) 方法直接从加载项访问 Exchange Web 服务 (EWS) 操作 [GetItem](/exchange/client-developer/web-service-reference/getitem-operation) 和 [UpdateItem](/exchange/client-developer/web-service-reference/updateitem-operation)。</span><span class="sxs-lookup"><span data-stu-id="415fa-211">You can also use the [mailbox.makeEwsRequestAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods) method to access the Exchange Web Services (EWS) operations [GetItem](/exchange/client-developer/web-service-reference/getitem-operation) and [UpdateItem](/exchange/client-developer/web-service-reference/updateitem-operation) directly from the add-in.</span></span> <span data-ttu-id="415fa-212">可以使用这两个操作获取并设置指定项目的多个属性。</span><span class="sxs-lookup"><span data-stu-id="415fa-212">You can use these operations to get and set many properties of a specified item.</span></span> <span data-ttu-id="415fa-213">无论加载项已在阅读还是撰写窗体中激活，只要在加载项清单中指定了 **ReadWriteMailbox** 权限，Outlook 加载项就可以使用此方法。</span><span class="sxs-lookup"><span data-stu-id="415fa-213">This method is available to Outlook add-ins regardless of whether the add-in has been activated in a read or compose form, as long as you specify the **ReadWriteMailbox** permission in the add-in manifest.</span></span>

<span data-ttu-id="415fa-214">有关使用 **makeEwsRequestAsync** 访问 EWS 操作的详细信息，请参阅[从 Outlook 加载项调用 Web 服务](web-services.md)。</span><span class="sxs-lookup"><span data-stu-id="415fa-214">For more information about using **makeEwsRequestAsync** to access EWS operations, see [Call web services from an Outlook add-in](web-services.md).</span></span>


## <a name="see-also"></a><span data-ttu-id="415fa-215">另请参阅</span><span class="sxs-lookup"><span data-stu-id="415fa-215">See also</span></span>

- [<span data-ttu-id="415fa-216">在 Outlook 的撰写窗体中获取和设置项目数据</span><span class="sxs-lookup"><span data-stu-id="415fa-216">Get and set item data in a compose form in Outlook</span></span>](get-and-set-item-data-in-a-compose-form.md)
- [<span data-ttu-id="415fa-217">从 Outlook 外接程序调用 Web 服务</span><span class="sxs-lookup"><span data-stu-id="415fa-217">Call web services from an Outlook add-in</span></span>](web-services.md)
