---
title: 处理 Outlook 加载项中的日期值
description: 适用于 Office 的 JavaScript API 将 JavaScript Date 对象用于大多数日期和时间存储和检索。
ms.date: 10/31/2019
localization_priority: Normal
ms.openlocfilehash: 5718839ebda433df6fb14886da34d734f81eb5f2
ms.sourcegitcommit: a3ddfdb8a95477850148c4177e20e56a8673517c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/20/2020
ms.locfileid: "42165884"
---
# <a name="tips-for-handling-date-values-in-outlook-add-ins"></a><span data-ttu-id="6f975-103">处理 Outlook 加载项中的日期值的提示</span><span class="sxs-lookup"><span data-stu-id="6f975-103">Tips for handling date values in Outlook add-ins</span></span>

<span data-ttu-id="6f975-104">适用于 Office 的 JavaScript API 将 JavaScript [Date](https://www.w3schools.com/jsref/jsref_obj_date.asp) 对象用于大多数日期和时间存储和检索。</span><span class="sxs-lookup"><span data-stu-id="6f975-104">The JavaScript API for Office uses the JavaScript [Date](https://www.w3schools.com/jsref/jsref_obj_date.asp) object for most of the storage and retrieval of dates and times.</span></span> 

<span data-ttu-id="6f975-105">该 **Date** 对象提供一些方法，如 [getUTCDate](https://www.w3schools.com/jsref/jsref_getutcdate.asp)、[getUTCHour](https://www.w3schools.com/jsref/jsref_getutchours.asp)、[getUTCMinutes](https://www.w3schools.com/jsref/jsref_getutcminutes.asp) 和 [toUTCString](https://www.w3schools.com/jsref/jsref_toutcstring.asp)，它根据协调世界时 (UTC) 时间返回请求的日期或时间值。</span><span class="sxs-lookup"><span data-stu-id="6f975-105">That **Date** object provides methods such as [getUTCDate](https://www.w3schools.com/jsref/jsref_getutcdate.asp), [getUTCHour](https://www.w3schools.com/jsref/jsref_getutchours.asp), [getUTCMinutes](https://www.w3schools.com/jsref/jsref_getutcminutes.asp), and [toUTCString](https://www.w3schools.com/jsref/jsref_toutcstring.asp), which return the requested date or time value according to Universal Coordinated Time (UTC) time.</span></span>

<span data-ttu-id="6f975-106">**Date** 对象还提供了其他方法，如 [getDate](https://www.w3schools.com/jsref/jsref_getutcdate.asp)、[getHour](https://www.w3schools.com/jsref/jsref_getutchours.asp)、[getMinutes](https://www.w3schools.com/jsref/jsref_getminutes.asp) 和 [toString](https://www.w3schools.com/jsref/jsref_tostring_date.asp)，它根据本地时间返回请求的日期或时间。</span><span class="sxs-lookup"><span data-stu-id="6f975-106">The **Date** object also provides other methods such as [getDate](https://www.w3schools.com/jsref/jsref_getutcdate.asp), [getHour](https://www.w3schools.com/jsref/jsref_getutchours.asp), [getMinutes](https://www.w3schools.com/jsref/jsref_getminutes.asp), and [toString](https://www.w3schools.com/jsref/jsref_tostring_date.asp), which return the requested date or time according to "local time".</span></span>

<span data-ttu-id="6f975-p101">“本地时间”概念很大程度上取决于客户端计算机上的浏览器和操作系统。例如，在大多数运行于基于 Windows 的客户端计算机的浏览器上，JavaScript 调用 **getDate** 根据客户端计算机上 Windows 中设置的时区返回日期。</span><span class="sxs-lookup"><span data-stu-id="6f975-p101">The concept of "local time" is largely determined by the browser and operating system on the client computer. For instance, on most browsers running on a Windows-based client computer, a JavaScript call to **getDate**, returns a date based on the time zone set in Windows on the client computer.</span></span>

<span data-ttu-id="6f975-109">下面的示例以本地时间创建 **Date** 对象 `myLocalDate`，然后调用 **toUTCString** 将该日期转换为 UTC 格式的日期字符串。</span><span class="sxs-lookup"><span data-stu-id="6f975-109">The following example creates a **Date** object `myLocalDate` in local time, and calls **toUTCString** to convert that date to a date string in UTC.</span></span>

```js
// Create and get the current date represented 
// in the client computer time zone.
var myLocalDate = new Date (); 

// Convert the Date value in the client computer time zone
// to a date string in UTC, and display the string.
document.write ("The current UTC time is " + 
    myLocalDate.toUTCString());
```

<span data-ttu-id="6f975-110">虽然可以使用 JavaScript **Date** 对象获取基于 UTC 或客户端计算机时区的日期或时间值，但是 **Date** 对象在一个方面受到限制：它不提供任何方法来返回任何其他特定时区的日期或时间值。</span><span class="sxs-lookup"><span data-stu-id="6f975-110">While you can use the JavaScript **Date** object to get a date or time value based on UTC or the client computer time zone, the **Date** object is limited in one respect - it does not provide methods to return a date or time value for any other specific time zone.</span></span> <span data-ttu-id="6f975-111">例如，如果客户端计算机设置为东部标准时间 (EST)，则无法使用任何 **Date** 方法来获取除 EST 和 UTC 外（如太平洋标准时间 (PST)）的小时值。</span><span class="sxs-lookup"><span data-stu-id="6f975-111">For example, if your client computer is set to be on Eastern Standard Time (EST), there is no **Date** method that allows you to get the hour value other than in EST or UTC, such as Pacific Standard Time (PST).</span></span>


## <a name="date-related-features-for-outlook-add-ins"></a><span data-ttu-id="6f975-112">Outlook 加载项的日期相关功能</span><span class="sxs-lookup"><span data-stu-id="6f975-112">Date-related features for Outlook add-ins</span></span>

<span data-ttu-id="6f975-113">当您使用适用于 Office 的 JavaScript API 在 outlook 富客户端中运行的 Outlook 外接程序中以及在 web 或移动设备上运行的 outlook 外接程序中的日期或时间值时，上述 JavaScript 限制将为您暗示。</span><span class="sxs-lookup"><span data-stu-id="6f975-113">The aforementioned JavaScript limitation has an implication for you, when you use the JavaScript API for Office to handle date or time values in Outlook add-ins that run in an Outlook rich client, and in Outlook on the web or mobile devices.</span></span>


### <a name="time-zones-for-outlook-clients"></a><span data-ttu-id="6f975-114">Outlook 客户端的时区</span><span class="sxs-lookup"><span data-stu-id="6f975-114">Time zones for Outlook clients</span></span>

<span data-ttu-id="6f975-115">为清楚起见，让我们先定义要讨论的时区。</span><span class="sxs-lookup"><span data-stu-id="6f975-115">For clarity, let's define the time zones in question.</span></span>

|<span data-ttu-id="6f975-116">**时区**</span><span class="sxs-lookup"><span data-stu-id="6f975-116">**Time zone**</span></span>|<span data-ttu-id="6f975-117">**说明**</span><span class="sxs-lookup"><span data-stu-id="6f975-117">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="6f975-118">客户端计算机时区</span><span class="sxs-lookup"><span data-stu-id="6f975-118">Client computer time zone</span></span>|<span data-ttu-id="6f975-119">这在客户端计算机的操作系统上设置。</span><span class="sxs-lookup"><span data-stu-id="6f975-119">This is set on the operating system of the client computer.</span></span> <span data-ttu-id="6f975-120">大多数浏览器使用客户端计算机时区来显示 JavaScript **Date** 对象的日期或时间值。</span><span class="sxs-lookup"><span data-stu-id="6f975-120">Most browsers use the client computer time zone to display date or time values of the JavaScript **Date** object.</span></span><br/><br/><span data-ttu-id="6f975-121">Outlook 富客户端使用此时区在用户界面中显示日期或时间值。</span><span class="sxs-lookup"><span data-stu-id="6f975-121">An Outlook rich client uses this time zone to display date or time values in the user interface.</span></span> <br/><br/><span data-ttu-id="6f975-122">例如，在运行 Windows 的客户端计算机上，Outlook 将使用 Windows 上设置的时区作为本地时区。</span><span class="sxs-lookup"><span data-stu-id="6f975-122">For example, on a client computer running Windows, Outlook uses the time zone set on Windows as the local time zone.</span></span> <span data-ttu-id="6f975-123">在 Mac 上，如果用户更改了客户端计算机上的时区，Mac 上的 Outlook 也会提示用户在 Outlook 中更新时区。</span><span class="sxs-lookup"><span data-stu-id="6f975-123">On the Mac, if the user changes the time zone on the client computer, Outlook on Mac would prompt the user to update the time zone in Outlook as well.</span></span>|
|<span data-ttu-id="6f975-124">Exchange 管理中心 (EAC) 时区</span><span class="sxs-lookup"><span data-stu-id="6f975-124">Exchange Admin Center (EAC) time zone</span></span>|<span data-ttu-id="6f975-125">当用户首次登录到 web 或移动设备上的 Outlook 时，用户将设置此时区值（和首选语言）。</span><span class="sxs-lookup"><span data-stu-id="6f975-125">The user sets this time zone value (and the preferred language) when he or she logs on to Outlook on the web or mobile devices the first time.</span></span> <br/><br/><span data-ttu-id="6f975-126">Web 和移动设备上的 Outlook 使用此时区在用户界面中显示日期或时间值。</span><span class="sxs-lookup"><span data-stu-id="6f975-126">Outlook on the web and mobile devices use this time zone to display date or time values in the user interface.</span></span>|

<span data-ttu-id="6f975-127">由于 Outlook 富客户端使用的是客户端计算机时区，web 上的 Outlook 和移动设备上的用户界面使用 EAC 时区，因此在 Outlook 富 clie 中运行时，为同一邮箱安装的相同加载项的本地时间可能不同。nt 和在 Outlook 网页版或移动设备上。</span><span class="sxs-lookup"><span data-stu-id="6f975-127">Because an Outlook rich client uses the client computer time zone, and the user interface of Outlook on the web and mobile devices uses the EAC time zone, the local time for the same add-in installed for the same mailbox can be different when running in an Outlook rich client and in Outlook on the web or mobile devices.</span></span> <span data-ttu-id="6f975-128">作为 Outlook 外接程序开发人员，您应该正确输入和输出日期值，以便那些值始终与用户期望的相应客户端上的时区保持一致。</span><span class="sxs-lookup"><span data-stu-id="6f975-128">As an Outlook add-in developer, you should appropriately input and output date values so that those values are always consistent with the time zone that the user expects on the corresponding client.</span></span>


### <a name="date-related-api"></a><span data-ttu-id="6f975-129">日期相关的 API</span><span class="sxs-lookup"><span data-stu-id="6f975-129">Date-related API</span></span>

<span data-ttu-id="6f975-130">以下是适用于 Office 的 JavaScript API 中支持日期相关功能的属性和方法。</span><span class="sxs-lookup"><span data-stu-id="6f975-130">The following are the properties and methods in the JavaScript API for Office that support date-related features.</span></span>

<span data-ttu-id="6f975-131">**API 成员**</span><span class="sxs-lookup"><span data-stu-id="6f975-131">**API member**</span></span>|<span data-ttu-id="6f975-132">**时区表示形式**</span><span class="sxs-lookup"><span data-stu-id="6f975-132">**Time zone representation**</span></span>|<span data-ttu-id="6f975-133">**Outlook 富客户端中的示例**</span><span class="sxs-lookup"><span data-stu-id="6f975-133">**Example in an Outlook rich client**</span></span>|<span data-ttu-id="6f975-134">**Web 或移动设备上的 Outlook 中的示例**</span><span class="sxs-lookup"><span data-stu-id="6f975-134">**Example in Outlook on the web or mobile devices**</span></span>
--------------|----------------------------|-------------------------------------|-------------------
[<span data-ttu-id="6f975-135">Office.context.mailbox.userProfile.timeZone</span><span class="sxs-lookup"><span data-stu-id="6f975-135">Office.context.mailbox.userProfile.timeZone</span></span>](/javascript/api/outlook/office.userprofile?view=outlook-js-preview#timezone)|<span data-ttu-id="6f975-136">在 Outlook 富客户端中，此属性返回客户端计算机时区。</span><span class="sxs-lookup"><span data-stu-id="6f975-136">In an Outlook rich client, this property returns the client computer time zone.</span></span> <span data-ttu-id="6f975-137">在 web 和移动设备上的 Outlook 中，此属性返回 EAC 时区。</span><span class="sxs-lookup"><span data-stu-id="6f975-137">In Outlook on the web and mobile devices, this property returns the EAC time zone.</span></span> |<span data-ttu-id="6f975-138">EST</span><span class="sxs-lookup"><span data-stu-id="6f975-138">EST</span></span>|<span data-ttu-id="6f975-139">PST</span><span class="sxs-lookup"><span data-stu-id="6f975-139">PST</span></span>
<span data-ttu-id="6f975-140">[Office.context.mailbox.item.dateTimeCreated](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties) 和 [Office.context.mailbox.item.dateTimeModified](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)</span><span class="sxs-lookup"><span data-stu-id="6f975-140">[Office.context.mailbox.item.dateTimeCreated](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties) and [Office.context.mailbox.item.dateTimeModified](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)</span></span>|<span data-ttu-id="6f975-141">上述每个属性返回 JavaScript **Date** 对象。</span><span class="sxs-lookup"><span data-stu-id="6f975-141">Each of these properties returns a JavaScript **Date** object.</span></span> <span data-ttu-id="6f975-142">此**日期**值是正确的，如以下示例中所示- `myUTCDate` outlook 富客户端中具有相同的值，outlook 网页版和移动设备上具有相同的值。</span><span class="sxs-lookup"><span data-stu-id="6f975-142">This **Date** value is UTC-correct, as shown in the following example - `myUTCDate` has the same value in an Outlook rich client, Outlook on the web and mobile devices.</span></span><br/><br/>`var myDate = Office.mailbox.item.dateTimeCreated;`<br/>`var myUTCDate = myDate.getUTCDate;`<br/><br/><span data-ttu-id="6f975-143">但是，调用`myDate.getDate`将返回客户端计算机时区中的 date 值，这与用于在 outlook 富客户端界面中显示日期时间值的时区一致，但可能不同于 web 和移动设备上的用户界面中使用的 EAC 时区。</span><span class="sxs-lookup"><span data-stu-id="6f975-143">However, calling  `myDate.getDate` returns a date value in the client computer time zone, which is consistent with the time zone used to display date times values in the Outlook rich client interface, but may be different from the EAC time zone that Outlook on the web and mobile devices use in its user interface.</span></span>|<span data-ttu-id="6f975-144">如果此项的创建时间是 9am UTC：</span><span class="sxs-lookup"><span data-stu-id="6f975-144">If the item is created at 9am UTC:</span></span><br/><br/>`Office.mailbox.item.`<br/><span data-ttu-id="6f975-145">`dateTimeCreated.getHours` 返回 4am EST。</span><span class="sxs-lookup"><span data-stu-id="6f975-145">`dateTimeCreated.getHours` returns 4am EST.</span></span><br/><br/><span data-ttu-id="6f975-146">如果此项的修改时间是 11am UTC：</span><span class="sxs-lookup"><span data-stu-id="6f975-146">If the item is modified at 11am UTC:</span></span><br/><br/>`Office.mailbox.item.`<br/><span data-ttu-id="6f975-147">`dateTimeModified.getHours` 返回 6am EST。</span><span class="sxs-lookup"><span data-stu-id="6f975-147">`dateTimeModified.getHours` returns 6am EST.</span></span>|<span data-ttu-id="6f975-148">如果此项的创建时间是 9am UTC：</span><span class="sxs-lookup"><span data-stu-id="6f975-148">If the item creation time is 9am UTC:</span></span><br/><br/>`Office.mailbox.item.`</br><span data-ttu-id="6f975-149">`dateTimeCreated.getHours` 返回 4am EST。</span><span class="sxs-lookup"><span data-stu-id="6f975-149">`dateTimeCreated.getHours` returns 4am EST.</span></span><br/><br/><span data-ttu-id="6f975-150">如果此项的修改时间是 11am UTC：</span><span class="sxs-lookup"><span data-stu-id="6f975-150">If the item is modified at 11am UTC:</span></span><br/><br/>`Office.mailbox.item.`</br><span data-ttu-id="6f975-151">`dateTimeModified.getHours` 返回 6am EST。</span><span class="sxs-lookup"><span data-stu-id="6f975-151">`dateTimeModified.getHours` returns 6am EST.</span></span><br/><br/><span data-ttu-id="6f975-152">请注意，如果您想要在用户界面中显示创建或修改时间，要首先将时间转换为 PST 以与用户界面的其余部分保持一致。</span><span class="sxs-lookup"><span data-stu-id="6f975-152">Notice that if you want to display the creation or modification time in the user interface, you would want to first convert the time to PST to be consistent with the rest of the user interface.</span></span>
[<span data-ttu-id="6f975-153">Office.context.mailbox.displayNewAppointmentForm</span><span class="sxs-lookup"><span data-stu-id="6f975-153">Office.context.mailbox.displayNewAppointmentForm</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)|<span data-ttu-id="6f975-154">每个 _Start_ 和 _End_ 参数都需要一个 JavaScript **Date** 对象。</span><span class="sxs-lookup"><span data-stu-id="6f975-154">Each of the  _Start_ and _End_ parameters requires a JavaScript **Date** object.</span></span> <span data-ttu-id="6f975-155">参数应采用 UTC 格式，无论 Outlook 富客户端的用户界面中使用的时区或 web 或移动设备上的 Outlook 中使用的是何种时区。</span><span class="sxs-lookup"><span data-stu-id="6f975-155">The arguments should be UTC-correct regardless of the time zone used in the user interface of an Outlook rich client, or Outlook on the web or mobile devices.</span></span>|<span data-ttu-id="6f975-156">如果约会窗体的开始和结束时间分别是 9am UTC 和 11am UTC，则应确保 `start` 和 `end` 参数都是 UTC 格式，这意味着：</span><span class="sxs-lookup"><span data-stu-id="6f975-156">If the start and end times for the appointment form are 9am UTC and 11am UTC, then you should assure that the `start` and `end` arguments are UTC-correct, which means:</span></span><br/><br/><ul><li><span data-ttu-id="6f975-157">`start.getUTCHours` 返回 9am UTC</span><span class="sxs-lookup"><span data-stu-id="6f975-157">`start.getUTCHours` returns 9am UTC</span></span></li><li><span data-ttu-id="6f975-158">`end.getUTCHours` 返回 11am UTC</span><span class="sxs-lookup"><span data-stu-id="6f975-158">`end.getUTCHours` returns 11am UTC</span></span></li></ul>|<span data-ttu-id="6f975-159">如果约会窗体的开始和结束时间分别是 9am UTC 和 11am UTC，则应确保 `start` 和 `end` 参数都是 UTC 格式，这意味着：</span><span class="sxs-lookup"><span data-stu-id="6f975-159">If the start and end times for the appointment form are 9am UTC and 11am UTC, then you should assure that the `start` and `end` arguments are UTC-correct, which means:</span></span><br/><br/><ul><li><span data-ttu-id="6f975-160">`start.getUTCHours` 返回 9am UTC</span><span class="sxs-lookup"><span data-stu-id="6f975-160">`start.getUTCHours` returns 9am UTC</span></span></li><li><span data-ttu-id="6f975-161">`end.getUTCHours` 返回 11am UTC</span><span class="sxs-lookup"><span data-stu-id="6f975-161">`end.getUTCHours` returns 11am UTC</span></span></li></ul>

## <a name="helper-methods-for-date-related-scenarios"></a><span data-ttu-id="6f975-162">日期相关应用场景的帮助程序方法</span><span class="sxs-lookup"><span data-stu-id="6f975-162">Helper methods for date-related scenarios</span></span>


<span data-ttu-id="6f975-163">如前面各节中所述，由于 web 或移动设备上的 Outlook 中的用户的 "本地时间" 在 Outlook 富客户端中可能不同，但 JavaScript **Date**对象支持仅转换为客户端计算机时区或 UTC，适用于 Office 的 javascript API 提供了两种帮助程序方法： [convertToLocalClientTime](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)和[convertToUtcClientTime](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)。</span><span class="sxs-lookup"><span data-stu-id="6f975-163">As described in the preceding sections, because the "local time" for a user in Outlook on the web or mobile devices can be different on an Outlook rich client, but the JavaScript **Date** object supports converting to only the client computer time zone or UTC, the JavaScript API for Office provides two helper methods: [Office.context.mailbox.convertToLocalClientTime](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods) and [Office.context.mailbox.convertToUtcClientTime](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods).</span></span>

<span data-ttu-id="6f975-164">这些帮助程序方法负责在 Outlook 富客户端、web 和移动设备上的 outlook 富客户端、Outlook 网页版和移动设备上为以下两个与日期相关的方案处理日期或时间的任何需求，从而为外接程序的不同客户端加强 "一次性写入"。</span><span class="sxs-lookup"><span data-stu-id="6f975-164">These helper methods take care of any need to handle date or time differently for the following two date-related scenarios, in an Outlook rich client, Outlook on the web and mobile devices, thus reinforcing "write-once" for different clients of your add-in.</span></span>


### <a name="scenario-a-displaying-item-creation-or-modified-time"></a><span data-ttu-id="6f975-165">应用场景 A：显示项创建时间或修改时间</span><span class="sxs-lookup"><span data-stu-id="6f975-165">Scenario A: Displaying item creation or modified time</span></span>

<span data-ttu-id="6f975-166">如果要在用户界面中显示项创建时间 (**Item.dateTimeCreated**) 或修改时间 (**Item.dateTimeModified**)，请首先使用 **convertToLocalClientTime** 转换这些属性提供的 **Date** 对象以获取采用正确本地时间的字典表示形式。</span><span class="sxs-lookup"><span data-stu-id="6f975-166">If you are displaying the item creation time (**Item.dateTimeCreated**) or modification time (**Item.dateTimeModified**) in the user interface, first use **convertToLocalClientTime** to convert the **Date** object provided by these properties to obtain a dictionary representation in the appropriate local time.</span></span> <span data-ttu-id="6f975-167">然后显示字典日期的各个部分。</span><span class="sxs-lookup"><span data-stu-id="6f975-167">Then display the parts of the dictionary date.</span></span> <span data-ttu-id="6f975-168">下面是此应用场景的一个示例：</span><span class="sxs-lookup"><span data-stu-id="6f975-168">The following is an example of this scenario:</span></span>


```js
// This date is UTC-correct.
var myDate = Office.context.mailbox.item.dateTimeCreated;

// Call helper method to get date in dictionary format, 
// represented in the appropriate local time.
// In an Outlook rich client, this is dictionary format 
// in client computer time zone.
// In Outlook on the web or mobile devices, this dictionary 
// format is in EAC time zone.
var myLocalDictionaryDate = Office.context.mailbox.convertToLocalClientTime(myDate);

// Display different parts of the dictionary date.
document.write ("The item was created at " + myLocalDictionaryDate["hours"] + 
    ":" + myLocalDictionaryDate["minutes"]);)
```

<span data-ttu-id="6f975-169">请注意， **convertToLocalClientTime**会考虑 outlook 富客户端和 web 或移动设备上的 outlook 之间的差异：</span><span class="sxs-lookup"><span data-stu-id="6f975-169">Note that **convertToLocalClientTime** takes care of the difference between an Outlook rich client, and Outlook on the web or mobile devices:</span></span>


- <span data-ttu-id="6f975-170">如果 **convertToLocalClientTime** 检测到当前的主机为富客户端，那么该方法使用同一客户端计算机时区（与富客户端用户界面的其余部分保持一致）将 **Date** 表示形式转换为字典表示形式。</span><span class="sxs-lookup"><span data-stu-id="6f975-170">If **convertToLocalClientTime** detects the current host is a rich client, the method converts the **Date** representation to a dictionary representation in the same client computer time zone, consistent with the rest of the rich client user interface.</span></span>
    
- <span data-ttu-id="6f975-171">如果**convertToLocalClientTime**检测到当前主机是在 web 或移动设备上的 outlook，则此方法会将 UTC 格式的**日期**表示形式转换为 EAC 时区中的词典格式，与 Outlook 在 web 或移动设备用户界面上的其余部分保持一致。</span><span class="sxs-lookup"><span data-stu-id="6f975-171">If **convertToLocalClientTime** detects the current host is Outlook on the web or mobile devices, the method converts the UTC-correct **Date** representation to a dictionary format in the EAC time zone, consistent with the rest of the Outlook on the web or mobile devices user interface.</span></span>
    

### <a name="scenario-b-displaying-start-and-end-dates-in-a-new-appointment-form"></a><span data-ttu-id="6f975-172">应用场景 B：在新的约会窗体中显示开始日期和结束日期</span><span class="sxs-lookup"><span data-stu-id="6f975-172">Scenario B: Displaying start and end dates in a new appointment form</span></span>

<span data-ttu-id="6f975-173">如果要获取作为输入不同组成部分的以本地时间形式表示的日期时间值，并且希望在约会窗体中将该字典输入值作为开始或结束时间提供，请首先使用 **convertToUtcClientTime** 帮助程序方法将字典值转换为采用 UTC 格式的 **Date** 对象。</span><span class="sxs-lookup"><span data-stu-id="6f975-173">If you are obtaining as input different parts of a date-time value represented in the local time, and would like to provide this dictionary input value as a start or end time in an appointment form, first use the **convertToUtcClientTime** helper method to convert the dictionary value to a UTC-correct **Date** object.</span></span>

<span data-ttu-id="6f975-p110">在以下示例中，假定 `myLocalDictionaryStartDate` 和 `myLocalDictionaryEndDate` 是从用户获得的采用字典格式的日期时间值。这些值基于本地时间，具体取决于主机应用程序。</span><span class="sxs-lookup"><span data-stu-id="6f975-p110">In the following example, assume  `myLocalDictionaryStartDate` and `myLocalDictionaryEndDate` are date-time values in dictionary format that you have obtained from the user. These values are based on the local time, dependent on the host application.</span></span>

```js
var myUTCCorrectStartDate = Office.context.mailbox.convertToUtcClientTime(myLocalDictionaryStartDate);
var myUTCCorrectEndDate = Office.context.mailbox.convertToUtcClientTime(myLocalDictionaryEndDate);

```

<span data-ttu-id="6f975-176">结果值 `myUTCCorrectStartDate` 和 `myUTCCorrectEndDate` 采用 UTC 格式。</span><span class="sxs-lookup"><span data-stu-id="6f975-176">The resultant values,  `myUTCCorrectStartDate` and `myUTCCorrectEndDate`, are UTC-correct.</span></span> <span data-ttu-id="6f975-177">然后将这些 **Date** 对象作为 **Mailbox.displayNewAppointmentForm** 方法的 _Start_ 和 _End_ 参数的自变量来显示新约会窗体。</span><span class="sxs-lookup"><span data-stu-id="6f975-177">Then pass these **Date** objects as arguments for the _Start_ and _End_ parameters of the **Mailbox.displayNewAppointmentForm** method to display the new appointment form.</span></span>

<span data-ttu-id="6f975-178">请注意， **convertToUtcClientTime**会考虑 outlook 富客户端和 web 或移动设备上的 outlook 之间的差异：</span><span class="sxs-lookup"><span data-stu-id="6f975-178">Note that **convertToUtcClientTime** takes care of the difference between an Outlook rich client, and Outlook on the web or mobile devices:</span></span>


- <span data-ttu-id="6f975-179">如果 **convertToUtcClientTime** 检测到当前主机为 Outlook 富客户端，那么该方法只是将字典表示形式转换为 **Date** 对象。</span><span class="sxs-lookup"><span data-stu-id="6f975-179">If **convertToUtcClientTime** detects the current host is an Outlook rich client, the method simply converts the dictionary representation to a **Date** object.</span></span> <span data-ttu-id="6f975-180">此 **Date** 对象采用 UTC 格式，正如 **displayNewAppointmentForm** 期望的那样。</span><span class="sxs-lookup"><span data-stu-id="6f975-180">This **Date** object is UTC-correct, as expected by **displayNewAppointmentForm**.</span></span>
    
- <span data-ttu-id="6f975-181">如果**convertToUtcClientTime**检测到当前主机是在 web 或移动设备上使用 Outlook，则此方法会将在 EAC 时区中表示的日期和时间值的词典格式转换为**date**对象。</span><span class="sxs-lookup"><span data-stu-id="6f975-181">If **convertToUtcClientTime** detects the current host is Outlook on the web or mobile devices, the method converts the dictionary format of the date and time values expressed in the EAC time zone to a **Date** object.</span></span> <span data-ttu-id="6f975-182">此 **Date** 对象采用 UTC 格式，正如 **displayNewAppointmentForm** 期望的那样。</span><span class="sxs-lookup"><span data-stu-id="6f975-182">This **Date** object is UTC-correct, as expected by **displayNewAppointmentForm**.</span></span>
    

## <a name="see-also"></a><span data-ttu-id="6f975-183">另请参阅</span><span class="sxs-lookup"><span data-stu-id="6f975-183">See also</span></span>

- [<span data-ttu-id="6f975-184">部署和安装 Outlook 加载项以进行测试</span><span class="sxs-lookup"><span data-stu-id="6f975-184">Deploy and install Outlook add-ins for testing</span></span>](testing-and-tips.md)
    


