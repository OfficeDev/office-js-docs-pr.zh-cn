---
title: 处理 Outlook 加载项中的日期值
description: Office JavaScript API 将 JavaScript Date 对象用于大多数日期和时间的存储和检索。
ms.date: 10/31/2019
localization_priority: Normal
ms.openlocfilehash: 48cbc407e21e377ed64dc873574d938b136bfd22
ms.sourcegitcommit: 9609bd5b4982cdaa2ea7637709a78a45835ffb19
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/28/2020
ms.locfileid: "47292564"
---
# <a name="tips-for-handling-date-values-in-outlook-add-ins"></a><span data-ttu-id="61e84-103">处理 Outlook 加载项中的日期值的提示</span><span class="sxs-lookup"><span data-stu-id="61e84-103">Tips for handling date values in Outlook add-ins</span></span>

<span data-ttu-id="61e84-104">Office JavaScript API 将 JavaScript [Date](https://www.w3schools.com/jsref/jsref_obj_date.asp) 对象用于大多数日期和时间的存储和检索。</span><span class="sxs-lookup"><span data-stu-id="61e84-104">The Office JavaScript API uses the JavaScript [Date](https://www.w3schools.com/jsref/jsref_obj_date.asp) object for most of the storage and retrieval of dates and times.</span></span> 

<span data-ttu-id="61e84-105">该 `Date` 对象提供诸如 [getUTCDate](https://www.w3schools.com/jsref/jsref_getutcdate.asp)、 [GetUTCHour](https://www.w3schools.com/jsref/jsref_getutchours.asp)、 [getUTCMinutes](https://www.w3schools.com/jsref/jsref_getutcminutes.asp)和 [toUTCString](https://www.w3schools.com/jsref/jsref_toutcstring.asp)的方法，这将根据 UTC) 时间 (的通用协调时间返回请求的日期或时间值。</span><span class="sxs-lookup"><span data-stu-id="61e84-105">That `Date` object provides methods such as [getUTCDate](https://www.w3schools.com/jsref/jsref_getutcdate.asp), [getUTCHour](https://www.w3schools.com/jsref/jsref_getutchours.asp), [getUTCMinutes](https://www.w3schools.com/jsref/jsref_getutcminutes.asp), and [toUTCString](https://www.w3schools.com/jsref/jsref_toutcstring.asp), which return the requested date or time value according to Universal Coordinated Time (UTC) time.</span></span>

<span data-ttu-id="61e84-106">该 `Date` 对象还提供了其他方法，如 [getDate](https://www.w3schools.com/jsref/jsref_getutcdate.asp)、 [GetHour](https://www.w3schools.com/jsref/jsref_getutchours.asp)、 [getMinutes](https://www.w3schools.com/jsref/jsref_getminutes.asp)和 [toString](https://www.w3schools.com/jsref/jsref_tostring_date.asp)，这将根据 "本地时间" 返回请求的日期或时间。</span><span class="sxs-lookup"><span data-stu-id="61e84-106">The `Date` object also provides other methods such as [getDate](https://www.w3schools.com/jsref/jsref_getutcdate.asp), [getHour](https://www.w3schools.com/jsref/jsref_getutchours.asp), [getMinutes](https://www.w3schools.com/jsref/jsref_getminutes.asp), and [toString](https://www.w3schools.com/jsref/jsref_tostring_date.asp), which return the requested date or time according to "local time".</span></span>

<span data-ttu-id="61e84-107">“本地时间”概念很大程度上取决于客户端计算机上的浏览器和操作系统。</span><span class="sxs-lookup"><span data-stu-id="61e84-107">The concept of "local time" is largely determined by the browser and operating system on the client computer.</span></span> <span data-ttu-id="61e84-108">例如，在基于 Windows 的客户端计算机上运行的大多数浏览器上，基于在 `getDate` 客户端计算机上的 windows 中设置的时区，对进行的 JavaScript 调用将返回一个日期。</span><span class="sxs-lookup"><span data-stu-id="61e84-108">For instance, on most browsers running on a Windows-based client computer, a JavaScript call to `getDate`, returns a date based on the time zone set in Windows on the client computer.</span></span>

<span data-ttu-id="61e84-109">下面的示例将创建 `Date` 一个 `myLocalDate` 本地时间对象，并调用将 `toUTCString` 该日期转换为 UTC 格式的日期字符串。</span><span class="sxs-lookup"><span data-stu-id="61e84-109">The following example creates a `Date` object `myLocalDate` in local time, and calls `toUTCString` to convert that date to a date string in UTC.</span></span>

```js
// Create and get the current date represented 
// in the client computer time zone.
var myLocalDate = new Date (); 

// Convert the Date value in the client computer time zone
// to a date string in UTC, and display the string.
document.write ("The current UTC time is " + 
    myLocalDate.toUTCString());
```

<span data-ttu-id="61e84-110">虽然您可以使用 JavaScript `Date` 对象来获取基于 UTC 或客户端计算机时区的日期或时间值，但在一个方面限制 **日期** 对象，但它不会提供返回任何其他特定时区的日期或时间值的方法。</span><span class="sxs-lookup"><span data-stu-id="61e84-110">While you can use the JavaScript `Date` object to get a date or time value based on UTC or the client computer time zone, the **Date** object is limited in one respect - it does not provide methods to return a date or time value for any other specific time zone.</span></span> <span data-ttu-id="61e84-111">例如，如果您的客户端计算机设置为在东部标准时间 (EST) 中，则没有任何 `Date` 方法允许您获取除 EST 或 UTC 之外的小时值，例如太平洋标准时间 (PST) 。</span><span class="sxs-lookup"><span data-stu-id="61e84-111">For example, if your client computer is set to be on Eastern Standard Time (EST), there is no `Date` method that allows you to get the hour value other than in EST or UTC, such as Pacific Standard Time (PST).</span></span>


## <a name="date-related-features-for-outlook-add-ins"></a><span data-ttu-id="61e84-112">Outlook 加载项的日期相关功能</span><span class="sxs-lookup"><span data-stu-id="61e84-112">Date-related features for Outlook add-ins</span></span>

<span data-ttu-id="61e84-113">当您使用 Office JavaScript API 在 outlook 富客户端中运行的 Outlook 外接程序中，以及在 Outlook 网页版或移动设备上运行时，上述 JavaScript 限制会给您暗示。</span><span class="sxs-lookup"><span data-stu-id="61e84-113">The aforementioned JavaScript limitation has an implication for you, when you use the Office JavaScript API to handle date or time values in Outlook add-ins that run in an Outlook rich client, and in Outlook on the web or mobile devices.</span></span>


### <a name="time-zones-for-outlook-clients"></a><span data-ttu-id="61e84-114">Outlook 客户端的时区</span><span class="sxs-lookup"><span data-stu-id="61e84-114">Time zones for Outlook clients</span></span>

<span data-ttu-id="61e84-115">为清楚起见，让我们先定义要讨论的时区。</span><span class="sxs-lookup"><span data-stu-id="61e84-115">For clarity, let's define the time zones in question.</span></span>

|<span data-ttu-id="61e84-116">**时区**</span><span class="sxs-lookup"><span data-stu-id="61e84-116">**Time zone**</span></span>|<span data-ttu-id="61e84-117">**说明**</span><span class="sxs-lookup"><span data-stu-id="61e84-117">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="61e84-118">客户端计算机时区</span><span class="sxs-lookup"><span data-stu-id="61e84-118">Client computer time zone</span></span>|<span data-ttu-id="61e84-119">这在客户端计算机的操作系统上设置。</span><span class="sxs-lookup"><span data-stu-id="61e84-119">This is set on the operating system of the client computer.</span></span> <span data-ttu-id="61e84-120">大多数浏览器都使用客户端计算机时区显示 JavaScript 对象的日期或时间值 `Date` 。</span><span class="sxs-lookup"><span data-stu-id="61e84-120">Most browsers use the client computer time zone to display date or time values of the JavaScript `Date` object.</span></span><br/><br/><span data-ttu-id="61e84-121">Outlook 富客户端使用此时区在用户界面中显示日期或时间值。</span><span class="sxs-lookup"><span data-stu-id="61e84-121">An Outlook rich client uses this time zone to display date or time values in the user interface.</span></span> <br/><br/><span data-ttu-id="61e84-122">例如，在运行 Windows 的客户端计算机上，Outlook 将使用 Windows 上设置的时区作为本地时区。</span><span class="sxs-lookup"><span data-stu-id="61e84-122">For example, on a client computer running Windows, Outlook uses the time zone set on Windows as the local time zone.</span></span> <span data-ttu-id="61e84-123">在 Mac 上，如果用户更改了客户端计算机上的时区，Mac 上的 Outlook 也会提示用户在 Outlook 中更新时区。</span><span class="sxs-lookup"><span data-stu-id="61e84-123">On the Mac, if the user changes the time zone on the client computer, Outlook on Mac would prompt the user to update the time zone in Outlook as well.</span></span>|
|<span data-ttu-id="61e84-124">Exchange 管理中心 (EAC) 时区</span><span class="sxs-lookup"><span data-stu-id="61e84-124">Exchange Admin Center (EAC) time zone</span></span>|<span data-ttu-id="61e84-125">用户将此时区值设置 (，首次登录到 web 或移动设备上的 Outlook 时) 首选语言。</span><span class="sxs-lookup"><span data-stu-id="61e84-125">The user sets this time zone value (and the preferred language) when he or she logs on to Outlook on the web or mobile devices the first time.</span></span> <br/><br/><span data-ttu-id="61e84-126">Web 和移动设备上的 Outlook 使用此时区在用户界面中显示日期或时间值。</span><span class="sxs-lookup"><span data-stu-id="61e84-126">Outlook on the web and mobile devices use this time zone to display date or time values in the user interface.</span></span>|

<span data-ttu-id="61e84-127">由于 Outlook 富客户端使用的是客户端计算机时区，web 上的 Outlook 和移动设备上的用户界面使用 EAC 时区，因此在 Outlook 富客户端和 web 或移动设备上的 Outlook 中运行相同的加载项时，为同一邮箱安装的本地时间可能会有所不同。</span><span class="sxs-lookup"><span data-stu-id="61e84-127">Because an Outlook rich client uses the client computer time zone, and the user interface of Outlook on the web and mobile devices uses the EAC time zone, the local time for the same add-in installed for the same mailbox can be different when running in an Outlook rich client and in Outlook on the web or mobile devices.</span></span> <span data-ttu-id="61e84-128">作为 Outlook 外接程序开发人员，您应该正确输入和输出日期值，以便那些值始终与用户期望的相应客户端上的时区保持一致。</span><span class="sxs-lookup"><span data-stu-id="61e84-128">As an Outlook add-in developer, you should appropriately input and output date values so that those values are always consistent with the time zone that the user expects on the corresponding client.</span></span>


### <a name="date-related-api"></a><span data-ttu-id="61e84-129">日期相关的 API</span><span class="sxs-lookup"><span data-stu-id="61e84-129">Date-related API</span></span>

<span data-ttu-id="61e84-130">以下是 Office JavaScript API 中支持日期相关功能的属性和方法。</span><span class="sxs-lookup"><span data-stu-id="61e84-130">The following are the properties and methods in the Office JavaScript API that support date-related features.</span></span>

<span data-ttu-id="61e84-131">**API 成员**</span><span class="sxs-lookup"><span data-stu-id="61e84-131">**API member**</span></span>|<span data-ttu-id="61e84-132">**时区表示形式**</span><span class="sxs-lookup"><span data-stu-id="61e84-132">**Time zone representation**</span></span>|<span data-ttu-id="61e84-133">**Outlook 富客户端中的示例**</span><span class="sxs-lookup"><span data-stu-id="61e84-133">**Example in an Outlook rich client**</span></span>|<span data-ttu-id="61e84-134">**Web 或移动设备上的 Outlook 中的示例**</span><span class="sxs-lookup"><span data-stu-id="61e84-134">**Example in Outlook on the web or mobile devices**</span></span>
--------------|----------------------------|-------------------------------------|-------------------
[<span data-ttu-id="61e84-135">Office.context.mailbox.userProfile.timeZone</span><span class="sxs-lookup"><span data-stu-id="61e84-135">Office.context.mailbox.userProfile.timeZone</span></span>](/javascript/api/outlook/office.userprofile?view=outlook-js-preview#timezone)|<span data-ttu-id="61e84-136">在 Outlook 富客户端中，此属性返回客户端计算机时区。</span><span class="sxs-lookup"><span data-stu-id="61e84-136">In an Outlook rich client, this property returns the client computer time zone.</span></span> <span data-ttu-id="61e84-137">在 web 和移动设备上的 Outlook 中，此属性返回 EAC 时区。</span><span class="sxs-lookup"><span data-stu-id="61e84-137">In Outlook on the web and mobile devices, this property returns the EAC time zone.</span></span> |<span data-ttu-id="61e84-138">EST</span><span class="sxs-lookup"><span data-stu-id="61e84-138">EST</span></span>|<span data-ttu-id="61e84-139">PST</span><span class="sxs-lookup"><span data-stu-id="61e84-139">PST</span></span>
<span data-ttu-id="61e84-140">[Office.context.mailbox.item.dateTimeCreated](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties) 和 [Office.context.mailbox.item.dateTimeModified](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)</span><span class="sxs-lookup"><span data-stu-id="61e84-140">[Office.context.mailbox.item.dateTimeCreated](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties) and [Office.context.mailbox.item.dateTimeModified](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)</span></span>|<span data-ttu-id="61e84-141">这些属性中的每一个都返回一个 JavaScript `Date` 对象。</span><span class="sxs-lookup"><span data-stu-id="61e84-141">Each of these properties returns a JavaScript `Date` object.</span></span> <span data-ttu-id="61e84-142">此 `Date` 值是 UTC 正确的，如以下示例中所示- `myUTCDate` outlook 富客户端中的值相同，outlook 网页版和移动设备上具有相同的值。</span><span class="sxs-lookup"><span data-stu-id="61e84-142">This `Date` value is UTC-correct, as shown in the following example - `myUTCDate` has the same value in an Outlook rich client, Outlook on the web and mobile devices.</span></span><br/><br/>`var myDate = Office.mailbox.item.dateTimeCreated;`<br/>`var myUTCDate = myDate.getUTCDate;`<br/><br/><span data-ttu-id="61e84-143">但是，调用将  `myDate.getDate` 返回客户端计算机时区中的 date 值，这与用于在 outlook 富客户端界面中显示日期时间值的时区一致，但可能不同于 web 和移动设备上的用户界面中使用的 EAC 时区。</span><span class="sxs-lookup"><span data-stu-id="61e84-143">However, calling  `myDate.getDate` returns a date value in the client computer time zone, which is consistent with the time zone used to display date times values in the Outlook rich client interface, but may be different from the EAC time zone that Outlook on the web and mobile devices use in its user interface.</span></span>|<span data-ttu-id="61e84-144">如果此项的创建时间是 9am UTC：</span><span class="sxs-lookup"><span data-stu-id="61e84-144">If the item is created at 9am UTC:</span></span><br/><br/>`Office.mailbox.item.`<br/><span data-ttu-id="61e84-145">`dateTimeCreated.getHours` 返回 4am EST。</span><span class="sxs-lookup"><span data-stu-id="61e84-145">`dateTimeCreated.getHours` returns 4am EST.</span></span><br/><br/><span data-ttu-id="61e84-146">如果此项的修改时间是 11am UTC：</span><span class="sxs-lookup"><span data-stu-id="61e84-146">If the item is modified at 11am UTC:</span></span><br/><br/>`Office.mailbox.item.`<br/><span data-ttu-id="61e84-147">`dateTimeModified.getHours` 返回 6am EST。</span><span class="sxs-lookup"><span data-stu-id="61e84-147">`dateTimeModified.getHours` returns 6am EST.</span></span>|<span data-ttu-id="61e84-148">如果此项的创建时间是 9am UTC：</span><span class="sxs-lookup"><span data-stu-id="61e84-148">If the item creation time is 9am UTC:</span></span><br/><br/>`Office.mailbox.item.`</br><span data-ttu-id="61e84-149">`dateTimeCreated.getHours` 返回 4am EST。</span><span class="sxs-lookup"><span data-stu-id="61e84-149">`dateTimeCreated.getHours` returns 4am EST.</span></span><br/><br/><span data-ttu-id="61e84-150">如果此项的修改时间是 11am UTC：</span><span class="sxs-lookup"><span data-stu-id="61e84-150">If the item is modified at 11am UTC:</span></span><br/><br/>`Office.mailbox.item.`</br><span data-ttu-id="61e84-151">`dateTimeModified.getHours` 返回 6am EST。</span><span class="sxs-lookup"><span data-stu-id="61e84-151">`dateTimeModified.getHours` returns 6am EST.</span></span><br/><br/><span data-ttu-id="61e84-152">请注意，如果您想要在用户界面中显示创建或修改时间，要首先将时间转换为 PST 以与用户界面的其余部分保持一致。</span><span class="sxs-lookup"><span data-stu-id="61e84-152">Notice that if you want to display the creation or modification time in the user interface, you would want to first convert the time to PST to be consistent with the rest of the user interface.</span></span>
[<span data-ttu-id="61e84-153">Office.context.mailbox.displayNewAppointmentForm</span><span class="sxs-lookup"><span data-stu-id="61e84-153">Office.context.mailbox.displayNewAppointmentForm</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)|<span data-ttu-id="61e84-154">每个  _Start_ 和 _End_ 参数都需要一个 JavaScript `Date` 对象。</span><span class="sxs-lookup"><span data-stu-id="61e84-154">Each of the  _Start_ and _End_ parameters requires a JavaScript `Date` object.</span></span> <span data-ttu-id="61e84-155">参数应采用 UTC 格式，无论 Outlook 富客户端的用户界面中使用的时区或 web 或移动设备上的 Outlook 中使用的是何种时区。</span><span class="sxs-lookup"><span data-stu-id="61e84-155">The arguments should be UTC-correct regardless of the time zone used in the user interface of an Outlook rich client, or Outlook on the web or mobile devices.</span></span>|<span data-ttu-id="61e84-156">如果约会窗体的开始和结束时间分别是 9am UTC 和 11am UTC，则应确保 `start` 和 `end` 参数都是 UTC 格式，这意味着：</span><span class="sxs-lookup"><span data-stu-id="61e84-156">If the start and end times for the appointment form are 9am UTC and 11am UTC, then you should assure that the `start` and `end` arguments are UTC-correct, which means:</span></span><br/><br/><ul><li><span data-ttu-id="61e84-157">`start.getUTCHours` 返回 9am UTC</span><span class="sxs-lookup"><span data-stu-id="61e84-157">`start.getUTCHours` returns 9am UTC</span></span></li><li><span data-ttu-id="61e84-158">`end.getUTCHours` 返回 11am UTC</span><span class="sxs-lookup"><span data-stu-id="61e84-158">`end.getUTCHours` returns 11am UTC</span></span></li></ul>|<span data-ttu-id="61e84-159">如果约会窗体的开始和结束时间分别是 9am UTC 和 11am UTC，则应确保 `start` 和 `end` 参数都是 UTC 格式，这意味着：</span><span class="sxs-lookup"><span data-stu-id="61e84-159">If the start and end times for the appointment form are 9am UTC and 11am UTC, then you should assure that the `start` and `end` arguments are UTC-correct, which means:</span></span><br/><br/><ul><li><span data-ttu-id="61e84-160">`start.getUTCHours` 返回 9am UTC</span><span class="sxs-lookup"><span data-stu-id="61e84-160">`start.getUTCHours` returns 9am UTC</span></span></li><li><span data-ttu-id="61e84-161">`end.getUTCHours` 返回 11am UTC</span><span class="sxs-lookup"><span data-stu-id="61e84-161">`end.getUTCHours` returns 11am UTC</span></span></li></ul>

## <a name="helper-methods-for-date-related-scenarios"></a><span data-ttu-id="61e84-162">日期相关应用场景的帮助程序方法</span><span class="sxs-lookup"><span data-stu-id="61e84-162">Helper methods for date-related scenarios</span></span>


<span data-ttu-id="61e84-163">如前面的部分中所述，由于 web 或移动设备上的 Outlook 中的用户的 "本地时间" 在 Outlook 富客户端中可能不同，但 JavaScript **Date** 对象支持仅转换为客户端计算机时区或 UTC，而 OFFICE JavaScript API 提供了两种帮助程序方法： [convertToLocalClientTime](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods) 和 [convertToUtcClientTime](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)。</span><span class="sxs-lookup"><span data-stu-id="61e84-163">As described in the preceding sections, because the "local time" for a user in Outlook on the web or mobile devices can be different on an Outlook rich client, but the JavaScript **Date** object supports converting to only the client computer time zone or UTC, the Office JavaScript API provides two helper methods: [Office.context.mailbox.convertToLocalClientTime](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods) and [Office.context.mailbox.convertToUtcClientTime](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods).</span></span>

<span data-ttu-id="61e84-164">这些帮助程序方法负责在 Outlook 富客户端、web 和移动设备上的 outlook 富客户端、Outlook 网页版和移动设备上为以下两个与日期相关的方案处理日期或时间的任何需求，从而为外接程序的不同客户端加强 "一次性写入"。</span><span class="sxs-lookup"><span data-stu-id="61e84-164">These helper methods take care of any need to handle date or time differently for the following two date-related scenarios, in an Outlook rich client, Outlook on the web and mobile devices, thus reinforcing "write-once" for different clients of your add-in.</span></span>


### <a name="scenario-a-displaying-item-creation-or-modified-time"></a><span data-ttu-id="61e84-165">应用场景 A：显示项创建时间或修改时间</span><span class="sxs-lookup"><span data-stu-id="61e84-165">Scenario A: Displaying item creation or modified time</span></span>

<span data-ttu-id="61e84-166">如果要在用户界面中显示项目创建时间 (`Item.dateTimeCreated`) 或修改时间 (`Item.dateTimeModified` ，请首先使用 `convertToLocalClientTime` 来转换 `Date` 这些属性提供的对象，以在适当的当地时间获取字典表示形式。</span><span class="sxs-lookup"><span data-stu-id="61e84-166">If you are displaying the item creation time (`Item.dateTimeCreated`) or modification time (`Item.dateTimeModified`in the user interface, first use `convertToLocalClientTime` to convert the `Date` object provided by these properties to obtain a dictionary representation in the appropriate local time.</span></span> <span data-ttu-id="61e84-167">然后显示字典日期的各个部分。</span><span class="sxs-lookup"><span data-stu-id="61e84-167">Then display the parts of the dictionary date.</span></span> <span data-ttu-id="61e84-168">下面是此应用场景的一个示例：</span><span class="sxs-lookup"><span data-stu-id="61e84-168">The following is an example of this scenario:</span></span>


```js
// This date is UTC-correct.
var myDate = Office.context.mailbox.item.dateTimeCreated;

// Call helper method to get date in dictionary format, 
// represented in the appropriate local time.
// In an Outlook rich client, this is dictionary format 
// in client computer time zone.
// In Outlook on the web or mobile devices, this dictionary 
// format is in EAC time zone.
var myLocalDictionaryDate = Office.context.mailbox.convertToLocalClientTime(myDate);

// Display different parts of the dictionary date.
document.write ("The item was created at " + myLocalDictionaryDate["hours"] + 
    ":" + myLocalDictionaryDate["minutes"]);)
```

<span data-ttu-id="61e84-169">请注意， `convertToLocalClientTime` 解决 outlook 富客户端和 web 或移动设备上的 outlook 之间的差异：</span><span class="sxs-lookup"><span data-stu-id="61e84-169">Note that `convertToLocalClientTime` takes care of the difference between an Outlook rich client, and Outlook on the web or mobile devices:</span></span>


- <span data-ttu-id="61e84-170">如果 `convertToLocalClientTime` 检测到当前应用程序是富客户端，则此方法会将 `Date` 表示形式转换为同一客户端计算机时区中的字典表示形式，与富客户端用户界面的其余部分一致。</span><span class="sxs-lookup"><span data-stu-id="61e84-170">If `convertToLocalClientTime` detects the current application is a rich client, the method converts the `Date` representation to a dictionary representation in the same client computer time zone, consistent with the rest of the rich client user interface.</span></span>
    
- <span data-ttu-id="61e84-171">如果 `convertToLocalClientTime` 检测到当前应用程序是在 web 或移动设备上的 outlook，则此方法会将 UTC `Date` 格式的表示形式转换为 EAC 时区中的词典格式，与 Outlook 在 web 或移动设备用户界面上的其余部分保持一致。</span><span class="sxs-lookup"><span data-stu-id="61e84-171">If `convertToLocalClientTime` detects the current application is Outlook on the web or mobile devices, the method converts the UTC-correct `Date` representation to a dictionary format in the EAC time zone, consistent with the rest of the Outlook on the web or mobile devices user interface.</span></span>
    

### <a name="scenario-b-displaying-start-and-end-dates-in-a-new-appointment-form"></a><span data-ttu-id="61e84-172">应用场景 B：在新的约会窗体中显示开始日期和结束日期</span><span class="sxs-lookup"><span data-stu-id="61e84-172">Scenario B: Displaying start and end dates in a new appointment form</span></span>

<span data-ttu-id="61e84-173">如果要获取以本地时间表示的日期时间值的输入不同部分，并且希望在约会窗体中提供此字典输入值作为开始时间或结束时间，请首先使用 `convertToUtcClientTime` helper 方法将字典值转换为与 UTC 正确关联的 `Date` 对象。</span><span class="sxs-lookup"><span data-stu-id="61e84-173">If you are obtaining as input different parts of a date-time value represented in the local time, and would like to provide this dictionary input value as a start or end time in an appointment form, first use the `convertToUtcClientTime` helper method to convert the dictionary value to a UTC-correct `Date` object.</span></span>

<span data-ttu-id="61e84-174">在以下示例中，假定 `myLocalDictionaryStartDate` 和 `myLocalDictionaryEndDate` 是从用户获得的采用字典格式的日期时间值。</span><span class="sxs-lookup"><span data-stu-id="61e84-174">In the following example, assume  `myLocalDictionaryStartDate` and `myLocalDictionaryEndDate` are date-time values in dictionary format that you have obtained from the user.</span></span> <span data-ttu-id="61e84-175">这些值基于本地时间，具体取决于客户端平台。</span><span class="sxs-lookup"><span data-stu-id="61e84-175">These values are based on the local time, dependent on the client platform.</span></span>

```js
var myUTCCorrectStartDate = Office.context.mailbox.convertToUtcClientTime(myLocalDictionaryStartDate);
var myUTCCorrectEndDate = Office.context.mailbox.convertToUtcClientTime(myLocalDictionaryEndDate);

```

<span data-ttu-id="61e84-176">结果值 `myUTCCorrectStartDate` 和 `myUTCCorrectEndDate` 采用 UTC 格式。</span><span class="sxs-lookup"><span data-stu-id="61e84-176">The resultant values,  `myUTCCorrectStartDate` and `myUTCCorrectEndDate`, are UTC-correct.</span></span> <span data-ttu-id="61e84-177">然后，将这些 `Date` 对象作为参数传递给方法的 _Start_ 和 _End_ 参数 `Mailbox.displayNewAppointmentForm` ，以显示新的约会窗体。</span><span class="sxs-lookup"><span data-stu-id="61e84-177">Then pass these `Date` objects as arguments for the _Start_ and _End_ parameters of the `Mailbox.displayNewAppointmentForm` method to display the new appointment form.</span></span>

<span data-ttu-id="61e84-178">请注意， `convertToUtcClientTime` 解决 outlook 富客户端和 web 或移动设备上的 outlook 之间的差异：</span><span class="sxs-lookup"><span data-stu-id="61e84-178">Note that `convertToUtcClientTime` takes care of the difference between an Outlook rich client, and Outlook on the web or mobile devices:</span></span>


- <span data-ttu-id="61e84-179">如果 `convertToUtcClientTime` 检测到当前应用程序是 Outlook 富客户端，则此方法只是将字典表示形式转换为 `Date` 对象。</span><span class="sxs-lookup"><span data-stu-id="61e84-179">If `convertToUtcClientTime` detects the current application is an Outlook rich client, the method simply converts the dictionary representation to a `Date` object.</span></span> <span data-ttu-id="61e84-180">此 `Date` 对象按所需的 UTC 格式正确 `displayNewAppointmentForm` 。</span><span class="sxs-lookup"><span data-stu-id="61e84-180">This `Date` object is UTC-correct, as expected by `displayNewAppointmentForm`.</span></span>
    
- <span data-ttu-id="61e84-181">如果 `convertToUtcClientTime` 检测到当前应用程序是在 web 或移动设备上的 Outlook，则此方法会将在 EAC 时区中表示的日期和时间值的词典格式转换为 `Date` 对象。</span><span class="sxs-lookup"><span data-stu-id="61e84-181">If `convertToUtcClientTime` detects the current application is Outlook on the web or mobile devices, the method converts the dictionary format of the date and time values expressed in the EAC time zone to a `Date` object.</span></span> <span data-ttu-id="61e84-182">此 `Date` 对象按所需的 UTC 格式正确 `displayNewAppointmentForm` 。</span><span class="sxs-lookup"><span data-stu-id="61e84-182">This `Date` object is UTC-correct, as expected by `displayNewAppointmentForm`.</span></span>
    
## <a name="see-also"></a><span data-ttu-id="61e84-183">另请参阅</span><span class="sxs-lookup"><span data-stu-id="61e84-183">See also</span></span>

- [<span data-ttu-id="61e84-184">部署和安装 Outlook 加载项以进行测试</span><span class="sxs-lookup"><span data-stu-id="61e84-184">Deploy and install Outlook add-ins for testing</span></span>](testing-and-tips.md)
