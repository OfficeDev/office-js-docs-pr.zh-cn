---
title: 处理 Outlook 加载项中的日期值
description: Office JavaScript API 使用 JavaScript Date 对象进行日期和时间大部分存储和检索。
ms.date: 10/31/2019
localization_priority: Normal
ms.openlocfilehash: 4f0e93d147760f91c55fd5666f02b2c6cc5d5470
ms.sourcegitcommit: 7482ab6bc258d98acb9ba9b35c7dd3b5cc5bed21
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/24/2021
ms.locfileid: "51177990"
---
# <a name="tips-for-handling-date-values-in-outlook-add-ins"></a><span data-ttu-id="75e70-103">处理 Outlook 加载项中的日期值的提示</span><span class="sxs-lookup"><span data-stu-id="75e70-103">Tips for handling date values in Outlook add-ins</span></span>

<span data-ttu-id="75e70-104">Office JavaScript API 使用 JavaScript [Date](https://www.w3schools.com/jsref/jsref_obj_date.asp) 对象进行日期和时间大部分存储和检索。</span><span class="sxs-lookup"><span data-stu-id="75e70-104">The Office JavaScript API uses the JavaScript [Date](https://www.w3schools.com/jsref/jsref_obj_date.asp) object for most of the storage and retrieval of dates and times.</span></span> 

<span data-ttu-id="75e70-105">该对象提供 `Date` getUTCDate、getUTCHour、getUTCMinutes 和[toUTCString](https://www.w3schools.com/jsref/jsref_toutcstring.asp)[](https://www.w3schools.com/jsref/jsref_getutcdate.asp)[](https://www.w3schools.com/jsref/jsref_getutchours.asp)等方法，这些方法根据协调世界时 (UTC) 时间返回请求的日期或时间值[](https://www.w3schools.com/jsref/jsref_getutcminutes.asp)。</span><span class="sxs-lookup"><span data-stu-id="75e70-105">That `Date` object provides methods such as [getUTCDate](https://www.w3schools.com/jsref/jsref_getutcdate.asp), [getUTCHour](https://www.w3schools.com/jsref/jsref_getutchours.asp), [getUTCMinutes](https://www.w3schools.com/jsref/jsref_getutcminutes.asp), and [toUTCString](https://www.w3schools.com/jsref/jsref_toutcstring.asp), which return the requested date or time value according to Universal Coordinated Time (UTC) time.</span></span>

<span data-ttu-id="75e70-106">对象 `Date` 还提供了其他方法，如 [getDate](https://www.w3schools.com/jsref/jsref_getutcdate.asp)、 [getHour](https://www.w3schools.com/jsref/jsref_getutchours.asp)、 [getMinutes](https://www.w3schools.com/jsref/jsref_getminutes.asp)和 [toString](https://www.w3schools.com/jsref/jsref_tostring_date.asp)，这些方法根据"本地时间"返回请求的日期或时间。</span><span class="sxs-lookup"><span data-stu-id="75e70-106">The `Date` object also provides other methods such as [getDate](https://www.w3schools.com/jsref/jsref_getutcdate.asp), [getHour](https://www.w3schools.com/jsref/jsref_getutchours.asp), [getMinutes](https://www.w3schools.com/jsref/jsref_getminutes.asp), and [toString](https://www.w3schools.com/jsref/jsref_tostring_date.asp), which return the requested date or time according to "local time".</span></span>

<span data-ttu-id="75e70-107">“本地时间”概念很大程度上取决于客户端计算机上的浏览器和操作系统。</span><span class="sxs-lookup"><span data-stu-id="75e70-107">The concept of "local time" is largely determined by the browser and operating system on the client computer.</span></span> <span data-ttu-id="75e70-108">例如，在基于 Windows 的客户端计算机上运行的多数浏览器上，JavaScript 调用 将基于客户端计算机上 Windows 中设置的时区返回 `getDate` 日期。</span><span class="sxs-lookup"><span data-stu-id="75e70-108">For instance, on most browsers running on a Windows-based client computer, a JavaScript call to `getDate`, returns a date based on the time zone set in Windows on the client computer.</span></span>

<span data-ttu-id="75e70-109">下面的示例在本地时间创建一个对象，并调用 `Date` `myLocalDate` `toUTCString` 以将日期转换为 UTC 格式的日期字符串。</span><span class="sxs-lookup"><span data-stu-id="75e70-109">The following example creates a `Date` object `myLocalDate` in local time, and calls `toUTCString` to convert that date to a date string in UTC.</span></span>

```js
// Create and get the current date represented 
// in the client computer time zone.
var myLocalDate = new Date (); 

// Convert the Date value in the client computer time zone
// to a date string in UTC, and display the string.
document.write ("The current UTC time is " + 
    myLocalDate.toUTCString());
```

<span data-ttu-id="75e70-110">虽然可以使用 JavaScript 对象获取基于 UTC 或客户端计算机时区的日期或时间值，但 Date 对象在一方面受到限制，它不提供用于返回任何其他特定时区的日期或时间值的方法。 `Date` </span><span class="sxs-lookup"><span data-stu-id="75e70-110">While you can use the JavaScript `Date` object to get a date or time value based on UTC or the client computer time zone, the **Date** object is limited in one respect - it does not provide methods to return a date or time value for any other specific time zone.</span></span> <span data-ttu-id="75e70-111">例如，如果客户端计算机设置为东部标准时间 (EST) ，则没有方法允许您获取除 EST 或 UTC 格式的小时值，例如太平洋标准时间 `Date` (PST) 。</span><span class="sxs-lookup"><span data-stu-id="75e70-111">For example, if your client computer is set to be on Eastern Standard Time (EST), there is no `Date` method that allows you to get the hour value other than in EST or UTC, such as Pacific Standard Time (PST).</span></span>


## <a name="date-related-features-for-outlook-add-ins"></a><span data-ttu-id="75e70-112">Outlook 加载项的日期相关功能</span><span class="sxs-lookup"><span data-stu-id="75e70-112">Date-related features for Outlook add-ins</span></span>

<span data-ttu-id="75e70-113">当您使用 Office JavaScript API 处理在 Outlook 富客户端以及 Web 或移动设备上的 Outlook 中运行的 Outlook 外接程序中的日期或时间值时，上述 JavaScript 限制有一定影响。</span><span class="sxs-lookup"><span data-stu-id="75e70-113">The aforementioned JavaScript limitation has an implication for you, when you use the Office JavaScript API to handle date or time values in Outlook add-ins that run in an Outlook rich client, and in Outlook on the web or mobile devices.</span></span>


### <a name="time-zones-for-outlook-clients"></a><span data-ttu-id="75e70-114">Outlook 客户端的时区</span><span class="sxs-lookup"><span data-stu-id="75e70-114">Time zones for Outlook clients</span></span>

<span data-ttu-id="75e70-115">为清楚起见，让我们先定义要讨论的时区。</span><span class="sxs-lookup"><span data-stu-id="75e70-115">For clarity, let's define the time zones in question.</span></span>

|<span data-ttu-id="75e70-116">**时区**</span><span class="sxs-lookup"><span data-stu-id="75e70-116">**Time zone**</span></span>|<span data-ttu-id="75e70-117">**说明**</span><span class="sxs-lookup"><span data-stu-id="75e70-117">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="75e70-118">客户端计算机时区</span><span class="sxs-lookup"><span data-stu-id="75e70-118">Client computer time zone</span></span>|<span data-ttu-id="75e70-119">这在客户端计算机的操作系统上设置。</span><span class="sxs-lookup"><span data-stu-id="75e70-119">This is set on the operating system of the client computer.</span></span> <span data-ttu-id="75e70-120">大多数浏览器使用客户端计算机时区来显示 JavaScript 对象的日期或时间 `Date` 值。</span><span class="sxs-lookup"><span data-stu-id="75e70-120">Most browsers use the client computer time zone to display date or time values of the JavaScript `Date` object.</span></span><br/><br/><span data-ttu-id="75e70-121">Outlook 富客户端使用此时区在用户界面中显示日期或时间值。</span><span class="sxs-lookup"><span data-stu-id="75e70-121">An Outlook rich client uses this time zone to display date or time values in the user interface.</span></span> <br/><br/><span data-ttu-id="75e70-122">例如，在运行 Windows 的客户端计算机上，Outlook 将使用 Windows 上设置的时区作为本地时区。</span><span class="sxs-lookup"><span data-stu-id="75e70-122">For example, on a client computer running Windows, Outlook uses the time zone set on Windows as the local time zone.</span></span> <span data-ttu-id="75e70-123">在 Mac 上，如果用户更改客户端计算机上的时区，Mac 上的 Outlook 也会提示用户更新 Outlook 中的时区。</span><span class="sxs-lookup"><span data-stu-id="75e70-123">On the Mac, if the user changes the time zone on the client computer, Outlook on Mac would prompt the user to update the time zone in Outlook as well.</span></span>|
|<span data-ttu-id="75e70-124">Exchange 管理中心 (EAC) 时区</span><span class="sxs-lookup"><span data-stu-id="75e70-124">Exchange Admin Center (EAC) time zone</span></span>|<span data-ttu-id="75e70-125">用户在首次登录到 Web (或移动设备上的 Outlook) 设置此时区值和首选语言。</span><span class="sxs-lookup"><span data-stu-id="75e70-125">The user sets this time zone value (and the preferred language) when he or she logs on to Outlook on the web or mobile devices the first time.</span></span> <br/><br/><span data-ttu-id="75e70-126">Outlook 网页版和移动设备使用此时区在用户界面中显示日期或时间值。</span><span class="sxs-lookup"><span data-stu-id="75e70-126">Outlook on the web and mobile devices use this time zone to display date or time values in the user interface.</span></span>|

<span data-ttu-id="75e70-127">由于 Outlook 富客户端使用客户端计算机时区，并且 Outlook 网页版和移动设备的用户界面使用 EAC 时区，因此，当在 Outlook 富客户端和 Web 或移动设备上的 Outlook 中运行时，为同一邮箱安装的同一外接程序的本地时间可能不同。</span><span class="sxs-lookup"><span data-stu-id="75e70-127">Because an Outlook rich client uses the client computer time zone, and the user interface of Outlook on the web and mobile devices uses the EAC time zone, the local time for the same add-in installed for the same mailbox can be different when running in an Outlook rich client and in Outlook on the web or mobile devices.</span></span> <span data-ttu-id="75e70-128">作为 Outlook 外接程序开发人员，您应该正确输入和输出日期值，以便那些值始终与用户期望的相应客户端上的时区保持一致。</span><span class="sxs-lookup"><span data-stu-id="75e70-128">As an Outlook add-in developer, you should appropriately input and output date values so that those values are always consistent with the time zone that the user expects on the corresponding client.</span></span>


### <a name="date-related-api"></a><span data-ttu-id="75e70-129">日期相关的 API</span><span class="sxs-lookup"><span data-stu-id="75e70-129">Date-related API</span></span>

<span data-ttu-id="75e70-130">以下是 Office JavaScript API 中支持日期相关功能的属性和方法。</span><span class="sxs-lookup"><span data-stu-id="75e70-130">The following are the properties and methods in the Office JavaScript API that support date-related features.</span></span>

|<span data-ttu-id="75e70-131">API 成员</span><span class="sxs-lookup"><span data-stu-id="75e70-131">API member</span></span>|<span data-ttu-id="75e70-132">时区表示形式</span><span class="sxs-lookup"><span data-stu-id="75e70-132">Time zone representation</span></span>|<span data-ttu-id="75e70-133">Outlook 富客户端的示例</span><span class="sxs-lookup"><span data-stu-id="75e70-133">Example in an Outlook rich client</span></span>|<span data-ttu-id="75e70-134">Outlook 网页版或移动设备上的示例</span><span class="sxs-lookup"><span data-stu-id="75e70-134">Example in Outlook on the web or mobile devices</span></span>|
|--------------|----------------------------|-------------------------------------|-------------------|
|[<span data-ttu-id="75e70-135">Office.context.mailbox.userProfile.timeZone</span><span class="sxs-lookup"><span data-stu-id="75e70-135">Office.context.mailbox.userProfile.timeZone</span></span>](/javascript/api/outlook/office.userprofile?view=outlook-js-preview&preserve-view=true#timezone)|<span data-ttu-id="75e70-136">在 Outlook 富客户端中，此属性返回客户端计算机时区。</span><span class="sxs-lookup"><span data-stu-id="75e70-136">In an Outlook rich client, this property returns the client computer time zone.</span></span> <span data-ttu-id="75e70-137">在 Outlook 网页版和移动设备上，此属性返回 EAC 时区。</span><span class="sxs-lookup"><span data-stu-id="75e70-137">In Outlook on the web and mobile devices, this property returns the EAC time zone.</span></span> |<span data-ttu-id="75e70-138">EST</span><span class="sxs-lookup"><span data-stu-id="75e70-138">EST</span></span>|<span data-ttu-id="75e70-139">PST</span><span class="sxs-lookup"><span data-stu-id="75e70-139">PST</span></span>|
|<span data-ttu-id="75e70-140">[Office.context.mailbox.item.dateTimeCreated](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties) 和 [Office.context.mailbox.item.dateTimeModified](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)</span><span class="sxs-lookup"><span data-stu-id="75e70-140">[Office.context.mailbox.item.dateTimeCreated](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties) and [Office.context.mailbox.item.dateTimeModified](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)</span></span>|<span data-ttu-id="75e70-141">其中每个属性返回一个 JavaScript `Date` 对象。</span><span class="sxs-lookup"><span data-stu-id="75e70-141">Each of these properties returns a JavaScript `Date` object.</span></span> <span data-ttu-id="75e70-142">此值为 UTC 格式，如以下示例所示 - 在 Outlook 富客户端、Web 上的 Outlook 和 `Date` `myUTCDate` 移动设备上具有相同的值。</span><span class="sxs-lookup"><span data-stu-id="75e70-142">This `Date` value is UTC-correct, as shown in the following example - `myUTCDate` has the same value in an Outlook rich client, Outlook on the web and mobile devices.</span></span><br/><br/>`var myDate = Office.mailbox.item.dateTimeCreated;`<br/>`var myUTCDate = myDate.getUTCDate;`<br/><br/><span data-ttu-id="75e70-143">但是，调用会返回客户端计算机时区中的日期值，该值与用于在 Outlook 富客户端界面中显示日期时间值的时区一致，但可能不同于 Outlook 网页版和移动设备在其用户界面中使用的 EAC 时区。 `myDate.getDate`</span><span class="sxs-lookup"><span data-stu-id="75e70-143">However, calling  `myDate.getDate` returns a date value in the client computer time zone, which is consistent with the time zone used to display date times values in the Outlook rich client interface, but may be different from the EAC time zone that Outlook on the web and mobile devices use in its user interface.</span></span>|<span data-ttu-id="75e70-144">如果此项的创建时间是 9am UTC：</span><span class="sxs-lookup"><span data-stu-id="75e70-144">If the item is created at 9am UTC:</span></span><br/><br/>`Office.mailbox.item.`<br/><span data-ttu-id="75e70-145">`dateTimeCreated.getHours` 返回 4am EST。</span><span class="sxs-lookup"><span data-stu-id="75e70-145">`dateTimeCreated.getHours` returns 4am EST.</span></span><br/><br/><span data-ttu-id="75e70-146">如果此项的修改时间是 11am UTC：</span><span class="sxs-lookup"><span data-stu-id="75e70-146">If the item is modified at 11am UTC:</span></span><br/><br/>`Office.mailbox.item.`<br/><span data-ttu-id="75e70-147">`dateTimeModified.getHours` 返回 6am EST。</span><span class="sxs-lookup"><span data-stu-id="75e70-147">`dateTimeModified.getHours` returns 6am EST.</span></span>|<span data-ttu-id="75e70-148">如果此项的创建时间是 9am UTC：</span><span class="sxs-lookup"><span data-stu-id="75e70-148">If the item creation time is 9am UTC:</span></span><br/><br/>`Office.mailbox.item.`</br><span data-ttu-id="75e70-149">`dateTimeCreated.getHours` 返回 4am EST。</span><span class="sxs-lookup"><span data-stu-id="75e70-149">`dateTimeCreated.getHours` returns 4am EST.</span></span><br/><br/><span data-ttu-id="75e70-150">如果此项的修改时间是 11am UTC：</span><span class="sxs-lookup"><span data-stu-id="75e70-150">If the item is modified at 11am UTC:</span></span><br/><br/>`Office.mailbox.item.`</br><span data-ttu-id="75e70-151">`dateTimeModified.getHours` 返回 6am EST。</span><span class="sxs-lookup"><span data-stu-id="75e70-151">`dateTimeModified.getHours` returns 6am EST.</span></span><br/><br/><span data-ttu-id="75e70-152">请注意，如果您想要在用户界面中显示创建或修改时间，要首先将时间转换为 PST 以与用户界面的其余部分保持一致。</span><span class="sxs-lookup"><span data-stu-id="75e70-152">Notice that if you want to display the creation or modification time in the user interface, you would want to first convert the time to PST to be consistent with the rest of the user interface.</span></span>|
|[<span data-ttu-id="75e70-153">Office.context.mailbox.displayNewAppointmentForm</span><span class="sxs-lookup"><span data-stu-id="75e70-153">Office.context.mailbox.displayNewAppointmentForm</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)|<span data-ttu-id="75e70-154">每个  _Start 和_ _End_ 参数都需要一个 JavaScript `Date` 对象。</span><span class="sxs-lookup"><span data-stu-id="75e70-154">Each of the  _Start_ and _End_ parameters requires a JavaScript `Date` object.</span></span> <span data-ttu-id="75e70-155">无论 Outlook 富客户端、Web 上的 Outlook 或移动设备上的用户界面中使用的时区如何，参数都应采用 UTC 格式。</span><span class="sxs-lookup"><span data-stu-id="75e70-155">The arguments should be UTC-correct regardless of the time zone used in the user interface of an Outlook rich client, or Outlook on the web or mobile devices.</span></span>|<span data-ttu-id="75e70-156">如果约会窗体的开始和结束时间分别是 9am UTC 和 11am UTC，则应确保 `start` 和 `end` 参数都是 UTC 格式，这意味着：</span><span class="sxs-lookup"><span data-stu-id="75e70-156">If the start and end times for the appointment form are 9am UTC and 11am UTC, then you should assure that the `start` and `end` arguments are UTC-correct, which means:</span></span><br/><br/><ul><li><span data-ttu-id="75e70-157">`start.getUTCHours` 返回 9am UTC</span><span class="sxs-lookup"><span data-stu-id="75e70-157">`start.getUTCHours` returns 9am UTC</span></span></li><li><span data-ttu-id="75e70-158">`end.getUTCHours` 返回 11am UTC</span><span class="sxs-lookup"><span data-stu-id="75e70-158">`end.getUTCHours` returns 11am UTC</span></span></li></ul>|<span data-ttu-id="75e70-159">如果约会窗体的开始和结束时间分别是 9am UTC 和 11am UTC，则应确保 `start` 和 `end` 参数都是 UTC 格式，这意味着：</span><span class="sxs-lookup"><span data-stu-id="75e70-159">If the start and end times for the appointment form are 9am UTC and 11am UTC, then you should assure that the `start` and `end` arguments are UTC-correct, which means:</span></span><br/><br/><ul><li><span data-ttu-id="75e70-160">`start.getUTCHours` 返回 9am UTC</span><span class="sxs-lookup"><span data-stu-id="75e70-160">`start.getUTCHours` returns 9am UTC</span></span></li><li><span data-ttu-id="75e70-161">`end.getUTCHours` 返回 11am UTC</span><span class="sxs-lookup"><span data-stu-id="75e70-161">`end.getUTCHours` returns 11am UTC</span></span></li></ul>|

## <a name="helper-methods-for-date-related-scenarios"></a><span data-ttu-id="75e70-162">日期相关应用场景的帮助程序方法</span><span class="sxs-lookup"><span data-stu-id="75e70-162">Helper methods for date-related scenarios</span></span>


<span data-ttu-id="75e70-163">如前面的部分所述，由于 Outlook 网页版或移动设备上用户的"本地时间"在 Outlook 富客户端上可能不同，但 JavaScript **Date** 对象仅支持转换为客户端计算机时区或 UTC，因此 Office JavaScript API 提供了两种帮助程序方法 [：Office.context.mailbox.convertToLocalClientTime](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods) 和 [Office.context.mailbox.convertToUtcClientTime](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)。</span><span class="sxs-lookup"><span data-stu-id="75e70-163">As described in the preceding sections, because the "local time" for a user in Outlook on the web or mobile devices can be different on an Outlook rich client, but the JavaScript **Date** object supports converting to only the client computer time zone or UTC, the Office JavaScript API provides two helper methods: [Office.context.mailbox.convertToLocalClientTime](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods) and [Office.context.mailbox.convertToUtcClientTime](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods).</span></span>

<span data-ttu-id="75e70-164">这些帮助程序方法可处理以下两个与日期相关的方案（Outlook 富客户端、Outlook 网页版和移动设备）中以不同方式处理日期或时间的任何需求，从而强化外接程序的不同客户端的"写入一次"。</span><span class="sxs-lookup"><span data-stu-id="75e70-164">These helper methods take care of any need to handle date or time differently for the following two date-related scenarios, in an Outlook rich client, Outlook on the web and mobile devices, thus reinforcing "write-once" for different clients of your add-in.</span></span>


### <a name="scenario-a-displaying-item-creation-or-modified-time"></a><span data-ttu-id="75e70-165">应用场景 A：显示项创建时间或修改时间</span><span class="sxs-lookup"><span data-stu-id="75e70-165">Scenario A: Displaying item creation or modified time</span></span>

<span data-ttu-id="75e70-166">如果要在用户界面中显示项目创建时间 () 或修改时间 (，则首先使用 转换这些属性提供的对象，以在适当的本地时间获取字典 `Item.dateTimeCreated` `Item.dateTimeModified` `convertToLocalClientTime` `Date` 表示形式。</span><span class="sxs-lookup"><span data-stu-id="75e70-166">If you are displaying the item creation time (`Item.dateTimeCreated`) or modification time (`Item.dateTimeModified`in the user interface, first use `convertToLocalClientTime` to convert the `Date` object provided by these properties to obtain a dictionary representation in the appropriate local time.</span></span> <span data-ttu-id="75e70-167">然后显示字典日期的各个部分。</span><span class="sxs-lookup"><span data-stu-id="75e70-167">Then display the parts of the dictionary date.</span></span> <span data-ttu-id="75e70-168">下面是此应用场景的一个示例：</span><span class="sxs-lookup"><span data-stu-id="75e70-168">The following is an example of this scenario:</span></span>


```js
// This date is UTC-correct.
var myDate = Office.context.mailbox.item.dateTimeCreated;

// Call helper method to get date in dictionary format, 
// represented in the appropriate local time.
// In an Outlook rich client, this is dictionary format 
// in client computer time zone.
// In Outlook on the web or mobile devices, this dictionary 
// format is in EAC time zone.
var myLocalDictionaryDate = Office.context.mailbox.convertToLocalClientTime(myDate);

// Display different parts of the dictionary date.
document.write ("The item was created at " + myLocalDictionaryDate["hours"] + 
    ":" + myLocalDictionaryDate["minutes"]);)
```

<span data-ttu-id="75e70-169">请注意 Outlook 富客户端与 Outlook 网页版或移动设备 `convertToLocalClientTime` 的区别：</span><span class="sxs-lookup"><span data-stu-id="75e70-169">Note that `convertToLocalClientTime` takes care of the difference between an Outlook rich client, and Outlook on the web or mobile devices:</span></span>


- <span data-ttu-id="75e70-170">如果检测到当前应用程序是富客户端，则该方法将表示形式转换为同一客户端计算机时区中的字典表示形式，与富客户端用户界面的其余部分 `convertToLocalClientTime` `Date` 保持一致。</span><span class="sxs-lookup"><span data-stu-id="75e70-170">If `convertToLocalClientTime` detects the current application is a rich client, the method converts the `Date` representation to a dictionary representation in the same client computer time zone, consistent with the rest of the rich client user interface.</span></span>
    
- <span data-ttu-id="75e70-171">如果检测到当前应用程序是 Outlook 网页版或移动设备上的 Outlook，则该方法将采用 UTC 格式的表示形式转换为 EAC 时区中的字典格式，与 `convertToLocalClientTime` Outlook 网页版或移动设备用户界面的其余部分保持一致。 `Date`</span><span class="sxs-lookup"><span data-stu-id="75e70-171">If `convertToLocalClientTime` detects the current application is Outlook on the web or mobile devices, the method converts the UTC-correct `Date` representation to a dictionary format in the EAC time zone, consistent with the rest of the Outlook on the web or mobile devices user interface.</span></span>
    

### <a name="scenario-b-displaying-start-and-end-dates-in-a-new-appointment-form"></a><span data-ttu-id="75e70-172">应用场景 B：在新的约会窗体中显示开始日期和结束日期</span><span class="sxs-lookup"><span data-stu-id="75e70-172">Scenario B: Displaying start and end dates in a new appointment form</span></span>

<span data-ttu-id="75e70-173">如果要获取以本地时间表示的日期时间值的不同部分作为输入，并且希望将此字典输入值作为约会窗体中的开始时间或结束时间提供，请首先使用帮助程序方法将字典值转换为 UTC 正确的对象。 `convertToUtcClientTime` `Date`</span><span class="sxs-lookup"><span data-stu-id="75e70-173">If you are obtaining as input different parts of a date-time value represented in the local time, and would like to provide this dictionary input value as a start or end time in an appointment form, first use the `convertToUtcClientTime` helper method to convert the dictionary value to a UTC-correct `Date` object.</span></span>

<span data-ttu-id="75e70-174">在以下示例中，假定 `myLocalDictionaryStartDate` 和 `myLocalDictionaryEndDate` 是从用户获得的采用字典格式的日期时间值。</span><span class="sxs-lookup"><span data-stu-id="75e70-174">In the following example, assume  `myLocalDictionaryStartDate` and `myLocalDictionaryEndDate` are date-time values in dictionary format that you have obtained from the user.</span></span> <span data-ttu-id="75e70-175">这些值基于本地时间，取决于客户端平台。</span><span class="sxs-lookup"><span data-stu-id="75e70-175">These values are based on the local time, dependent on the client platform.</span></span>

```js
var myUTCCorrectStartDate = Office.context.mailbox.convertToUtcClientTime(myLocalDictionaryStartDate);
var myUTCCorrectEndDate = Office.context.mailbox.convertToUtcClientTime(myLocalDictionaryEndDate);

```

<span data-ttu-id="75e70-176">结果值 `myUTCCorrectStartDate` 和 `myUTCCorrectEndDate` 采用 UTC 格式。</span><span class="sxs-lookup"><span data-stu-id="75e70-176">The resultant values,  `myUTCCorrectStartDate` and `myUTCCorrectEndDate`, are UTC-correct.</span></span> <span data-ttu-id="75e70-177">然后将这些 `Date` 对象作为 _方法的 Start_ 和 _End_ 参数的参数传递， `Mailbox.displayNewAppointmentForm` 以显示新的约会窗体。</span><span class="sxs-lookup"><span data-stu-id="75e70-177">Then pass these `Date` objects as arguments for the _Start_ and _End_ parameters of the `Mailbox.displayNewAppointmentForm` method to display the new appointment form.</span></span>

<span data-ttu-id="75e70-178">请注意 Outlook 富客户端与 Outlook 网页版或移动设备 `convertToUtcClientTime` 的区别：</span><span class="sxs-lookup"><span data-stu-id="75e70-178">Note that `convertToUtcClientTime` takes care of the difference between an Outlook rich client, and Outlook on the web or mobile devices:</span></span>


- <span data-ttu-id="75e70-179">如果 `convertToUtcClientTime` 检测到当前应用程序是 Outlook 富客户端，该方法只是将字典表示形式转换为 `Date` 对象。</span><span class="sxs-lookup"><span data-stu-id="75e70-179">If `convertToUtcClientTime` detects the current application is an Outlook rich client, the method simply converts the dictionary representation to a `Date` object.</span></span> <span data-ttu-id="75e70-180">此 `Date` 对象是 UTC 格式，如 预期的那样 `displayNewAppointmentForm` 。</span><span class="sxs-lookup"><span data-stu-id="75e70-180">This `Date` object is UTC-correct, as expected by `displayNewAppointmentForm`.</span></span>
    
- <span data-ttu-id="75e70-181">如果检测到当前应用程序是 Outlook 网页版或移动设备版，该方法会将用 EAC 时区表示的日期和时间值的字典格式 `convertToUtcClientTime` 转换为 `Date` 对象。</span><span class="sxs-lookup"><span data-stu-id="75e70-181">If `convertToUtcClientTime` detects the current application is Outlook on the web or mobile devices, the method converts the dictionary format of the date and time values expressed in the EAC time zone to a `Date` object.</span></span> <span data-ttu-id="75e70-182">此 `Date` 对象是 UTC 格式，如 预期的那样 `displayNewAppointmentForm` 。</span><span class="sxs-lookup"><span data-stu-id="75e70-182">This `Date` object is UTC-correct, as expected by `displayNewAppointmentForm`.</span></span>
    
## <a name="see-also"></a><span data-ttu-id="75e70-183">另请参阅</span><span class="sxs-lookup"><span data-stu-id="75e70-183">See also</span></span>

- [<span data-ttu-id="75e70-184">部署和安装 Outlook 加载项以进行测试</span><span class="sxs-lookup"><span data-stu-id="75e70-184">Deploy and install Outlook add-ins for testing</span></span>](testing-and-tips.md)
