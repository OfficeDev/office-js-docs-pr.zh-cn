---
title: Excel JavaScript API 仅联机要求集
description: 有关 ExcelApiOnline 要求集的详细信息
ms.date: 12/05/2019
ms.prod: excel
localization_priority: Normal
ms.openlocfilehash: ad2a3cd627552baeb449397fa917fe10e86ebbaf
ms.sourcegitcommit: 8c5c5a1bd3fe8b90f6253d9850e9352ed0b283ee
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/19/2019
ms.locfileid: "40814150"
---
# <a name="excel-javascript-api-online-only-requirement-set"></a><span data-ttu-id="46571-103">Excel JavaScript API 仅联机要求集</span><span class="sxs-lookup"><span data-stu-id="46571-103">Excel JavaScript API online-only requirement set</span></span>

<span data-ttu-id="46571-104">`ExcelApiOnline`要求集是一个特殊要求集，其中包含仅适用于 web 上的 Excel 的功能。</span><span class="sxs-lookup"><span data-stu-id="46571-104">The `ExcelApiOnline` requirement set is a special requirement set that includes features that are only available for Excel on the web.</span></span> <span data-ttu-id="46571-105">此要求集中的 Api 被认为是针对 web 主机上的 Excel 的生产 Api （不受未记录的行为或结构更改）。</span><span class="sxs-lookup"><span data-stu-id="46571-105">APIs in this requirement set are considered to be production APIs (not subject to undocumented behavioral or structural changes) for the Excel on the web host.</span></span> <span data-ttu-id="46571-106">`ExcelApiOnline`被视为针对其他平台（Windows、Mac、iOS）的 "预览" Api，这些平台可能不支持这些平台。</span><span class="sxs-lookup"><span data-stu-id="46571-106">`ExcelApiOnline` are considered to be "preview" APIs for other platforms (Windows, Mac, iOS) and may not be supported by any of those platforms.</span></span>

<span data-ttu-id="46571-107">当在所有平台`ExcelApiOnline`上支持要求集中的 api 时，它们将添加到下一个发布的要求集`ExcelApi 1.[NEXT]`（）。</span><span class="sxs-lookup"><span data-stu-id="46571-107">When APIs in the `ExcelApiOnline` requirement set are supported across all platforms, they will added to the next released requirement set (`ExcelApi 1.[NEXT]`).</span></span> <span data-ttu-id="46571-108">一旦新要求是公共的，将从这些 Api 中`ExcelApiOnline`删除。</span><span class="sxs-lookup"><span data-stu-id="46571-108">Once that new requirement is public, those APIs will be removed from `ExcelApiOnline`.</span></span> <span data-ttu-id="46571-109">可将此视为将 API 从预览迁移到发布的类似升级过程。</span><span class="sxs-lookup"><span data-stu-id="46571-109">Think of this as a similar promotion process as an API moving from preview to release.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="46571-110">`ExcelApiOnline`是最新编号的要求集的超集。</span><span class="sxs-lookup"><span data-stu-id="46571-110">`ExcelApiOnline` is superset of the latest numbered requirement set.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="46571-111">`ExcelApiOnline 1.1`是仅联机 Api 的唯一版本。</span><span class="sxs-lookup"><span data-stu-id="46571-111">`ExcelApiOnline 1.1` is the only version of the online-only APIs.</span></span> <span data-ttu-id="46571-112">这是因为 web 上的 Excel 将始终有一个版本可供最新版本的用户使用。</span><span class="sxs-lookup"><span data-stu-id="46571-112">This is because Excel on the web will always have a single version available to users that is the latest version.</span></span>

## <a name="recommended-usage"></a><span data-ttu-id="46571-113">建议使用</span><span class="sxs-lookup"><span data-stu-id="46571-113">Recommended usage</span></span>

<span data-ttu-id="46571-114">由于`ExcelApiOnline` web 上的 Excel 仅支持 api，因此，您的外接程序应检查是否支持要求集，然后再调用这些 api。</span><span class="sxs-lookup"><span data-stu-id="46571-114">Because `ExcelApiOnline` APIs are only supported by Excel on the web, your add-in should check if the requirement set is supported before calling these APIs.</span></span> <span data-ttu-id="46571-115">这样可以避免在不同的平台上调用仅联机 API。</span><span class="sxs-lookup"><span data-stu-id="46571-115">This avoids calling an online-only API on a different platform.</span></span>

```js
if (Office.context.requirements.isSetSupported("ExcelApiOnline", "1.1")) {
   // Any API exclusive to the ExcelApiOnline requirement set.
}
```

<span data-ttu-id="46571-116">一旦 API 位于跨平台要求集，就应删除或编辑该`isSetSupported`检查。</span><span class="sxs-lookup"><span data-stu-id="46571-116">Once the API is in a cross-platform requirement set, you should remove or edit the `isSetSupported` check.</span></span> <span data-ttu-id="46571-117">这将在其他平台上启用外接程序的功能。</span><span class="sxs-lookup"><span data-stu-id="46571-117">This will enable your add-in's feature on other platforms.</span></span> <span data-ttu-id="46571-118">进行此更改时，请务必在这些平台上测试功能。</span><span class="sxs-lookup"><span data-stu-id="46571-118">Be sure to test the feature on those platforms when making this change.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="46571-119">清单不能指定`ExcelApiOnline 1.1`为激活要求。</span><span class="sxs-lookup"><span data-stu-id="46571-119">Your manifest cannot specify `ExcelApiOnline 1.1` as an activation requirement.</span></span> <span data-ttu-id="46571-120">不是在[Set 元素](../manifest/set.md)中使用的有效值。</span><span class="sxs-lookup"><span data-stu-id="46571-120">It is not a valid value to use in the [Set element](../manifest/set.md).</span></span>

## <a name="api-list"></a><span data-ttu-id="46571-121">API 列表</span><span class="sxs-lookup"><span data-stu-id="46571-121">API list</span></span>

<span data-ttu-id="46571-122">下面的 Api 当前可用于 web 上的 Excel，作为`ExcelApiOnline 1.1`要求集的一部分。</span><span class="sxs-lookup"><span data-stu-id="46571-122">The following APIs are currently available for Excel on the web as part of the `ExcelApiOnline 1.1` requirement set.</span></span>

| <span data-ttu-id="46571-123">Class</span><span class="sxs-lookup"><span data-stu-id="46571-123">Class</span></span> | <span data-ttu-id="46571-124">域</span><span class="sxs-lookup"><span data-stu-id="46571-124">Fields</span></span> | <span data-ttu-id="46571-125">说明</span><span class="sxs-lookup"><span data-stu-id="46571-125">Description</span></span> |
|:---|:---|:---|
|[<span data-ttu-id="46571-126">Comment</span><span class="sxs-lookup"><span data-stu-id="46571-126">Comment</span></span>](/javascript/api/excel/excel.comment)|[<span data-ttu-id="46571-127">提及</span><span class="sxs-lookup"><span data-stu-id="46571-127">mentions</span></span>](/javascript/api/excel/excel.comment#mentions)|<span data-ttu-id="46571-128">获取注释中提到的实体（如人员）。</span><span class="sxs-lookup"><span data-stu-id="46571-128">Gets the entities (e.g. people) that are mentioned in comments.</span></span>|
||[<span data-ttu-id="46571-129">richContent</span><span class="sxs-lookup"><span data-stu-id="46571-129">richContent</span></span>](/javascript/api/excel/excel.comment#richcontent)|<span data-ttu-id="46571-130">获取丰富的注释内容（例如，注释中的提及）。</span><span class="sxs-lookup"><span data-stu-id="46571-130">Gets the rich comment content (e.g. mentions in comments).</span></span> <span data-ttu-id="46571-131">此字符串不应显示给最终用户。</span><span class="sxs-lookup"><span data-stu-id="46571-131">This string is not meant to be displayed to end-users.</span></span> <span data-ttu-id="46571-132">您的外接程序应仅使用此信息分析丰富的注释内容。</span><span class="sxs-lookup"><span data-stu-id="46571-132">Your add-in should only use this to parse rich comment content.</span></span>|
||[<span data-ttu-id="46571-133">updateMentions （contentWithMentions： CommentRichContent）</span><span class="sxs-lookup"><span data-stu-id="46571-133">updateMentions(contentWithMentions: Excel.CommentRichContent)</span></span>](/javascript/api/excel/excel.comment#updatementions-contentwithmentions-)|<span data-ttu-id="46571-134">使用特殊格式的字符串和提及列表更新注释内容。</span><span class="sxs-lookup"><span data-stu-id="46571-134">Updates the comment content with a specially formatted string and a list of mentions.</span></span>|
|[<span data-ttu-id="46571-135">CommentMention</span><span class="sxs-lookup"><span data-stu-id="46571-135">CommentMention</span></span>](/javascript/api/excel/excel.commentmention)|[<span data-ttu-id="46571-136">email</span><span class="sxs-lookup"><span data-stu-id="46571-136">email</span></span>](/javascript/api/excel/excel.commentmention#email)|<span data-ttu-id="46571-137">获取或设置注释中提到的实体的电子邮件地址。</span><span class="sxs-lookup"><span data-stu-id="46571-137">Gets or sets the email address of the entity that is mentioned in comment.</span></span>|
||[<span data-ttu-id="46571-138">id</span><span class="sxs-lookup"><span data-stu-id="46571-138">id</span></span>](/javascript/api/excel/excel.commentmention#id)|<span data-ttu-id="46571-139">获取或设置实体的 id。</span><span class="sxs-lookup"><span data-stu-id="46571-139">Gets or sets the id of the entity.</span></span> <span data-ttu-id="46571-140">这与中`CommentRichContent.richContent`的一个 id 相匹配。</span><span class="sxs-lookup"><span data-stu-id="46571-140">This matches one of the ids in `CommentRichContent.richContent`.</span></span>|
||[<span data-ttu-id="46571-141">name</span><span class="sxs-lookup"><span data-stu-id="46571-141">name</span></span>](/javascript/api/excel/excel.commentmention#name)|<span data-ttu-id="46571-142">获取或设置注释中提到的实体的名称。</span><span class="sxs-lookup"><span data-stu-id="46571-142">Gets or sets the name of the entity that is mentioned in comment.</span></span>|
|[<span data-ttu-id="46571-143">CommentReply</span><span class="sxs-lookup"><span data-stu-id="46571-143">CommentReply</span></span>](/javascript/api/excel/excel.commentreply)|[<span data-ttu-id="46571-144">提及</span><span class="sxs-lookup"><span data-stu-id="46571-144">mentions</span></span>](/javascript/api/excel/excel.commentreply#mentions)|<span data-ttu-id="46571-145">获取注释中提到的实体（如人员）。</span><span class="sxs-lookup"><span data-stu-id="46571-145">Gets the entities (e.g. people) that are mentioned in comments.</span></span>|
||[<span data-ttu-id="46571-146">richContent</span><span class="sxs-lookup"><span data-stu-id="46571-146">richContent</span></span>](/javascript/api/excel/excel.commentreply#richcontent)|<span data-ttu-id="46571-147">获取丰富的注释内容（例如，注释中的提及）。</span><span class="sxs-lookup"><span data-stu-id="46571-147">Gets the rich comment content (e.g. mentions in comments).</span></span> <span data-ttu-id="46571-148">此字符串不应显示给最终用户。</span><span class="sxs-lookup"><span data-stu-id="46571-148">This string is not meant to be displayed to end-users.</span></span> <span data-ttu-id="46571-149">您的外接程序应仅使用此信息分析丰富的注释内容。</span><span class="sxs-lookup"><span data-stu-id="46571-149">Your add-in should only use this to parse rich comment content.</span></span>|
||[<span data-ttu-id="46571-150">updateMentions （contentWithMentions： CommentRichContent）</span><span class="sxs-lookup"><span data-stu-id="46571-150">updateMentions(contentWithMentions: Excel.CommentRichContent)</span></span>](/javascript/api/excel/excel.commentreply#updatementions-contentwithmentions-)|<span data-ttu-id="46571-151">使用特殊格式的字符串和提及列表更新注释内容。</span><span class="sxs-lookup"><span data-stu-id="46571-151">Updates the comment content with a specially formatted string and a list of mentions.</span></span>|
|[<span data-ttu-id="46571-152">CommentRichContent</span><span class="sxs-lookup"><span data-stu-id="46571-152">CommentRichContent</span></span>](/javascript/api/excel/excel.commentrichcontent)|[<span data-ttu-id="46571-153">提及</span><span class="sxs-lookup"><span data-stu-id="46571-153">mentions</span></span>](/javascript/api/excel/excel.commentrichcontent#mentions)|<span data-ttu-id="46571-154">包含注释中提到的所有实体（例如，人员）的数组。</span><span class="sxs-lookup"><span data-stu-id="46571-154">An array containing all the entities (e.g. people) mentioned within the comment.</span></span>|
||[<span data-ttu-id="46571-155">richContent</span><span class="sxs-lookup"><span data-stu-id="46571-155">richContent</span></span>](/javascript/api/excel/excel.commentrichcontent#richcontent)||
|[<span data-ttu-id="46571-156">Range</span><span class="sxs-lookup"><span data-stu-id="46571-156">Range</span></span>](/javascript/api/excel/excel.range)|[<span data-ttu-id="46571-157">moveTo （destinationRange： Range \|字符串）</span><span class="sxs-lookup"><span data-stu-id="46571-157">moveTo(destinationRange: Range \| string)</span></span>](/javascript/api/excel/excel.range#moveto-destinationrange-)|<span data-ttu-id="46571-158">将单元格的值、格式和公式从当前区域移动到目标区域，替换这些单元格中的旧信息。</span><span class="sxs-lookup"><span data-stu-id="46571-158">Moves cell values, formatting, and formulas from current range to the destination range, replacing the old information in those cells.</span></span>|
|[<span data-ttu-id="46571-159">RangeFormat</span><span class="sxs-lookup"><span data-stu-id="46571-159">RangeFormat</span></span>](/javascript/api/excel/excel.rangeformat)|[<span data-ttu-id="46571-160">adjustIndent （金额：数字）</span><span class="sxs-lookup"><span data-stu-id="46571-160">adjustIndent(amount: number)</span></span>](/javascript/api/excel/excel.rangeformat#adjustindent-amount-)|<span data-ttu-id="46571-161">调整范围格式的缩进量。</span><span class="sxs-lookup"><span data-stu-id="46571-161">Adjusts the indentation of the range formatting.</span></span> <span data-ttu-id="46571-162">缩进值的范围为0到250，以字符为单位。</span><span class="sxs-lookup"><span data-stu-id="46571-162">The indent value ranges from 0 to 250 and is measured in characters.</span></span>|

## <a name="see-also"></a><span data-ttu-id="46571-163">另请参阅</span><span class="sxs-lookup"><span data-stu-id="46571-163">See also</span></span>

- [<span data-ttu-id="46571-164">Excel JavaScript API 参考文档</span><span class="sxs-lookup"><span data-stu-id="46571-164">Excel JavaScript API Reference Documentation</span></span>](/javascript/api/excel?view=excel-js-online)
- [<span data-ttu-id="46571-165">Excel JavaScript 预览 API</span><span class="sxs-lookup"><span data-stu-id="46571-165">Excel JavaScript preview APIs</span></span>](./excel-preview-apis.md)
- [<span data-ttu-id="46571-166">Excel JavaScript API 要求集</span><span class="sxs-lookup"><span data-stu-id="46571-166">Excel JavaScript API requirement sets</span></span>](./excel-api-requirement-sets.md)