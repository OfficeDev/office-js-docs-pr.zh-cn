---
title: Excel JavaScript API 要求集
description: 针对 Excel 内部版本的 Office 加载项要求集信息。
ms.date: 09/15/2020
ms.prod: excel
localization_priority: Priority
ms.openlocfilehash: 3c3057dd27b571e9c4faa09cfc7415667d1c612b
ms.sourcegitcommit: ed2a98b6fb5b432fa99c6cefa5ce52965dc25759
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/16/2020
ms.locfileid: "47819796"
---
# <a name="excel-javascript-api-requirement-sets"></a><span data-ttu-id="738e9-103">Excel JavaScript API 要求集</span><span class="sxs-lookup"><span data-stu-id="738e9-103">Excel JavaScript API requirement sets</span></span>

<span data-ttu-id="738e9-p101">要求集是指已命名的 API 成员组。Office 加载项使用清单中指定的要求集或执行运行时检查，以确定 Office 应用程序是否支持加载项所需的 API。有关详细信息，请参阅 [Office 版本和要求集](../../develop/office-versions-and-requirement-sets.md)。</span><span class="sxs-lookup"><span data-stu-id="738e9-p101">Requirement sets are named groups of API members. Office Add-ins use requirement sets specified in the manifest or use a runtime check to determine whether an Office application supports APIs that an add-in needs. For more information, see [Office versions and requirement sets](../../develop/office-versions-and-requirement-sets.md).</span></span>

## <a name="requirement-set-availability"></a><span data-ttu-id="738e9-107">要求集可用性</span><span class="sxs-lookup"><span data-stu-id="738e9-107">Requirement set availability</span></span>

<span data-ttu-id="738e9-108">Excel 加载项可在多个 Office 版本中运行，包括 Windows 版 Office 2016 或更高版本、Office 网页版、Mac 版 Office 和 iPad 版 Office。</span><span class="sxs-lookup"><span data-stu-id="738e9-108">Excel add-ins run across multiple versions of Office, including Office 2016 or later on Windows, and Office on the web, Mac, and iPad.</span></span> <span data-ttu-id="738e9-109">下表列出了 Excel 要求集、支持各要求集的 Office 客户端应用程序，以及这些应用程序的内部版本或版本号。</span><span class="sxs-lookup"><span data-stu-id="738e9-109">The following table lists the Excel requirement sets, the Office client applications that support each requirement set, and the build versions or number for those applications.</span></span>

> [!NOTE]
> <span data-ttu-id="738e9-110">若要在任何带编号的要求集或 `ExcelApiOnline` 中使用 API，应引用 CDN 上的“生产”\*\*\*\* 库：https://appsforoffice.microsoft.com/lib/1/hosted/office.js。</span><span class="sxs-lookup"><span data-stu-id="738e9-110">To use APIs in any of the numbered requirement sets or `ExcelApiOnline`, you should reference the **production** library on the CDN: https://appsforoffice.microsoft.com/lib/1/hosted/office.js.</span></span>
>
> <span data-ttu-id="738e9-111">有关使用预览 API 的信息，请参阅 [Excel JavaScript 预览 API](excel-preview-apis.md) 一文。</span><span class="sxs-lookup"><span data-stu-id="738e9-111">For information about using preview APIs, see the [Excel JavaScript preview APIs](excel-preview-apis.md) article.</span></span>

|  <span data-ttu-id="738e9-112">要求集</span><span class="sxs-lookup"><span data-stu-id="738e9-112">Requirement set</span></span>  |  <span data-ttu-id="738e9-113">Windows 版 Office</span><span class="sxs-lookup"><span data-stu-id="738e9-113">Office on Windows</span></span><br><span data-ttu-id="738e9-114">（关联至 Microsoft 365 订阅）</span><span class="sxs-lookup"><span data-stu-id="738e9-114">(connected to a Microsoft 365 subscription)</span></span>  |  <span data-ttu-id="738e9-115">iPad 版 Office</span><span class="sxs-lookup"><span data-stu-id="738e9-115">Office on iPad</span></span><br><span data-ttu-id="738e9-116">（关联至 Microsoft 365 订阅）</span><span class="sxs-lookup"><span data-stu-id="738e9-116">(connected to a Microsoft 365 subscription)</span></span>  |  <span data-ttu-id="738e9-117">Mac 版 Office</span><span class="sxs-lookup"><span data-stu-id="738e9-117">Office on Mac</span></span><br><span data-ttu-id="738e9-118">（关联至 Microsoft 365 订阅）</span><span class="sxs-lookup"><span data-stu-id="738e9-118">(connected to a Microsoft 365 subscription)</span></span>  | <span data-ttu-id="738e9-119">Office 网页版</span><span class="sxs-lookup"><span data-stu-id="738e9-119">Office on the web</span></span> |
|:-----|-----|:-----|:-----|:-----|:-----|
| [<span data-ttu-id="738e9-120">预览</span><span class="sxs-lookup"><span data-stu-id="738e9-120">Preview</span></span>](excel-preview-apis.md)  | <span data-ttu-id="738e9-121">请使用最新的 Office 版本来试用预览 API（你可能需要加入 [Office 预览体验成员计划](https://insider.office.com)）</span><span class="sxs-lookup"><span data-stu-id="738e9-121">Please use the latest Office version to try preview APIs (you may need to join the [Office Insider program](https://insider.office.com))</span></span> |
| [<span data-ttu-id="738e9-122">ExcelApiOnline</span><span class="sxs-lookup"><span data-stu-id="738e9-122">ExcelApiOnline</span></span>](excel-api-online-requirement-set.md) | <span data-ttu-id="738e9-123">不适用</span><span class="sxs-lookup"><span data-stu-id="738e9-123">N/A</span></span> | <span data-ttu-id="738e9-124">不适用</span><span class="sxs-lookup"><span data-stu-id="738e9-124">N/A</span></span> | <span data-ttu-id="738e9-125">不适用</span><span class="sxs-lookup"><span data-stu-id="738e9-125">N/A</span></span> | <span data-ttu-id="738e9-126">最新（请参阅[要求集页面](excel-api-online-requirement-set.md)）</span><span class="sxs-lookup"><span data-stu-id="738e9-126">Latest (see [requirement set page](excel-api-online-requirement-set.md))</span></span> |
| [<span data-ttu-id="738e9-127">ExcelApi 1.12</span><span class="sxs-lookup"><span data-stu-id="738e9-127">ExcelApi 1.12</span></span>](excel-api-1-12-requirement-set.md) | <span data-ttu-id="738e9-128">版本 2008（内部版本 13127.20408）或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-128">Version 2008 (Build 13127.20408) or later</span></span> | <span data-ttu-id="738e9-129">16.40 或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-129">16.40 or later</span></span> | <span data-ttu-id="738e9-130">16.40 或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-130">16.40 or later</span></span> | <span data-ttu-id="738e9-131">2020 年 9 月</span><span class="sxs-lookup"><span data-stu-id="738e9-131">September 2020</span></span> |
| [<span data-ttu-id="738e9-132">ExcelApi 1.11</span><span class="sxs-lookup"><span data-stu-id="738e9-132">ExcelApi 1.11</span></span>](excel-api-1-11-requirement-set.md) | <span data-ttu-id="738e9-133">版本 2002（内部版本 12527.20470）或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-133">Version 2002 (Build 12527.20470) or later</span></span> | <span data-ttu-id="738e9-134">16.35 或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-134">16.35 or later</span></span> | <span data-ttu-id="738e9-135">16.33 或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-135">16.33 or later</span></span> | <span data-ttu-id="738e9-136">2020 年 5 月</span><span class="sxs-lookup"><span data-stu-id="738e9-136">May 2020</span></span> |
| [<span data-ttu-id="738e9-137">ExcelApi 1.10</span><span class="sxs-lookup"><span data-stu-id="738e9-137">ExcelApi 1.10</span></span>](excel-api-1-10-requirement-set.md) | <span data-ttu-id="738e9-138">版本 1907（内部版本 11929.20306）或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-138">Version 1907 (Build 11929.20306) or later</span></span> | <span data-ttu-id="738e9-139">16.0 或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-139">16.0 or later</span></span> | <span data-ttu-id="738e9-140">16.30 或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-140">16.30 or later</span></span> | <span data-ttu-id="738e9-141">2019 年 10 月</span><span class="sxs-lookup"><span data-stu-id="738e9-141">October 2019</span></span> |
| [<span data-ttu-id="738e9-142">ExcelApi 1.9</span><span class="sxs-lookup"><span data-stu-id="738e9-142">ExcelApi 1.9</span></span>](excel-api-1-9-requirement-set.md)  | <span data-ttu-id="738e9-143">版本 1903 (内部版本 11425.20204) 或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-143">Version 1903 (Build 11425.20204) or later</span></span> | <span data-ttu-id="738e9-144">16.0 或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-144">16.0 or later</span></span> | <span data-ttu-id="738e9-145">16.24 或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-145">16.24 or later</span></span> | <span data-ttu-id="738e9-146">2019 年 5 月</span><span class="sxs-lookup"><span data-stu-id="738e9-146">May 2019</span></span> |
| [<span data-ttu-id="738e9-147">ExcelApi 1.8</span><span class="sxs-lookup"><span data-stu-id="738e9-147">ExcelApi 1.8</span></span>](excel-api-1-8-requirement-set.md)  | <span data-ttu-id="738e9-148">版本 1808（内部版本 10730.20102）或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-148">Version 1808 (Build 10730.20102) or later</span></span> | <span data-ttu-id="738e9-149">16.0 或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-149">16.0 or later</span></span> | <span data-ttu-id="738e9-150">16.17 或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-150">16.17 or later</span></span> | <span data-ttu-id="738e9-151">2018 年 9 月</span><span class="sxs-lookup"><span data-stu-id="738e9-151">September 2018</span></span> |
| [<span data-ttu-id="738e9-152">ExcelApi 1.7</span><span class="sxs-lookup"><span data-stu-id="738e9-152">ExcelApi 1.7</span></span>](excel-api-1-7-requirement-set.md)  | <span data-ttu-id="738e9-153">版本 1801（内部版本 9001.2171）或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-153">Version 1801 (Build 9001.2171) or later</span></span>   | <span data-ttu-id="738e9-154">16.0 或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-154">16.0 or later</span></span>  | <span data-ttu-id="738e9-155">16.9 或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-155">16.9 or later</span></span>  | <span data-ttu-id="738e9-156">2018 年 4 月</span><span class="sxs-lookup"><span data-stu-id="738e9-156">April 2018</span></span> |
| [<span data-ttu-id="738e9-157">ExcelApi 1.6</span><span class="sxs-lookup"><span data-stu-id="738e9-157">ExcelApi 1.6</span></span>](excel-api-1-6-requirement-set.md)  | <span data-ttu-id="738e9-158">版本 1704（生成号 8201.2001）或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-158">Version 1704 (Build 8201.2001) or later</span></span>   | <span data-ttu-id="738e9-159">15.0 或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-159">15.0 or later</span></span>  | <span data-ttu-id="738e9-160">15.36 或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-160">15.36 or later</span></span> | <span data-ttu-id="738e9-161">2017 年 4 月</span><span class="sxs-lookup"><span data-stu-id="738e9-161">April 2017</span></span> |
| [<span data-ttu-id="738e9-162">ExcelApi 1.5</span><span class="sxs-lookup"><span data-stu-id="738e9-162">ExcelApi 1.5</span></span>](excel-api-1-5-requirement-set.md)  | <span data-ttu-id="738e9-163">版本 1703（内部版本 8067.2070）或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-163">Version 1703 (Build 8067.2070) or later</span></span>   | <span data-ttu-id="738e9-164">15.0 或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-164">15.0 or later</span></span>  | <span data-ttu-id="738e9-165">15.36 或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-165">15.36 or later</span></span> | <span data-ttu-id="738e9-166">2017 年 3 月</span><span class="sxs-lookup"><span data-stu-id="738e9-166">March 2017</span></span> |
| [<span data-ttu-id="738e9-167">ExcelApi 1.4</span><span class="sxs-lookup"><span data-stu-id="738e9-167">ExcelApi 1.4</span></span>](excel-api-1-4-requirement-set.md)  | <span data-ttu-id="738e9-168">版本 1701（内部版本 7870.2024）或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-168">Version 1701 (Build 7870.2024) or later</span></span>   | <span data-ttu-id="738e9-169">15.0 或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-169">15.0 or later</span></span>  | <span data-ttu-id="738e9-170">15.36 或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-170">15.36 or later</span></span> | <span data-ttu-id="738e9-171">2017 年 1 月</span><span class="sxs-lookup"><span data-stu-id="738e9-171">January 2017</span></span> |
| [<span data-ttu-id="738e9-172">ExcelApi 1.3</span><span class="sxs-lookup"><span data-stu-id="738e9-172">ExcelApi 1.3</span></span>](excel-api-1-3-requirement-set.md)  | <span data-ttu-id="738e9-173">版本 1608（内部版本 7369.2055）或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-173">Version 1608 (Build 7369.2055) or later</span></span>   | <span data-ttu-id="738e9-174">15.0 或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-174">15.0 or later</span></span> | <span data-ttu-id="738e9-175">15.27 或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-175">15.27 or later</span></span> | <span data-ttu-id="738e9-176">2016 年 9 月</span><span class="sxs-lookup"><span data-stu-id="738e9-176">September 2016</span></span> |
| [<span data-ttu-id="738e9-177">ExcelApi 1.2</span><span class="sxs-lookup"><span data-stu-id="738e9-177">ExcelApi 1.2</span></span>](excel-api-1-2-requirement-set.md)  | <span data-ttu-id="738e9-178">版本 1601（内部版本 6741.2088）或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-178">Version 1601 (Build 6741.2088) or later</span></span>   | <span data-ttu-id="738e9-179">15.0 或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-179">15.0 or later</span></span> | <span data-ttu-id="738e9-180">15.22 或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-180">15.22 or later</span></span> | <span data-ttu-id="738e9-181">2016 年 1 月</span><span class="sxs-lookup"><span data-stu-id="738e9-181">January 2016</span></span> |
| [<span data-ttu-id="738e9-182">ExcelApi 1.1</span><span class="sxs-lookup"><span data-stu-id="738e9-182">ExcelApi 1.1</span></span>](excel-api-1-1-requirement-set.md)  | <span data-ttu-id="738e9-183">版本 1509（内部版本 4266.1001）或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-183">Version 1509 (Build 4266.1001) or later</span></span>   | <span data-ttu-id="738e9-184">15.0 或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-184">15.0 or later</span></span> | <span data-ttu-id="738e9-185">15.20 或更高版本</span><span class="sxs-lookup"><span data-stu-id="738e9-185">15.20 or later</span></span> | <span data-ttu-id="738e9-186">2016 年 1 月</span><span class="sxs-lookup"><span data-stu-id="738e9-186">January 2016</span></span> |

> [!NOTE]
> <span data-ttu-id="738e9-187">永久版本的 Office 支持要求设置如下：</span><span class="sxs-lookup"><span data-stu-id="738e9-187">Perpetual versions of Office support requirement sets as follows:</span></span>
>
> - <span data-ttu-id="738e9-188">Office 2019 支持 ExcelApi 1.8 及更低版本。</span><span class="sxs-lookup"><span data-stu-id="738e9-188">Office 2019 supports ExcelApi 1.8 and earlier.</span></span>
> - <span data-ttu-id="738e9-189">Office 2016 仅支持 ExcelApi 1.1 要求集。</span><span class="sxs-lookup"><span data-stu-id="738e9-189">Office 2016 only supports the ExcelApi 1.1 requirement set.</span></span>

## <a name="office-versions-and-build-numbers"></a><span data-ttu-id="738e9-190">Office 版本和内部版本号</span><span class="sxs-lookup"><span data-stu-id="738e9-190">Office versions and build numbers</span></span>

<span data-ttu-id="738e9-191">有关 Office 版本和内部版本号的详细信息，请参阅：</span><span class="sxs-lookup"><span data-stu-id="738e9-191">For more information about Office versions and build numbers, see:</span></span>

[!INCLUDE [Links to get Office versions and how to find Office client version](../../includes/links-get-office-versions-builds.md)]

## <a name="how-to-use-excel-requirement-sets-at-runtime-and-in-the-manifest"></a><span data-ttu-id="738e9-192">如何在运行时和清单中使用 Excel 要求集</span><span class="sxs-lookup"><span data-stu-id="738e9-192">How to use Excel requirement sets at runtime and in the manifest</span></span>

> [!NOTE]
> <span data-ttu-id="738e9-193">本节假定你熟悉 [Office 版本和要求集](../../develop/office-versions-and-requirement-sets.md)和[指定 Office 应用程序和 API 要求集](../../develop/specify-office-hosts-and-api-requirements.md)处的要求集概述。</span><span class="sxs-lookup"><span data-stu-id="738e9-193">This section assumes that you are familiar with the overview of requirement sets at [Office versions and requirement sets](../../develop/office-versions-and-requirement-sets.md) and [Specify Office applications and API requirements](../../develop/specify-office-hosts-and-api-requirements.md).</span></span>

<span data-ttu-id="738e9-194">要求集是指各组已命名的 API 成员。</span><span class="sxs-lookup"><span data-stu-id="738e9-194">Requirement sets are named groups of API members.</span></span> <span data-ttu-id="738e9-195">Office 加载项可以执行运行时检查或使用清单中指定的要求集确定 Office 应用程序是否支持加载项所需的 API。</span><span class="sxs-lookup"><span data-stu-id="738e9-195">An Office Add-in can perform a runtime check or use requirement sets specified in the manifest to determine whether an Office application supports the APIs that the add-in needs.</span></span>

### <a name="checking-for-requirement-set-support-at-runtime"></a><span data-ttu-id="738e9-196">在运行时检查要求集支持</span><span class="sxs-lookup"><span data-stu-id="738e9-196">Checking for requirement set support at runtime</span></span>

<span data-ttu-id="738e9-197">以下代码示例显示如何确定运行加载项的 Office 应用程序是否支持指定的 API 要求集。</span><span class="sxs-lookup"><span data-stu-id="738e9-197">The following code sample shows how to determine whether the Office application where the add-in is running supports the specified API requirement set.</span></span>

```js
if (Office.context.requirements.isSetSupported('ExcelApi', '1.3')) {
  /// perform actions
}
else {
  /// provide alternate flow/logic
}
```

### <a name="defining-requirement-set-support-in-the-manifest"></a><span data-ttu-id="738e9-198">在清单中定义要求集支持</span><span class="sxs-lookup"><span data-stu-id="738e9-198">Defining requirement set support in the manifest</span></span>

<span data-ttu-id="738e9-199">可以在加载项清单中使用[要求元素](../manifest/requirements.md)指定加载项要求激活的最小要求集和/或 API 方法。</span><span class="sxs-lookup"><span data-stu-id="738e9-199">You can use the [Requirements element](../manifest/requirements.md) in the add-in manifest to specify the minimal requirement sets and/or API methods that your add-in requires to activate.</span></span> <span data-ttu-id="738e9-200">如果 Office 应用程序或平台不支持清单的 `Requirements` 元素中指定的要求集或 API 方法，则加载项将不会在该应用程序或平台中运行，也不会出现在“**我的加载项**”中显示的加载项列表中。如果你的加载项需要特定要求集以实现完整功能，但是即使在不支持该要求集的平台上也可以为用户提供值，则建议在运行时按照上述方式检查要求支持，而不是在清单中定义要求集支持。</span><span class="sxs-lookup"><span data-stu-id="738e9-200">If the Office application or platform doesn't support the requirement sets or API methods that are specified in the `Requirements` element of the manifest, the add-in won't run in that application or platform, and it won't display in the list of add-ins that are shown in **My Add-ins**. If your add-in requires a specific requirement set for full functionality, but it can provide value even to users on platforms that do not support the requirement set, we recommend that you check for requirement support at runtime as described above, instead of defining requirement set support in the manifest.</span></span>

<span data-ttu-id="738e9-201">以下代码示例显示加载项清单中的 `Requirements` 元素，该元素指定应在支持 ExcelApi 要求集版本 1.3 或更高版本的所有 Office 客户端应用程序中加载该加载项。</span><span class="sxs-lookup"><span data-stu-id="738e9-201">The following code sample shows the `Requirements` element in an add-in manifest which specifies that the add-in should load in all Office client applications that support ExcelApi requirement set version 1.3 or greater.</span></span>

```xml
<Requirements>
   <Sets DefaultMinVersion="1.3">
      <Set Name="ExcelApi" MinVersion="1.3"/>
   </Sets>
</Requirements>
```

## <a name="see-also"></a><span data-ttu-id="738e9-202">另请参阅</span><span class="sxs-lookup"><span data-stu-id="738e9-202">See also</span></span>

- [<span data-ttu-id="738e9-203">Excel JavaScript API 参考文档</span><span class="sxs-lookup"><span data-stu-id="738e9-203">Excel JavaScript API Reference Documentation</span></span>](/javascript/api/excel)
- [<span data-ttu-id="738e9-204">Office 加载项 XML 清单</span><span class="sxs-lookup"><span data-stu-id="738e9-204">Office Add-ins XML manifest</span></span>](../../develop/add-in-manifests.md)
